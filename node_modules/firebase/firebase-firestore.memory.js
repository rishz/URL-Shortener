!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(zd){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(zd);function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=u=u||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var r={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},i=u.INFO,a=((Te={})[u.DEBUG]="log",Te[u.VERBOSE]="log",Te[u.INFO]="info",Te[u.WARN]="warn",Te[u.ERROR]="error",Te),o=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},c);function c(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(f(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},O=N||self;function D(){}function C(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),k=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function M(){return Date.now()}function j(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++k))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},H=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function B(t){return/^[\s\xa0]*$/.test(t)}var K,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Y=O.navigator;if(Y){Y=Y.userAgent;if(Y){K=Y;break t}}K=""}function Q(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=W(K,"Opera"),it=W(K,"Trident")||W(K,"MSIE"),ot=W(K,"Edge"),st=ot||it,ut=W(K,"Gecko")&&!(W(K.toLowerCase(),"webkit")&&!W(K,"Edge"))&&!(W(K,"Trident")||W(K,"MSIE"))&&!W(K,"Edge"),at=W(K.toLowerCase(),"webkit")&&!W(K,"Edge");function ct(){var t=O.document;return t?t.documentMode:void 0}t:{var ht="",ft=(ft=K,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(ht=ft?ft[1]:""),it){ft=ct();if(null!=ft&&ft>parseFloat(ht)){nt=String(ft);break t}}nt=ht}var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=J(String(nt)).split("."),n=J(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var dt=O.document&&it?ct()||(parseInt(nt,10)||void 0):void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",D,e),O.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),Et=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function It(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(It(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Dt={};function Ct(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Mt(r);return e&&e[_t]?e.wa(n,r,L(i)?!!i.capture:!!i,o):Lt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[_t]?t.va(e,n,L(r)?!!r.capture:!!r,i):Lt(t,e,n,!1,r,i)}function Lt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=xt(t);if(c||(t[Ot]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[_t]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(Nt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):It(t)))}function kt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Rt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return Pt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new wt(e,this))}function xt(t){return(t=t[Ot])instanceof At?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==typeof e?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function jt(){q.call(this),this.c=new At(this),(this.J=this).C=null}function qt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new mt(e,t):e instanceof mt?e.target=e.target||t:(s=e,tt(e=new mt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Ft(o,r,!0,e)&&s;if(s=Ft(o=e.a=t,r,!0,e)&&s,s=Ft(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Ft(o=e.a=n[i],r,!1,e)&&s}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[_t]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){Ct(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=Mt(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(It(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},A.G=function(){if(jt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)It(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=O.JSON.stringify;function Gt(){this.b=this.a=null}var zt,Bt=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Jt},function(t){t.reset()}));function Kt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function Wt(t,e){var n;zt||(n=O.Promise.resolve(void 0),zt=function(){n.then(Qt)}),Xt||(zt(),Xt=!0),Yt.add(t,e)}Gt.prototype.add=function(t,e){var n=Bt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Gt;function Qt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=Bt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function $t(t,e){jt.call(this),this.b=t||1,this.a=e||O,this.f=x(this.Za,this),this.g=M()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==typeof t)n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}j($t,jt),(A=$t.prototype).aa=!1,A.M=null,A.Za=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),qt(this,"tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){$t.X.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e){var n=ee.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ue(t){q.call(this),this.b=t,this.a={}}j(ue,q);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Ct(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){Q(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Ht(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.X.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe={},de=null;function ye(){return de=de||new jt}function ve(t){mt.call(this,pe.Fa,t)}function ge(t){var e=ye();qt(e,new ve(e))}function me(t,e){mt.call(this,pe.STAT_EVENT,t),this.stat=e}function we(t){var e=ye();qt(e,new me(e,t))}function be(t){mt.call(this,pe.Ga,t)}function _e(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}pe.Fa="serverreachability",j(ve,mt),pe.STAT_EVENT="statevent",j(me,mt),pe.Ga="timingevent",j(be,mt);var Ee={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Te={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ie(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Ie.prototype.a=null;var Se,N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Oe(){mt.call(this,"d")}function De(){mt.call(this,"c")}function Ce(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ue(this),this.P=Re,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}j(Oe,mt),j(De,mt),j(Ce,Ie),Se=new Ce;var Re=45e3,ke={},Pe={};function Ve(t,e,n){t.H=1,t.i=nn(Ye(e)),t.j=n,t.I=!0,xe(t,null)}function xe(t,e){t.u=M(),Me(t),t.l=Ye(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(x(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Xa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Pe:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?Pe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Pe){4==e&&(t.h=4,we(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,we(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(le(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),Fe(t))}function Me(t){t.T=M()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(x(t.Va,t),e)}function qe(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function He(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||Tn(u.b,t)))if(u.I=t.N,!t.C&&Tn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Kn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(x(u.Sa,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!B(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(W(r,"spdy")||W(r,"quic")||W(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Me(o)),n.a=i):Zn(n),0<u.g.length&&Xn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Bn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(C(t)||"string"==typeof t)H(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(C(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(C(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Je(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Je(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Le.prototype).setTimeout=function(t){this.P=t},A.Xa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),He(this),Fe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ue(this,e,n),st&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Wa),this.R.start())):(le(this.c,this.f,n,null),Ge(this,n)),4==e&&He(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),He(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},A.Wa=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),Ue(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.A=!0,He(this)},A.Va=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),He(this),this.h=2,Fe(this)):je(this,this.T-n)},(A=Be.prototype).K=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return Ke(this),this.a.concat()},A.get=function(t,e){return Je(this.b,t)?this.b[t]:e},A.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ye(t){return new Xe(t)}function Qe(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Be,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Je((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t)))}function yn(t,e){return pn(t),e=gn(t,e),Je(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),z(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(A=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){H(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=G(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},A.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=function(t,e){this.b=t,this.a=e};function wn(t){this.g=t||bn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Sn(){}function On(){this.a=new Sn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Cn=O.JSON.parse;function Ln(t){jt.call(this),this.headers=new Be,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}j(Ln,jt);var Rn="",kn=/^https?$/i,Pn=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),jn(t)}function Un(t){t.u||(t.u=!0,qt(t,"complete"),qt(t,"error"))}function Mn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(qt(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n);if(e)qt(t,"complete"),qt(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Un(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Hn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Q(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Gn("baseRetryDelayMs",5e3,t),this.Ra=Gn("retryDelaySeedMs",1e4,t),this.Ma=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Bn(t){var e,n;Jn(t),3==t.v&&(e=t.R++,en(n=Ye(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Qn(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=nn(Ye(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=M(),Me(e)),ur(t)}function Kn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Jn(t){Kn(t),t.j&&(O.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new mn(t.Oa++,e)),3==t.v&&Xn(t)}function Xn(t){_n(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function Yn(t,e){var n=e?e.f:t.R++,r=Ye(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Qn(t,r),t.i&&t.l&&Hn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Ve(n,r,e)}function Qn(t,n){t.f&&ze({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?x(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;L(t)&&(n=Ht(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Wt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(x(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new Le(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ye(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Qn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Hn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Ye(e)),n.j=null,n.I=!0,xe(n,t)}function rr(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,qt(i=ye(),new be(i)),Xn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)))return t.h=_e(x(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=x(t.Ya,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||Qe(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,O.Image?((i=new Image).onload=U(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(Dn,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Jn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Ye(s):new Xe(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=O.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Qe(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&Q(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Qn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Na)).F=t.C,e}function hr(){}function fr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new zn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!B(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!B(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(A=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Se),this.a.onreadystatechange=x(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void xn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=F(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,qt(this,"timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,qt(this,"complete"),qt(this,"abort"),jn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Ln.X.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ua())},A.Ua=function(){Mn(this)},A.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Cn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=zn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Ye(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Qn(this,i),this.i&&r&&Hn(i,this.i,r),In(this.b,n),this.Ia&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ve(n,i,null)):Ve(n,i,e),this.v=2}}else 3==this.v&&(t?Yn(this,t):0==this.g.length||_n(this.b)||Yn(this))},A.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(x(this.Ta,this),t))},A.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Kn(this),nr(this))},A.Sa=function(){null!=this.m&&(this.m=null,Kn(this),tr(this),we(19))},A.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(A=hr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ja=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Xn(t)},lr.prototype.close=function(){Bn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.l?((e={}).__data__=Ht(t),Wn(this.a,e)):Wn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Bn(this.a),delete this.a,lr.X.G.call(this)},j(pr,Oe),j(dr,De),j(yr,hr),yr.prototype.ta=function(){qt(this.a,"a")},yr.prototype.sa=function(t){qt(this.a,new pr(t))},yr.prototype.ra=function(t){qt(this.a,new dr)},yr.prototype.qa=function(){qt(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Te.COMPLETE="complete",(Ne.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.W,Ln.prototype.getResponseJson=Ln.prototype.Pa,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var vr=ye,gr=Ee,mr=Te,wr=pe,br=10,_r=11,Er=Ne,Tr=Ln,Ir=new o("@firebase/firestore");function Ar(){return Ir.logLevel}function Nr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ir.logLevel<=u.DEBUG&&(e=n.map(Dr),Ir.debug.apply(Ir,l(["Firestore (8.2.1): "+t],e)))}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ir.logLevel<=u.ERROR&&(e=n.map(Dr),Ir.error.apply(Ir,l(["Firestore (8.2.1): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ir.logLevel<=u.WARN&&(e=n.map(Dr),Ir.warn.apply(Ir,l(["Firestore (8.2.1): "+t],e)))}function Dr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Cr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (8.2.1) INTERNAL ASSERTION FAILED: "+t;throw Sr(t),new Error(t)}function Lr(t){t||Cr()}var Rr=(kr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},kr);function kr(){}function Pr(t,e){return t<e?-1:e<t?1:0}function Vr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var xr=(Ur.fromBase64String=function(t){return new Ur(atob(t))},Ur.fromUint8Array=function(t){return new Ur(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ur.prototype.toBase64=function(){return t=this.i,btoa(t);var t},Ur.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},Ur.prototype.o=function(){return 2*this.i.length},Ur.prototype.u=function(t){return Pr(this.i,t.i)},Ur.prototype.isEqual=function(t){return this.i===t.i},Ur);function Ur(t){this.i=t}xr.h=new xr("");var Mr,jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qr=(f(zr,Mr=Error),zr),Fr=(Gr.fromBase64String=function(t){try{return new Gr(xr.fromBase64String(t))}catch(t){throw new qr(jr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Gr.fromUint8Array=function(t){return new Gr(xr.fromUint8Array(t))},Gr.prototype.toBase64=function(){return this.l.toBase64()},Gr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Gr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Gr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Gr),Hr=function(t){this._=t};function Gr(t){this.l=t}function zr(t,e){var n=this;return(n=Mr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Br(){if("undefined"==typeof Uint8Array)throw new qr(jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Kr(){if("undefined"==typeof atob)throw new qr(jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Jr,Wr=(f(ti,Jr=Hr),ti.fromBase64String=function(t){return Kr(),new ti(Fr.fromBase64String(t))},ti.fromUint8Array=function(t){return Br(),new ti(Fr.fromUint8Array(t))},ti.prototype.toBase64=function(){return Kr(),this._.toBase64()},ti.prototype.toUint8Array=function(){return Br(),this._.toUint8Array()},ti.prototype.isEqual=function(t){return this._.isEqual(t._)},ti.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ti),Xr=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},Yr=(Object.defineProperty(Zr.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Zr.prototype.isEqual=function(t){return t instanceof Zr&&t.projectId===this.projectId&&t.database===this.database},Zr),Qr=($r.prototype.A=function(){return null!=this.uid},$r.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},$r.prototype.isEqual=function(t){return t.uid===this.uid},$r);function $r(t){this.uid=t}function Zr(t,e){this.projectId=t,this.database=e||"(default)"}function ti(){return null!==Jr&&Jr.apply(this,arguments)||this}Qr.UNAUTHENTICATED=new Qr(null),Qr.P=new Qr("google-credentials-uid"),Qr.g=new Qr("first-party-uid");function ei(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t}var ni=(fi.prototype.getToken=function(){return Promise.resolve(null)},fi.prototype.v=function(){},fi.prototype.S=function(t){(this.p=t)(Qr.UNAUTHENTICATED)},fi.prototype.D=function(){this.p=null},fi),ri=(hi.prototype.getToken=function(){var e=this,n=this.F,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.F!==n?(Nr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new ei(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},hi.prototype.v=function(){this.forceRefresh=!0},hi.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},hi.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},hi.prototype.O=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new Qr(t)},hi),ii=(Object.defineProperty(ci.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ci),oi=(ai.prototype.getToken=function(){return Promise.resolve(new ii(this.k,this.M))},ai.prototype.S=function(t){t(Qr.g)},ai.prototype.D=function(){},ai.prototype.v=function(){},ai),si=(ui.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ui.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},ui);function ui(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}function ai(t,e){this.k=t,this.M=e}function ci(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=Qr.g}function hi(t){var e=this;this.C=null,this.currentUser=Qr.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}function fi(){this.p=null}si.U=-1;var li,pi,di=(Ai.now=function(){return Ai.fromMillis(Date.now())},Ai.fromDate=function(t){return Ai.fromMillis(t.getTime())},Ai.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ai(e,1e6*(t-1e3*e))},Ai.prototype.toDate=function(){return new Date(this.toMillis())},Ai.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ai.prototype.K=function(t){return this.seconds===t.seconds?Pr(this.nanoseconds,t.nanoseconds):Pr(this.seconds,t.seconds)},Ai.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ai.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ai.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Ai.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ai),yi=(Ii.W=function(t){return new Ii(t)},Ii.min=function(){return new Ii(new di(0,0))},Ii.prototype.u=function(t){return this.timestamp.K(t.timestamp)},Ii.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Ii.prototype.j=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Ii.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Ii.prototype.G=function(){return this.timestamp},Ii),Te=(Object.defineProperty(Ti.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),Ti.prototype.isEqual=function(t){return 0===Ti.J(this,t)},Ti.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Ti?t.forEach(function(t){e.push(t)}):e.push(t),this.Y(e)},Ti.prototype.limit=function(){return this.offset+this.length},Ti.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},Ti.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},Ti.prototype.tt=function(){return this.segments[this.offset]},Ti.prototype.et=function(){return this.get(this.length-1)},Ti.prototype.get=function(t){return this.segments[this.offset+t]},Ti.prototype.nt=function(){return 0===this.length},Ti.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ti.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ti.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Ti.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},Ti.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Ti),vi=(f(Ei,pi=Te),Ei.prototype.Y=function(t,e,n){return new Ei(t,e,n)},Ei.prototype.ot=function(){return this.rt().join("/")},Ei.prototype.toString=function(){return this.ot()},Ei.ct=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new qr(jr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Ei(n)},Ei.at=function(){return new Ei([])},Ei),gi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,mi=(f(_i,li=Te),_i.prototype.Y=function(t,e,n){return new _i(t,e,n)},_i.ut=function(t){return gi.test(t)},_i.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_i.ut(t)||(t="`"+t+"`"),t}).join(".")},_i.prototype.toString=function(){return this.ot()},_i.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},_i.lt=function(){return new _i(["__name__"])},_i._t=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new qr(jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new qr(jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new qr(jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new qr(jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new _i(e)},_i.at=function(){return new _i([])},_i),wi=(bi.ft=function(t){return new bi(vi.ct(t))},bi.dt=function(t){return new bi(vi.ct(t).X(5))},bi.prototype.wt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},bi.prototype.isEqual=function(t){return null!==t&&0===vi.J(this.path,t.path)},bi.prototype.toString=function(){return this.path.toString()},bi.J=function(t,e){return vi.J(t.path,e.path)},bi.Et=function(t){return t.length%2==0},bi.Tt=function(t){return new bi(new vi(t.slice()))},bi);function bi(t){this.path=t}function _i(){return null!==li&&li.apply(this,arguments)||this}function Ei(){return null!==pi&&pi.apply(this,arguments)||this}function Ti(t,e,n){void 0===e?e=0:e>t.length&&Cr(),void 0===n?n=t.length-e:n>t.length-e&&Cr(),this.segments=t,this.offset=e,this.H=n}function Ii(t){this.timestamp=t}function Ai(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new qr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new qr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new qr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Ni(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Si(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Oi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Di=(Li.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},Li.prototype.isEqual=function(t){return Vr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Li),Ci=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Li(t){(this.fields=t).sort(mi.J)}function Ri(t){if(Lr(!!t),"string"!=typeof t)return{seconds:ki(t.seconds),nanos:ki(t.nanos)};var e=0,n=Ci.exec(t);Lr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function ki(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Pi(t){return"string"==typeof t?xr.fromBase64String(t):xr.fromUint8Array(t)}function Vi(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function xi(t){t=Ri(t.mapValue.fields.__local_write_time__.timestampValue);return new di(t.seconds,t.nanos)}function Ui(t){return null==t}function Mi(t){return 0===t&&1/t==-1/0}function ji(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Vi(t)?4:10:Cr()}function qi(r,i){var t,e=ji(r);if(e!==ji(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return xi(r).isEqual(xi(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ri(r.timestampValue),t=Ri(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Pi(r.bytesValue).isEqual(Pi(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,ki((t=r).geoPointValue.latitude)===ki(e.geoPointValue.latitude)&&ki(t.geoPointValue.longitude)===ki(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ki(t.integerValue)===ki(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=ki(t.doubleValue),e=ki(e.doubleValue);return t===e?Mi(t)===Mi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Vr(r.arrayValue.values||[],i.arrayValue.values||[],qi);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Ni(e)!==Ni(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!qi(e[t],n[t])))return!1;return!0}();default:return Cr()}}function Fi(t,e){return void 0!==(t.values||[]).find(function(t){return qi(t,e)})}function Hi(t,e){var n,r,i=ji(t),o=ji(e);if(i!==o)return Pr(i,o);switch(i){case 0:return 0;case 1:return Pr(t.booleanValue,e.booleanValue);case 2:return n=e,r=ki(t.integerValue||t.doubleValue),n=ki(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Gi(t.timestampValue,e.timestampValue);case 4:return Gi(xi(t),xi(e));case 5:return Pr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Pi(t),e=Pi(e);return t.u(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Pr(n[i],r[i]);if(0!==o)return o}return Pr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Pr(ki(i.latitude),ki(r.latitude)))?n:Pr(ki(i.longitude),ki(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Hi(n[i],r[i]);if(o)return o}return Pr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Pr(r[s],o[s]);if(0!==u)return u;u=Hi(n[r[s]],i[o[s]]);if(0!==u)return u}return Pr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Cr()}}function Gi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Pr(t,e);var n=Ri(t),t=Ri(e),e=Pr(n.seconds,t.seconds);return 0!==e?e:Pr(n.nanos,t.nanos)}function zi(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Ri(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Pi(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,wi.dt(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Cr();var e}(t)}function Bi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Ki(t){return t&&"integerValue"in t}function Ji(t){return!!t&&"arrayValue"in t}function Wi(t){return t&&"nullValue"in t}function Xi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yi(t){return t&&"mapValue"in t}var Qi=(to.empty=function(){return new to({mapValue:{}})},to.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Yi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},to.prototype.isEqual=function(t){return qi(this.proto,t.proto)},to),$i=(Zi.prototype.set=function(t,e){return this.Pt(t,e),this},Zi.prototype.delete=function(t){return this.Pt(t,null),this},Zi.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===ji(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.et(),e)},Zi.prototype.yt=function(){var t=this.gt(mi.at(),this.Rt);return null!=t?new Qi(t):this.At},Zi.prototype.gt=function(r,t){var i=this,o=!1,e=this.At.field(r),s=Yi(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.gt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Zi);function Zi(t){void 0===t&&(t=Qi.empty()),this.At=t,this.Rt=new Map}function to(t){this.proto=t}var eo,no,ro,o=function(t,e){this.key=t,this.version=e},io=(f(ho,ro=o),ho.prototype.field=function(t){return this.Vt.field(t)},ho.prototype.data=function(){return this.Vt},ho.prototype.vt=function(){return this.Vt.proto},ho.prototype.isEqual=function(t){return t instanceof ho&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},ho.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ho.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ho),oo=(f(co,no=o),co.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(co.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),co.prototype.isEqual=function(t){return t instanceof co&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},co),so=(f(ao,eo=o),ao.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ao.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),ao.prototype.isEqual=function(t){return t instanceof ao&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ao),uo=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function ao(){return null!==eo&&eo.apply(this,arguments)||this}function co(t,e,n){var r=this;return(r=no.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function ho(t,e,n,r){var i=this;return(i=ro.call(this,t,e)||this).Vt=n,i.bt=!!r.bt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function fo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new uo(t,e,n,r,i,o,s)}function lo(t){var e=t;return null===e.St&&(t=e.path.ot(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.ot()+t.op.toString()+zi(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.ot()+t.dir}).join(","),Ui(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Ho(e.startAt)),e.endAt&&(t+="|ub:",t+=Ho(e.endAt)),e.St=t),e.St}function po(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!qi(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bo(t.startAt,e.startAt)&&Bo(t.endAt,e.endAt)}function yo(t){return wi.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var vo,go=(f(mo,vo=function(){}),mo.create=function(t,e,n){return t.ht()?"in"===e||"not-in"===e?this.Dt(t,e,n):new Eo(t,e,n):"array-contains"===e?new ko(t,n):"in"===e?new Po(t,n):"not-in"===e?new Vo(t,n):"array-contains-any"===e?new xo(t,n):new mo(t,e,n)},mo.Dt=function(t,e,n){return new("in"===e?To:Io)(t,n)},mo.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Ct(Hi(t,this.value)):null!==t&&ji(this.value)===ji(t)&&this.Ct(Hi(t,this.value))},mo.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Cr()}},mo.prototype.xt=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},mo);function mo(t,e,n){var r=this;return(r=vo.call(this)||this).field=t,r.op=e,r.value=n,r}var wo,bo,_o,Eo=(f(So,_o=go),So.prototype.matches=function(t){t=wi.J(t.key,this.key);return this.Ct(t)},So),To=(f(No,bo=go),No.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},No),Io=(f(Ao,wo=go),Ao.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Ao);function Ao(t,e){var n=this;return(n=wo.call(this,t,"not-in",e)||this).keys=Oo(0,e),n}function No(t,e){var n=this;return(n=bo.call(this,t,"in",e)||this).keys=Oo(0,e),n}function So(t,e,n){var r=this;return(r=_o.call(this,t,e,n)||this).key=wi.dt(n.referenceValue),r}function Oo(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return wi.dt(t.referenceValue)})}var Do,Co,Lo,Ro,ko=(f(Fo,Ro=go),Fo.prototype.matches=function(t){t=t.field(this.field);return Ji(t)&&Fi(t.arrayValue,this.value)},Fo),Po=(f(qo,Lo=go),qo.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Fi(this.value.arrayValue,t)},qo),Vo=(f(jo,Co=go),jo.prototype.matches=function(t){if(Fi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Fi(this.value.arrayValue,t)},jo),xo=(f(Mo,Do=go),Mo.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Ji(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Fi(e.value.arrayValue,t)})},Mo),Uo=function(t,e){this.position=t,this.before=e};function Mo(t,e){return Do.call(this,t,"array-contains-any",e)||this}function jo(t,e){return Co.call(this,t,"not-in",e)||this}function qo(t,e){return Lo.call(this,t,"in",e)||this}function Fo(t,e){return Ro.call(this,t,"array-contains",e)||this}function Ho(t){return(t.before?"b":"a")+":"+t.position.map(zi).join(",")}var Go=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function zo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ht()?wi.J(wi.dt(s.referenceValue),n.key):Hi(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Bo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!qi(t.position[n],e.position[n]))return!1;return!0}var Ko=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Ft=null,this.Ot=null,this.startAt,this.endAt};function Jo(t){return new Ko(t)}function Wo(t){return!Ui(t.limit)&&"F"===t.limitType}function Xo(t){return!Ui(t.limit)&&"L"===t.limitType}function Yo(t){return 0<t.Nt.length?t.Nt[0].field:null}function Qo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function $o(t){return null!==t.collectionGroup}function Zo(t){var e=t;if(null===e.Ft){e.Ft=[];var n=Qo(e),t=Yo(e);if(null!==n&&null===t)n.ht()||e.Ft.push(new Go(n)),e.Ft.push(new Go(mi.lt(),"asc"));else{for(var r=!1,i=0,o=e.Nt;i<o.length;i++){var s=o[i];e.Ft.push(s),s.field.ht()&&(r=!0)}r||(n=0<e.Nt.length?e.Nt[e.Nt.length-1].dir:"asc",e.Ft.push(new Go(mi.lt(),n)))}}return e.Ft}function ts(t){var e=t;if(!e.Ot)if("F"===e.limitType)e.Ot=fo(e.path,e.collectionGroup,Zo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Zo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Go(o.field,s))}var u=e.endAt?new Uo(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Uo(e.startAt.position,!e.startAt.before):null;e.Ot=fo(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ot}function es(t,e,n){return new Ko(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ns(t,e){return po(ts(t),ts(e))&&t.limitType===e.limitType}function rs(t){return lo(ts(t))+"|lt:"+t.limitType}function is(t){return"Query(target="+(e=ts(t),n=e.path.ot(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.ot()+" "+t.op+" "+zi(t.value)}).join(", ")+"]"),Ui(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.ot()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ho(e.startAt)),e.endAt&&(n+=", endAt: "+Ho(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function os(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.wt(e.collectionGroup)&&e.path.st(n):wi.Et(e.path)?e.path.isEqual(n):e.path.it(n))&&function(t){for(var e=0,n=i.Nt;e<n.length;e++){var r=n[e];if(!r.field.ht()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||zo(t.startAt,Zo(t),n))&&(!t.endAt||!zo(t.endAt,Zo(t),n)));var e,n}function ss(u){return function(t,e){for(var n=!1,r=0,i=Zo(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.ht()?wi.J(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Hi(n,t):Cr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Cr()}}(o,t,e);if(0!==s)return s;n=n||o.field.ht()}return 0}}var us=(as.prototype.Lt=function(t){return new as(this.target,this.targetId,this.kt,t,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},as.prototype.$t=function(t,e){return new as(this.target,this.targetId,this.kt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},as.prototype.Bt=function(t){return new as(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,t,this.resumeToken)},as);function as(t,e,n,r,i,o,s){void 0===i&&(i=yi.min()),void 0===o&&(o=yi.min()),void 0===s&&(s=xr.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function cs(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mi(e)?"-0":e}}function hs(t){return{integerValue:""+t}}function fs(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Mi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?hs(e):cs(t,e);var n}Te=function(){this.Ut=void 0};function ls(t,e){return t instanceof As?Ki(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ps,ds,ys=(f(ms,ds=Te),ms),vs=(f(gs,ps=Te),gs);function gs(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function ms(){return null!==ds&&ds.apply(this,arguments)||this}function ws(t,e){for(var n=Os(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return qi(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var bs,_s=(f(Es,bs=Te),Es);function Es(t){var e=this;return(e=bs.call(this)||this).elements=t,e}function Ts(t,e){for(var n=Os(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!qi(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Is,As=(f(Ns,Is=Te),Ns);function Ns(t,e){var n=this;return(n=Is.call(this)||this).Kt=t,n.Qt=e,n}function Ss(t){return ki(t.integerValue||t.doubleValue)}function Os(t){return Ji(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ds(t,e){this.field=t,this.transform=e}function Cs(t,e){this.version=t,this.transformResults=e}var Ls=(Rs.Wt=function(){return new Rs},Rs.exists=function(t){return new Rs(void 0,t)},Rs.updateTime=function(t){return new Rs(t)},Object.defineProperty(Rs.prototype,"jt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Rs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Rs);function Rs(t,e){this.updateTime=t,this.exists=e}function ks(t,e){return void 0!==t.updateTime?e instanceof io&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof io}o=function(){};function Ps(t,e,n,r){return t instanceof js?function(t,e,n,r){if(!ks(t.Gt,e))return e;var i=t.value;t.fieldTransforms&&(r=Bs(t.fieldTransforms,n,e,r),i=Ks(t.fieldTransforms,i,r));e=xs(e);return new io(t.key,e,i,{bt:!0})}(t,e,r,n):t instanceof qs?function(t,e,n,r){if(!ks(t.Gt,e))return e;var i=xs(e),r=Gs(t,e,Bs(t.fieldTransforms,n,e,r));return new io(t.key,i,r,{bt:!0})}(t,e,r,n):(e=e,ks((t=t).Gt,e)?new oo(t.key,yi.min()):e)}function Vs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Vr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof vs&&e instanceof vs||t instanceof _s&&e instanceof _s?Vr(t.elements,e.elements,qi):t instanceof As&&e instanceof As?qi(t.Qt,e.Qt):t instanceof ys&&e instanceof ys)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt));var n,r}function xs(t){return t instanceof io?t.version:yi.min()}var Us,Ms,js=(f(Hs,Ms=o),Hs),qs=(f(Fs,Us=o),Fs);function Fs(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Us.call(this)||this).key=t,o.data=e,o.zt=n,o.Gt=r,o.fieldTransforms=i,o.type=1,o}function Hs(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Ms.call(this)||this).key=t,i.value=e,i.Gt=n,i.fieldTransforms=r,i.type=0,i}function Gs(t,e,n){var r,i,o;return i=t,e=r=e instanceof io?e.data():Qi.empty(),o=new $i(e),i.zt.fields.forEach(function(t){var e;t.nt()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o.yt(),Ks(t.fieldTransforms,r,n)}function zs(t,e,n){var r=[];Lr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof io&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof vs?ws(o,s):o instanceof _s?Ts(o,s):u))}return r}function Bs(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof io&&(h=n.field(a.field)),null===h&&r instanceof io&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof ys?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof vs?ws(c,i):c instanceof _s?Ts(c,i):(c=ls(h=c,i),i=Ss(c)+Ss(h.Qt),Ki(c)&&Ki(h.Qt)?hs(i):cs(h.Kt,i))))}return o}function Ks(t,e,n){for(var r=new $i(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}function Js(t){this.count=t}var Ws,Xs,Ys,Qs=(f(tu,Ys=o),tu),$s=(f(Zs,Xs=o),Zs);function Zs(t,e){var n=this;return(n=Xs.call(this)||this).key=t,n.Gt=e,n.type=3,n.fieldTransforms=[],n}function tu(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.Gt=e,n.type=2,n.fieldTransforms=[],n}function eu(t){switch(t){case jr.OK:return Cr(),0;case jr.CANCELLED:case jr.UNKNOWN:case jr.DEADLINE_EXCEEDED:case jr.RESOURCE_EXHAUSTED:case jr.INTERNAL:case jr.UNAVAILABLE:case jr.UNAUTHENTICATED:return;case jr.INVALID_ARGUMENT:case jr.NOT_FOUND:case jr.ALREADY_EXISTS:case jr.PERMISSION_DENIED:case jr.FAILED_PRECONDITION:case jr.ABORTED:case jr.OUT_OF_RANGE:case jr.UNIMPLEMENTED:case jr.DATA_LOSS:return 1;default:return Cr(),0}}function nu(t){if(void 0===t)return Sr("GRPC error has no .code"),jr.UNKNOWN;switch(t){case Ws.OK:return jr.OK;case Ws.CANCELLED:return jr.CANCELLED;case Ws.UNKNOWN:return jr.UNKNOWN;case Ws.DEADLINE_EXCEEDED:return jr.DEADLINE_EXCEEDED;case Ws.RESOURCE_EXHAUSTED:return jr.RESOURCE_EXHAUSTED;case Ws.INTERNAL:return jr.INTERNAL;case Ws.UNAVAILABLE:return jr.UNAVAILABLE;case Ws.UNAUTHENTICATED:return jr.UNAUTHENTICATED;case Ws.INVALID_ARGUMENT:return jr.INVALID_ARGUMENT;case Ws.NOT_FOUND:return jr.NOT_FOUND;case Ws.ALREADY_EXISTS:return jr.ALREADY_EXISTS;case Ws.PERMISSION_DENIED:return jr.PERMISSION_DENIED;case Ws.FAILED_PRECONDITION:return jr.FAILED_PRECONDITION;case Ws.ABORTED:return jr.ABORTED;case Ws.OUT_OF_RANGE:return jr.OUT_OF_RANGE;case Ws.UNIMPLEMENTED:return jr.UNIMPLEMENTED;case Ws.DATA_LOSS:return jr.DATA_LOSS;default:return Cr()}}(Te=Ws=Ws||{})[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";var ru=(au.prototype.Ht=function(t,e){return new au(this.J,this.root.Ht(t,e,this.J).copy(null,null,ou.Jt,null,null))},au.prototype.remove=function(t){return new au(this.J,this.root.remove(t,this.J).copy(null,null,ou.Jt,null,null))},au.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},au.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},au.prototype.nt=function(){return this.root.nt()},Object.defineProperty(au.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),au.prototype.Yt=function(){return this.root.Yt()},au.prototype.Xt=function(){return this.root.Xt()},au.prototype.Zt=function(t){return this.root.Zt(t)},au.prototype.forEach=function(n){this.Zt(function(t,e){return n(t,e),!1})},au.prototype.toString=function(){var n=[];return this.Zt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},au.prototype.te=function(t){return this.root.te(t)},au.prototype.ee=function(){return new iu(this.root,null,this.J,!1)},au.prototype.ne=function(t){return new iu(this.root,t,this.J,!1)},au.prototype.se=function(){return new iu(this.root,null,this.J,!0)},au.prototype.ie=function(t){return new iu(this.root,t,this.J,!0)},au),iu=(uu.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},uu.prototype.ae=function(){return 0<this.oe.length},uu.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},uu),ou=(su.prototype.copy=function(t,e,n,r,i){return new su(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},su.prototype.nt=function(){return!1},su.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},su.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},su.prototype.min=function(){return this.left.nt()?this:this.left.min()},su.prototype.Yt=function(){return this.min().key},su.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},su.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},su.prototype.le=function(){if(this.left.nt())return su.EMPTY;var t=this;return t.left._e()||t.left.left._e()||(t=t.fe()),(t=t.copy(null,null,null,t.left.le(),null)).he()},su.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.nt()||r.left._e()||r.left.left._e()||(r=r.fe()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left._e()&&(r=r.de()),r.right.nt()||r.right._e()||r.right.left._e()||(r=r.we()),0===e(t,r.key)){if(r.right.nt())return su.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.le())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.he()},su.prototype._e=function(){return this.color},su.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},su.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},su.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},su.prototype.Ee=function(){var t=this.copy(null,null,su.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},su.prototype.de=function(){var t=this.copy(null,null,su.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},su.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},su.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},su.prototype.me=function(){if(this._e()&&this.left._e())throw Cr();if(this.right._e())throw Cr();var t=this.left.me();if(t!==this.right.me())throw Cr();return t+(this._e()?0:1)},su);function su(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:su.RED,this.left=null!=r?r:su.EMPTY,this.right=null!=i?i:su.EMPTY,this.size=this.left.size+1+this.right.size}function uu(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}function au(t,e){this.J=t,this.root=e||ou.EMPTY}function cu(){this.size=0}ou.EMPTY=null,ou.RED=!0,ou.Jt=!1,ou.EMPTY=(Object.defineProperty(cu.prototype,"key",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(cu.prototype,"value",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(cu.prototype,"color",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(cu.prototype,"left",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(cu.prototype,"right",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),cu.prototype.copy=function(t,e,n,r,i){return this},cu.prototype.Ht=function(t,e,n){return new ou(t,e)},cu.prototype.remove=function(t,e){return this},cu.prototype.nt=function(){return!0},cu.prototype.Zt=function(t){return!1},cu.prototype.te=function(t){return!1},cu.prototype.Yt=function(){return null},cu.prototype.Xt=function(){return null},cu.prototype._e=function(){return!1},cu.prototype.Ie=function(){return!0},cu.prototype.me=function(){return 0},new cu);var hu=(du.prototype.has=function(t){return null!==this.data.get(t)},du.prototype.first=function(){return this.data.Yt()},du.prototype.last=function(){return this.data.Xt()},Object.defineProperty(du.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),du.prototype.indexOf=function(t){return this.data.indexOf(t)},du.prototype.forEach=function(n){this.data.Zt(function(t,e){return n(t),!1})},du.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(0<=this.J(r.key,t[1]))return;e(r.key)}},du.prototype.Re=function(t,e){for(var n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},du.prototype.Pe=function(t){t=this.data.ne(t);return t.ae()?t.ce().key:null},du.prototype.ee=function(){return new fu(this.data.ee())},du.prototype.ne=function(t){return new fu(this.data.ne(t))},du.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},du.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},du.prototype.nt=function(){return this.data.nt()},du.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},du.prototype.isEqual=function(t){if(!(t instanceof du))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ee(),n=t.data.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(0!==this.J(r,i))return!1}return!0},du.prototype.rt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},du.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},du.prototype.copy=function(t){var e=new du(this.J);return e.data=t,e},du),fu=(pu.prototype.ce=function(){return this.ge.ce().key},pu.prototype.ae=function(){return this.ge.ae()},pu),lu=new ru(wi.J);function pu(t){this.ge=t}function du(t){this.J=t,this.data=new ru(this.J)}var yu=new ru(wi.J);var vu=new ru(wi.J);var gu=new hu(wi.J);function mu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=gu,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var wu=new hu(Pr);var bu=(xu.be=function(t){return new xu(t.J)},xu.prototype.has=function(t){return null!=this.Ve.get(t)},xu.prototype.get=function(t){return this.Ve.get(t)},xu.prototype.first=function(){return this.pe.Yt()},xu.prototype.last=function(){return this.pe.Xt()},xu.prototype.nt=function(){return this.pe.nt()},xu.prototype.indexOf=function(t){t=this.Ve.get(t);return t?this.pe.indexOf(t):-1},Object.defineProperty(xu.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),xu.prototype.forEach=function(n){this.pe.Zt(function(t,e){return n(t),!1})},xu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},xu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},xu.prototype.isEqual=function(t){if(!(t instanceof xu))return!1;if(this.size!==t.size)return!1;for(var e=this.pe.ee(),n=t.pe.ee();e.ae();){var r=e.ce().key,i=n.ce().key;if(!r.isEqual(i))return!1}return!0},xu.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},xu.prototype.copy=function(t,e){var n=new xu;return n.J=this.J,n.Ve=t,n.pe=e,n},xu),_u=(Vu.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);!n||0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):Cr()},Vu.prototype.Se=function(){var n=[];return this.ve.Zt(function(t,e){n.push(e)}),n},Vu),Eu=(Pu.Fe=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Pu(t,e,bu.be(e),i,n,r,!0,!1)},Object.defineProperty(Pu.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),Pu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&ns(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Pu),Tu=(ku.$e=function(t,e){var n=new Map;return n.set(t,Iu.Be(t,e)),new ku(yi.min(),n,wu,lu,mu())},ku),Iu=(Ru.Be=function(t,e){return new Ru(xr.h,e,mu(),mu(),mu())},Ru),Au=function(t,e,n,r){this.We=t,this.removedTargetIds=e,this.key=n,this.je=r},Nu=function(t,e){this.targetId=t,this.Ge=e},Su=function(t,e,n,r){void 0===n&&(n=xr.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ou=(Object.defineProperty(Lu.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(Lu.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(Lu.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(Lu.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),Lu.prototype.en=function(t){0<t.o()&&(this.Xe=!0,this.Je=t)},Lu.prototype.nn=function(){var n=mu(),r=mu(),i=mu();return this.He.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Cr()}}),new Iu(this.Je,this.Ye,n,r,i)},Lu.prototype.sn=function(){this.Xe=!1,this.He=Mu()},Lu.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},Lu.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},Lu.prototype.cn=function(){this.ze+=1},Lu.prototype.an=function(){--this.ze},Lu.prototype.un=function(){this.Xe=!0,this.Ye=!0},Lu),Du=(Cu.prototype.wn=function(t){for(var e=0,n=t.We;e<n.length;e++){var r=n[e];t.je instanceof io?this.En(r,t.je):t.je instanceof oo&&this.Tn(r,t.key,t.je)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Tn(r,t.key,t.je)},Cu.prototype.In=function(n){var r=this;this.mn(n,function(t){var e=r.An(t);switch(n.state){case 0:r.Rn(t)&&e.en(n.resumeToken);break;case 1:e.an(),e.Ze||e.sn(),e.en(n.resumeToken);break;case 2:e.an(),e.Ze||r.removeTarget(t);break;case 3:r.Rn(t)&&(e.un(),e.en(n.resumeToken));break;case 4:r.Rn(t)&&(r.Pn(t),e.en(n.resumeToken));break;default:Cr()}})},Cu.prototype.mn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ln.forEach(function(t,e){r.Rn(e)&&n(e)})},Cu.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,t=this.gn(e);t&&(yo(t=t.target)?0===n?(t=new wi(t.path),this.Tn(e,t,new oo(t,yi.min()))):Lr(1===n):this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e)))},Cu.prototype.pn=function(r){var i=this,o=new Map;this.ln.forEach(function(t,e){var n=i.gn(e);n&&(t.qe&&yo(n.target)&&(n=new wi(n.target.path),null!==i._n.get(n)||i.bn(e,n)||i.Tn(e,n,new oo(n,r))),t.tn&&(o.set(e,t.nn()),t.sn()))});var s=mu();this.fn.forEach(function(t,e){var n=!0;e.Re(function(t){t=i.gn(t);return!t||2===t.kt||(n=!1)}),n&&(s=s.add(t))});var t=new Tu(r,o,this.dn,this._n,s);return this._n=lu,this.fn=Uu(),this.dn=new hu(Pr),t},Cu.prototype.En=function(t,e){var n;this.Rn(t)&&(n=this.bn(t,e.key)?2:0,this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t)))},Cu.prototype.Tn=function(t,e,n){var r;this.Rn(t)&&(r=this.An(t),this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n)))},Cu.prototype.removeTarget=function(t){this.ln.delete(t)},Cu.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},Cu.prototype.cn=function(t){this.An(t).cn()},Cu.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new Ou,this.ln.set(t,e)),e},Cu.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new hu(Pr),this.fn=this.fn.Ht(t,e)),e},Cu.prototype.Rn=function(t){var e=null!==this.gn(t);return e||Nr("WatchChangeAggregator","Detected inactive target",t),e},Cu.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},Cu.prototype.Pn=function(e){var n=this;this.ln.set(e,new Ou),this.hn.Sn(e).forEach(function(t){n.Tn(e,t,null)})},Cu.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},Cu);function Cu(t){this.hn=t,this.ln=new Map,this._n=lu,this.fn=Uu(),this.dn=new hu(Pr)}function Lu(){this.ze=0,this.He=Mu(),this.Je=xr.h,this.Ye=!1,this.Xe=!0}function Ru(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}function ku(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.Le=i}function Pu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=u}function Vu(){this.ve=new ru(wi.J)}function xu(n){this.J=n?function(t,e){return n(t,e)||wi.J(t.key,e.key)}:function(t,e){return wi.J(t.key,e.key)},this.Ve=yu,this.pe=new ru(this.J)}function Uu(){return new ru(wi.J)}function Mu(){return new ru(wi.J)}var ju={asc:"ASCENDING",desc:"DESCENDING"},qu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fu=function(t,e){this.T=t,this.qt=e};function Hu(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gu(t,e){return t.qt?e.toBase64():e.toUint8Array()}function zu(t){return Lr(!!t),yi.W((t=Ri(t),new di(t.seconds,t.nanos)))}function Bu(t,e){return new vi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).ot()}function Ku(t){t=vi.ct(t);return Lr(ua(t)),t}function Ju(t,e){return Bu(t.T,e.path)}function Wu(t,e){e=Ku(e);if(e.get(1)!==t.T.projectId)throw new qr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.T.projectId);if(e.get(3)!==t.T.database)throw new qr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.T.database);return new wi(Qu(e))}function Xu(t,e){return Bu(t.T,e)}function Yu(t){return new vi(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Qu(t){return Lr(4<t.length&&"documents"===t.get(4)),t.X(5)}function $u(t,e,n){return{name:Ju(t,e),fields:n.proto.mapValue.fields}}function Zu(t,e){var n,r,i;if(e instanceof js)n={update:$u(t,e.key,e.value)};else if(e instanceof Qs)n={delete:Ju(t,e.key)};else if(e instanceof qs)n={update:$u(t,e.key,e.data),updateMask:(i=e.zt,r=[],i.fields.forEach(function(t){return r.push(t.ot())}),{fieldPaths:r})};else{if(!(e instanceof $s))return Cr();n={verify:Ju(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ys)return{fieldPath:t.field.ot(),setToServerValue:"REQUEST_TIME"};if(e instanceof vs)return{fieldPath:t.field.ot(),appendMissingElements:{values:e.elements}};if(e instanceof _s)return{fieldPath:t.field.ot(),removeAllFromArray:{values:e.elements}};if(e instanceof As)return{fieldPath:t.field.ot(),increment:e.Qt};throw Cr()})),e.Gt.jt||(n.currentDocument=void 0!==(i=e.Gt).updateTime?{updateTime:(e=t,t=i.updateTime,Hu(e,t.G()))}:void 0!==i.exists?{exists:i.exists}:Cr()),n}function ta(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Xu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Xu(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Xi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NAN"}};if(Wi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Xi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NOT_NAN"}};if(Wi(t.value))return{unaryFilter:{field:ia(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ia(t.field),op:(e=t.op,qu[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:ia((t=t).field),direction:(t=t.dir,ju[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.qt||Ui(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=na(e.startAt)),e.endAt&&(n.structuredQuery.endAt=na(e.endAt)),n}function ea(t){var e=4===(o=Ku(t.parent)).length?vi.at():Qu(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Lr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[sa(t)]:void 0!==t.fieldFilter?[(n=t,go.create(oa(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Cr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Cr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new Go(oa((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Ui(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ra(n.startAt));var u=null;return n.endAt&&(u=ra(n.endAt)),new Ko(e,i,t,o,r,"F",s,u)}function na(t){return{before:t.before,values:t.position}}function ra(t){var e=!!t.before,t=t.values||[];return new Uo(t,e)}function ia(t){return{fieldPath:t.ot()}}function oa(t){return mi._t(t.fieldPath)}function sa(t){switch(t.unaryFilter.op){case"IS_NAN":var e=oa(t.unaryFilter.field);return go.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=oa(t.unaryFilter.field);return go.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=oa(t.unaryFilter.field);return go.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=oa(t.unaryFilter.field);return go.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Cr()}}function ua(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var aa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},ca=(ha.prototype.catch=function(t){return this.next(void 0,t)},ha.prototype.next=function(r,i){var o=this;return this.Fn&&Cr(),this.Fn=!0,this.Nn?this.error?this.On(i,this.error):this.kn(r,this.result):new ha(function(e,n){o.Cn=function(t){o.kn(r,t).next(e,n)},o.xn=function(t){o.On(i,t).next(e,n)}})},ha.prototype.Mn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ha.prototype.Ln=function(t){try{var e=t();return e instanceof ha?e:ha.resolve(e)}catch(t){return ha.reject(t)}},ha.prototype.kn=function(t,e){return t?this.Ln(function(){return t(e)}):ha.resolve(e)},ha.prototype.On=function(t,e){return t?this.Ln(function(){return t(e)}):ha.reject(e)},ha.resolve=function(n){return new ha(function(t,e){t(n)})},ha.reject=function(n){return new ha(function(t,e){e(n)})},ha.$n=function(t){return new ha(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ha.Bn=function(t){for(var n=ha.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ha.resolve(t):e()})}(r[e]);return n},ha.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},ha);function ha(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}function fa(t){return"IndexedDbTransactionError"===t.name}var la=(pa.Is=function(t,e,n,r,i){i=new pa(t,e,Date.now()+n,r,i);return i.start(n),i},pa.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},pa.prototype.Ps=function(){return this.Rs()},pa.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new qr(jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},pa.prototype.Rs=function(){var e=this;this.fs.ys(function(){return null!==e.As?(e.clearTimeout(),e.op().then(function(t){return e.Ts.resolve(t)})):Promise.resolve()})},pa.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},pa);function pa(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new aa,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}function da(t,e){if(Sr("AsyncQueue",e+": "+t),fa(t))return new qr(jr.UNAVAILABLE,e+": "+t);throw t}function ya(t,e){this.progress=t,this.gs=e}function va(t){this.Ms=t}var o=(_a.prototype.ps=function(t){this.Vs.push(t)},_a.prototype.bs=function(){this.Vs.forEach(function(t){return t()})},_a),ga=(ba.prototype.Cs=function(t,e,n){for(var r,i,o,s,u,a,c=n.xs,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof js?(u=o,f=(s=r).value,u.transformResults&&(a=zs(s.fieldTransforms,i,u.transformResults),f=Ks(s.fieldTransforms,f,a)),new io(s.key,u.version,f,{hasCommittedMutations:!0})):r instanceof qs?function(t,e,n){if(!ks(t.Gt,e))return new so(t.key,n.version);e=Gs(t,e,n.transformResults?zs(t.fieldTransforms,e,n.transformResults):[]);return new io(t.key,n.version,e,{hasCommittedMutations:!0})}(r,i,o):new oo(r.key,o.version,{hasCommittedMutations:!0}))}return e},ba.prototype.Ns=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ps(i,e,e,this.Ds))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ps(a,e,o,this.Ds))}return e},ba.prototype.Fs=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Ns(t.key,n.get(t.key));e&&(i=i.Ht(t.key,e))}),i},ba.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},mu())},ba.prototype.isEqual=function(t){return this.batchId===t.batchId&&Vr(this.mutations,t.mutations,Vs)&&Vr(this.baseMutations,t.baseMutations,Vs)},ba),ma=(wa.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=vu,i=t.mutations,o=0;o<i.length;o++)r=r.Ht(i[o].key,n[o].version);return new wa(t,e,n,r)},wa);function wa(t,e,n,r){this.batch=t,this.Os=e,this.xs=n,this.ks=r}function ba(t,e,n,r){this.batchId=t,this.Ds=e,this.baseMutations=n,this.mutations=r}function _a(){this.Vs=[]}function Ea(t){var e=ea({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?es(e,e.limit,"L"):e}var Ta=(Na.prototype.Qs=function(t,e){return this.Us.add(e),ca.resolve()},Na.prototype.Ks=function(t,e){return ca.resolve(this.Us.getEntries(e))},Na),Ia=(Aa.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new hu(vi.J),t=!r.has(n);return this.index[e]=r.add(n),t},Aa.prototype.has=function(t){var e=t.et(),t=t.Z(),e=this.index[e];return e&&e.has(t)},Aa.prototype.getEntries=function(t){return(this.index[t]||new hu(vi.J)).rt()},Aa);function Aa(){this.index={}}function Na(){this.Us=new Ia}function Sa(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==jr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Nr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Oa=(qa.prototype.get=function(t){var e=this.ii(t),e=this.oi[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.ri(o,t))return i}},qa.prototype.has=function(t){return void 0!==this.get(t)},qa.prototype.set=function(t,e){var n=this.ii(t),r=this.oi[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ri(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.oi[n]=[[t,e]]},qa.prototype.delete=function(t){var e=this.ii(t),n=this.oi[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ri(n[r][0],t))return 1===n.length?delete this.oi[e]:n.splice(r,1),!0;return!1},qa.prototype.forEach=function(s){Si(this.oi,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},qa.prototype.nt=function(){return Oi(this.oi)},qa),Te=(ja.prototype.ui=function(t){t=this.ci.get(t);return t?t.readTime:yi.min()},ja.prototype.hi=function(t,e){this.li(),this.ci.set(t.key,{_i:t,readTime:e})},ja.prototype.fi=function(t,e){void 0===e&&(e=null),this.li(),this.ci.set(t,{_i:null,readTime:e})},ja.prototype.di=function(t,e){this.li();var n=this.ci.get(e);return void 0!==n?ca.resolve(n._i):this.wi(t,e)},ja.prototype.getEntries=function(t,e){return this.Ei(t,e)},ja.prototype.apply=function(t){return this.li(),this.ai=!0,this.Ti(t)},ja.prototype.li=function(){},ja),Da=(Ma.prototype.next=function(){return this.$i+=2,this.$i},Ma.Bi=function(){return new Ma(0)},Ma.qi=function(){return new Ma(-1)},Ma),Ca=(Ua.prototype.Jo=function(e,n){var r=this;return this.Ho.Si(e,n).next(function(t){return r.Yo(e,n,t)})},Ua.prototype.Yo=function(t,r,i){return this.Eo.di(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Ns(r,t);return t})},Ua.prototype.Xo=function(t,e,i){var o=lu;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Ns(t,e);o=o.Ht(t,e)}),o},Ua.prototype.Zo=function(e,t){var n=this;return this.Eo.getEntries(e,t).next(function(t){return n.tc(e,t)})},Ua.prototype.tc=function(e,r){var i=this;return this.Ho.Di(e,r).next(function(t){var t=i.Xo(e,r,t),n=lu;return t.forEach(function(t,e){e=e||new oo(t,yi.min()),n=n.Ht(t,e)}),n})},Ua.prototype.jr=function(t,e,n){return r=e,wi.Et(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ec(t,e.path):$o(e)?this.nc(t,e,n):this.sc(t,e,n);var r},Ua.prototype.ec=function(t,e){return this.Jo(t,new wi(e)).next(function(t){var e=yu;return t instanceof io&&(e=e.Ht(t.key,t)),e})},Ua.prototype.nc=function(n,r,i){var o=this,s=r.collectionGroup,u=yu;return this.Ii.Ks(n,s).next(function(t){return ca.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Ko(t,null,e.Nt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.sc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ht(t,e)})})}).next(function(){return u})})},Ua.prototype.sc=function(e,n,t){var c,h,r=this;return this.Eo.jr(e,n,t).next(function(t){return c=t,r.Ho.xi(e,n)}).next(function(t){return h=t,r.ic(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Ps(s,a,a,r.Ds);c=a instanceof io?c.Ht(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){os(n,e)||(c=c.remove(t))}),c})},Ua.prototype.ic=function(t,e,n){for(var r=mu(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof qs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Eo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof io&&(c=c.Ht(t,e))}),c})},Ua),La=(xa.cc=function(t,e){for(var n=mu(),r=mu(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new xa(t,e.fromCache,n,r)},xa),Ra=(Va.prototype.ac=function(t){this.uc=t},Va.prototype.jr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Nt.length||1===r.Nt.length&&r.Nt[0].field.ht())||i.isEqual(yi.min())?this.hc(e,r):this.uc.Zo(e,o).next(function(t){var n=s.lc(r,t);return(Wo(r)||Xo(r))&&s._c(r.limitType,n,o,i)?s.hc(e,r):(Ar()<=u.DEBUG&&Nr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),is(r)),s.uc.jr(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ht(t.key,t)}),e}))})},Va.prototype.lc=function(n,t){var r=new hu(ss(n));return t.forEach(function(t,e){e instanceof io&&os(n,e)&&(r=r.add(e))}),r},Va.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.u(r))},Va.prototype.hc=function(t,e){return Ar()<=u.DEBUG&&Nr("QueryEngine","Using full collection scan to execute query:",is(e)),this.uc.jr(t,e,yi.min())},Va),ka=(Pa.prototype.Ar=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.br(t,n.dc)})},Pa);function Pa(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new ru(Pr),this.wc=new Oa(lo,po),this.Ec=yi.min(),this.Ho=t.Wo(n),this.Tc=t.kr(),this.wo=t.Cr(),this.Ic=new Ca(this.Tc,this.Ho,this.persistence.jo()),this.To=t.Go(),this.fc.ac(this.Ic)}function Va(){}function xa(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}function Ua(t,e,n){this.Eo=t,this.Ho=e,this.Ii=n}function Ma(t){this.$i=t}function ja(){this.ci=new Oa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ai=!1}function qa(t,e){this.ii=t,this.ri=e,this.oi={}}function Fa(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ho,m=e.Ic,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Ho.vi(v).next(function(t){return g=t,n=e.persistence.Wo(o),m=new Ca(e.Tc,n,e.persistence.jo()),n.vi(v)}).next(function(t){for(var e=[],n=[],r=mu(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zo(v,r).next(function(t){return{mc:t,Ac:e,Rc:n}})})})];case 1:return r=t.sent(),[2,(e.Ho=n,e.Ic=m,e.fc.ac(e.Ic),r)]}})})}function Ha(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Tc.Or({Gr:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ca.resolve(),n.forEach(function(n){u=u.next(function(){return o.di(r,n)}).next(function(t){var e=t,t=i.ks.get(n);Lr(null!==t),(!e||e.version.u(t)<0)&&(e=s.Cs(n,e,i))&&o.hi(e,i.Os)})}),u.next(function(){return e.Ho.Ni(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.Ho.ki(t)}).next(function(){return f.Ic.Zo(t,a)})})}function Ga(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.wo.Wi(t)})}function za(t,r){var a=t,c=r.Mt,h=a.dc;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Tc.Or({Gr:!0});h=a.dc;var u=[];r.Oe.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.wo.rr(s,t.Ke,e).next(function(){return a.wo.sr(s,t.Ue,e)})),0<(i=t.resumeToken).o()&&(n=o.$t(i,c).Lt(s.Ss),h=h.Ht(e,n),r=o,i=t,Lr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.Mt.j()-r.Mt.j()||0<i.Ue.size+i.Qe.size+i.Ke.size)&&u.push(a.wo.Yi(s,n))))});var e,n=lu;return r.Me.forEach(function(t,e){r.Le.has(t)&&u.push(a.persistence.mi.Mr(s,t))}),u.push(Ba(s,t,r.Me,c,void 0).next(function(t){n=t})),c.isEqual(yi.min())||(e=a.wo.Wi(s).next(function(t){return a.wo.Gi(s,s.Ss,c)}),u.push(e)),ca.$n(u).next(function(){return t.apply(s)}).next(function(){return a.Ic.tc(s,n)})}).then(function(t){return a.dc=h,t})}function Ba(t,s,e,u,a){var n=mu();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=lu;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof oo&&e.version.isEqual(yi.min())?(s.fi(t,r),o=o.Ht(t,e)):null==n||0<e.version.u(n.version)||0===e.version.u(n.version)&&n.hasPendingWrites?(s.hi(e,r),o=o.Ht(t,e)):Nr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Ka(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.wo.nr(e,r).next(function(t){return t?(n=t,ca.resolve(n)):i.wo.Ui(e).next(function(t){return n=new us(r,t,0,e.Ss),i.wo.zi(e,n).next(function(){return n})})})}).then(function(t){var e=i.dc.get(t.targetId);return(null===e||0<t.Mt.u(e.Mt))&&(i.dc=i.dc.Ht(t.targetId,t),i.wc.set(r,t.targetId)),t})}function Ja(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).dc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.mi.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!fa(r=t.sent()))throw r;return Nr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.dc=e.dc.remove(o),e.wc.delete(n.target),[2]}})})}function Wa(t,o,s){var u=t,a=yi.min(),c=mu();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=ts(o),(void 0!==(t=(i=t).wc.get(r))?ca.resolve(i.dc.get(t)):i.wo.nr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.wo.ar(e,t.targetId).next(function(t){c=t})}).next(function(){return u.fc.jr(e,o,s?a:yi.min(),s?c:mu())}).next(function(t){return{documents:t,Pc:c}});var t,n,r,i})}var Xa,Ya,Qa,$a=(Lc.prototype.Ls=function(t,e){return ca.resolve(this.bc.get(e))},Lc.prototype.$s=function(t,e){return this.bc.set(e.id,{id:e.id,version:e.version,createTime:zu(e.createTime)}),ca.resolve()},Lc.prototype.Bs=function(t,e){return ca.resolve(this.vc.get(e))},Lc.prototype.qs=function(t,e){return this.vc.set(e.name,{name:(e=e).name,query:Ea(e.bundledQuery),readTime:zu(e.readTime)}),ca.resolve()},Lc),Za=(Cc.prototype.nt=function(){return this.Sc.nt()},Cc.prototype.ir=function(t,e){e=new tc(t,e);this.Sc=this.Sc.add(e),this.Cc=this.Cc.add(e)},Cc.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.ir(t,e)})},Cc.prototype.cr=function(t,e){this.Fc(new tc(t,e))},Cc.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.cr(t,e)})},Cc.prototype.kc=function(t){var e=this,n=new wi(new vi([])),r=new tc(n,t),t=new tc(n,t+1),i=[];return this.Cc.Ae([r,t],function(t){e.Fc(t),i.push(t.key)}),i},Cc.prototype.Mc=function(){var e=this;this.Sc.forEach(function(t){return e.Fc(t)})},Cc.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},Cc.prototype.Lc=function(t){var e=new wi(new vi([])),n=new tc(e,t),t=new tc(e,t+1),r=mu();return this.Cc.Ae([n,t],function(t){r=r.add(t.key)}),r},Cc.prototype.Mi=function(t){var e=new tc(t,0),e=this.Sc.Pe(e);return null!==e&&t.isEqual(e.key)},Cc),tc=(Dc.Dc=function(t,e){return wi.J(t.key,e.key)||Pr(t.$c,e.$c)},Dc.xc=function(t,e){return Pr(t.$c,e.$c)||wi.J(t.key,e.key)},Dc),ec=(Oc.prototype.Pi=function(t){return ca.resolve(0===this.Ho.length)},Oc.prototype.yi=function(t,e,n,r){var i=this.Bc;this.Bc++,0<this.Ho.length&&this.Ho[this.Ho.length-1];n=new ga(i,e,n,r);this.Ho.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.qc=this.qc.add(new tc(u.key,i)),this.Ii.Qs(t,u.key.path.Z())}return ca.resolve(n)},Oc.prototype.gi=function(t,e){return ca.resolve(this.Uc(e))},Oc.prototype.pi=function(t,e){e+=1,e=this.Qc(e),e=e<0?0:e;return ca.resolve(this.Ho.length>e?this.Ho[e]:null)},Oc.prototype.bi=function(){return ca.resolve(0===this.Ho.length?-1:this.Bc-1)},Oc.prototype.vi=function(t){return ca.resolve(this.Ho.slice())},Oc.prototype.Si=function(t,e){var n=this,r=new tc(e,0),e=new tc(e,Number.POSITIVE_INFINITY),i=[];return this.qc.Ae([r,e],function(t){t=n.Uc(t.$c);i.push(t)}),ca.resolve(i)},Oc.prototype.Di=function(t,e){var n=this,r=new hu(Pr);return e.forEach(function(t){var e=new tc(t,0),t=new tc(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,t],function(t){r=r.add(t.$c)})}),ca.resolve(this.Kc(r))},Oc.prototype.xi=function(t,e){var n=e.path,r=n.length+1,e=n;wi.Et(e)||(e=e.child(""));var e=new tc(new wi(e),0),i=new hu(Pr);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(i=i.add(t.$c)),!0)},e),ca.resolve(this.Kc(i))},Oc.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Uc(t);null!==t&&n.push(t)}),n},Oc.prototype.Ni=function(n,r){var i=this;Lr(0===this.Wc(r.batchId,"removed")),this.Ho.shift();var o=this.qc;return ca.forEach(r.mutations,function(t){var e=new tc(t.key,r.batchId);return o=o.delete(e),i.mi.Oi(n,t.key)}).next(function(){i.qc=o})},Oc.prototype.Fi=function(t){},Oc.prototype.Mi=function(t,e){var n=new tc(e,0),n=this.qc.Pe(n);return ca.resolve(e.isEqual(n&&n.key))},Oc.prototype.ki=function(t){return this.Ho.length,ca.resolve()},Oc.prototype.Wc=function(t,e){return this.Qc(t)},Oc.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},Oc.prototype.Uc=function(t){t=this.Qc(t);return t<0||t>=this.Ho.length?null:this.Ho[t]},Oc),nc=(Sc.prototype.hi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.jc(e);return this.docs=this.docs.Ht(r,{_i:e,size:i,readTime:n}),this.size+=i-o,this.Ii.Qs(t,r.path.Z())},Sc.prototype.fi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Sc.prototype.di=function(t,e){e=this.docs.get(e);return ca.resolve(e?e._i:null)},Sc.prototype.getEntries=function(t,e){var n=this,r=lu;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e._i:null)}),ca.resolve(r)},Sc.prototype.jr=function(t,e,n){for(var r=yu,i=new wi(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),u=s.key,a=s.value,s=a._i,a=a.readTime;if(!e.path.st(u.path))break;a.u(n)<=0||s instanceof io&&os(e,s)&&(r=r.Ht(s.key,s))}return ca.resolve(r)},Sc.prototype.Gc=function(t,e){return ca.forEach(this.docs,function(t){return e(t)})},Sc.prototype.Or=function(t){return new rc(this)},Sc.prototype.Lr=function(t){return ca.resolve(this.size)},Sc),rc=(f(Nc,Qa=Te),Nc.prototype.Ti=function(n){var r=this,i=[];return this.ci.forEach(function(t,e){e&&e._i?i.push(r.zr.hi(n,e._i,r.ui(t))):r.zr.fi(t)}),ca.$n(i)},Nc.prototype.wi=function(t,e){return this.zr.di(t,e)},Nc.prototype.Ei=function(t,e){return this.zr.getEntries(t,e)},Nc),ic=(Ac.prototype.mn=function(t,n){return this.zc.forEach(function(t,e){return n(e)}),ca.resolve()},Ac.prototype.Wi=function(t){return ca.resolve(this.lastRemoteSnapshotVersion)},Ac.prototype.ji=function(t){return ca.resolve(this.Hc)},Ac.prototype.Ui=function(t){return this.highestTargetId=this.Yc.next(),ca.resolve(this.highestTargetId)},Ac.prototype.Gi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),ca.resolve()},Ac.prototype.Hi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new Da(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},Ac.prototype.zi=function(t,e){return this.Hi(e),this.targetCount+=1,ca.resolve()},Ac.prototype.Yi=function(t,e){return this.Hi(e),ca.resolve()},Ac.prototype.Xi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),--this.targetCount,ca.resolve()},Ac.prototype.tr=function(n,r,i){var o=this,s=0,u=[];return this.zc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.zc.delete(t),u.push(o.Zi(n,e.targetId)),s++)}),ca.$n(u).next(function(){return s})},Ac.prototype.er=function(t){return ca.resolve(this.targetCount)},Ac.prototype.nr=function(t,e){e=this.zc.get(e)||null;return ca.resolve(e)},Ac.prototype.sr=function(t,e,n){return this.Jc.Nc(e,n),ca.resolve()},Ac.prototype.rr=function(e,t,n){this.Jc.Oc(t,n);var r=this.persistence.mi,i=[];return r&&t.forEach(function(t){i.push(r.Oi(e,t))}),ca.$n(i)},Ac.prototype.Zi=function(t,e){return this.Jc.kc(e),ca.resolve()},Ac.prototype.ar=function(t,e){e=this.Jc.Lc(e);return ca.resolve(e)},Ac.prototype.Mi=function(t,e){return ca.resolve(this.Jc.Mi(e))},Ac),oc=(Ic.prototype.start=function(){return Promise.resolve()},Ic.prototype.$o=function(){return this.oo=!1,Promise.resolve()},Object.defineProperty(Ic.prototype,"Ir",{get:function(){return this.oo},enumerable:!1,configurable:!0}),Ic.prototype.Vo=function(){},Ic.prototype.po=function(){},Ic.prototype.jo=function(){return this.Ii},Ic.prototype.Wo=function(t){var e=this.Xc[t.R()];return e||(e=new ec(this.Ii,this.mi),this.Xc[t.R()]=e),e},Ic.prototype.Cr=function(){return this.wo},Ic.prototype.kr=function(){return this.Eo},Ic.prototype.Go=function(){return this.To},Ic.prototype.runTransaction=function(t,e,n){var r=this;Nr("MemoryPersistence","Starting transaction:",t);var i=new sc(this.ro.next());return this.mi.ta(),n(i).next(function(t){return r.mi.ea(i).next(function(){return t})}).Mn().then(function(t){return i.bs(),t})},Ic.prototype.na=function(e,n){return ca.Bn(Object.values(this.Xc).map(function(t){return function(){return t.Mi(e,n)}}))},Ic),sc=(f(Tc,Ya=o),Tc),uc=(Ec.ra=function(t){return new Ec(t)},Object.defineProperty(Ec.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw Cr()},enumerable:!1,configurable:!0}),Ec.prototype.ir=function(t,e,n){return this.sa.ir(n,e),this.oa.delete(n.toString()),ca.resolve()},Ec.prototype.cr=function(t,e,n){return this.sa.cr(n,e),this.oa.add(n.toString()),ca.resolve()},Ec.prototype.Oi=function(t,e){return this.oa.add(e.toString()),ca.resolve()},Ec.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Cr();return r.ar(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Xi(t,e)})},Ec.prototype.ta=function(){this.ia=new Set},Ec.prototype.ea=function(n){var r=this,i=this.persistence.kr().Or();return ca.forEach(this.oa,function(t){var e=wi.ft(t);return r.ca(n,e).next(function(t){t||i.fi(e)})}).next(function(){return r.ia=null,i.apply(n)})},Ec.prototype.Mr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},Ec.prototype.Zc=function(t){return 0},Ec.prototype.ca=function(t,e){var n=this;return ca.Bn([function(){return ca.resolve(n.sa.Mi(e))},function(){return n.persistence.Cr().Mi(t,e)},function(){return n.persistence.na(t,e)}])},Ec),ac=(_c.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},_c.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},_c.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},_c),cc=(bc.prototype.xa=function(t){},bc.prototype.Fa=function(t,e,n){},bc.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},bc.prototype.qa=function(t,e,n){this.ou[t]=e},bc.prototype.La=function(t){this.ru.la(t)},bc.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},bc.prototype.Ba=function(t){delete this.ou[t]},bc.prototype.Sa=function(){return this.ru.activeTargetIds},bc.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},bc.prototype.start=function(){return this.ru=new ac,Promise.resolve()},bc.prototype.Qa=function(t,e,n){},bc.prototype.Ka=function(t){},bc.prototype.$o=function(){},bc.prototype.q=function(t){},bc.prototype.ja=function(){},bc),hc=(wc.prototype.cu=function(t){},wc.prototype.$o=function(){},wc),fc=(mc.prototype.cu=function(t){this._u.push(t)},mc.prototype.$o=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},mc.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},mc.prototype.uu=function(){Nr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},mc.prototype.lu=function(){Nr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},mc.Wn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},mc),lc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},pc=(gc.prototype.Eu=function(t){this.Tu=t},gc.prototype.Iu=function(t){this.mu=t},gc.prototype.onMessage=function(t){this.Au=t},gc.prototype.close=function(){this.wu()},gc.prototype.send=function(t){this.du(t)},gc.prototype.Ru=function(){this.Tu()},gc.prototype.Pu=function(t){this.mu(t)},gc.prototype.yu=function(t){this.Au(t)},gc),dc=(vc.prototype.bu=function(e,t,n,r){var i=this.vu(e,t);Nr("RestConnection","Sending: ",i,n);t={};return this.Su(t,r),this.Du(e,i,t,n).then(function(t){return Nr("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},vc.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},vc.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.1",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},vc.prototype.vu=function(t,e){t=lc[t];return this.Vu+"/v1/"+e+":"+t},f(yc,Xa=vc),yc.prototype.Du=function(o,e,s,u){return new Promise(function(n,r){var i=new Tr;i.listenOnce(mr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case gr.NO_ERROR:var t=i.getResponseJson();Nr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case gr.TIMEOUT:Nr("Connection",'RPC "'+o+'" timed out'),r(new qr(jr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=i.getStatus();Nr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(jr).indexOf(e)?e:jr.UNKNOWN,r(new qr(e,t.message))):r(new qr(jr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new qr(jr.UNAVAILABLE,"Connection failed."));break;default:Cr()}}finally{Nr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},yc.prototype.xu=function(t,e){var n,r=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,o=vr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Nr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new pc({du:function(t){a?Nr("Connection","Not sending because WebChannel is closed:",t):(u||(Nr("Connection","Opening WebChannel transport."),s.open(),u=!0),Nr("Connection","WebChannel sending:",t),s.send(t))},wu:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Er.EventType.OPEN,function(){a||Nr("Connection","WebChannel transport opened.")}),t(s,Er.EventType.CLOSE,function(){a||(a=!0,Nr("Connection","WebChannel transport closed"),c.Pu())}),t(s,Er.EventType.ERROR,function(t){a||(a=!0,Or("Connection","WebChannel transport errored:",t),c.Pu(new qr(jr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Er.EventType.MESSAGE,function(t){var e,n,r,i;a||(Lr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Nr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ws[r];if(void 0!==t)return nu(t)}(),i=n.message,void 0===t&&(t=jr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Pu(new qr(t,i)),s.close()):(Nr("Connection","WebChannel received:",e),c.yu(e)))}),t(o,wr.STAT_EVENT,function(t){t.stat===br?Nr("Connection","Detected buffering proxy"):t.stat===_r&&Nr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Ru()},0),c},yc);function yc(t){var e=this;return(e=Xa.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.I=t.I,e}function vc(t){this.gu=t,this.T=t.T;var e=t.ssl?"https":"http";this.Vu=e+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}function gc(t){this.du=t.du,this.wu=t.wu}function mc(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}function wc(){}function bc(){this.ru=new ac,this.ou={},this.da=null,this.L=null}function _c(){this.activeTargetIds=wu}function Ec(t){this.persistence=t,this.sa=new Za,this.ia=null}function Tc(t){var e=this;return(e=Ya.call(this)||this).Ss=t,e}function Ic(t,e){var n=this;this.Xc={},this.ro=new si(0),this.oo=!1,this.oo=!0,this.mi=t(this),this.wo=new ic(this),this.Ii=new Ta,this.Eo=(t=this.Ii,new nc(t,function(t){return n.mi.Zc(t)})),this.Kt=new va(e),this.To=new $a(this.Kt)}function Ac(t){this.persistence=t,this.zc=new Oa(lo,po),this.lastRemoteSnapshotVersion=yi.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new Za,this.targetCount=0,this.Yc=Da.Bi()}function Nc(t){var e=this;return(e=Qa.call(this)||this).zr=t,e}function Sc(t,e){this.Ii=t,this.jc=e,this.docs=new ru(wi.J),this.size=0}function Oc(t,e){this.Ii=t,this.mi=e,this.Ho=[],this.Bc=1,this.qc=new hu(tc.Dc)}function Dc(t,e){this.key=t,this.$c=e}function Cc(){this.Sc=new hu(tc.Dc),this.Cc=new hu(tc.xc)}function Lc(t){this.Kt=t,this.bc=new Map,this.vc=new Map}function Rc(){return"undefined"!=typeof document?document:null}function kc(t){return new Fu(t,!0)}function Pc(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Fh=new Set,this.Oh=[],this.kh=i,this.kh.cu(function(t){n.ys(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return rh(this)?(Nr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Fh.add(4),[4,Yc(e)];case 1:return t.sent(),e.Mh.set("Unknown"),e.Fh.delete(4),[4,Xc(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new Hc(n,r)}var Vc,xc,Uc,Mc=(Wc.prototype.reset=function(){this.ku=0},Wc.prototype.$u=function(){this.ku=this.Ou},Wc.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);0<i&&Nr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.no.mr(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Fu,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Ou&&(this.ku=this.Ou)},Wc.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},Wc.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},Wc.prototype.qu=function(){return(Math.random()-.5)*this.ku},Wc),Te=(Jc.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},Jc.prototype.Ju=function(){return 2===this.state},Jc.prototype.start=function(){3!==this.state?this.auth():this.Yu()},Jc.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Jc.prototype.Xu=function(){this.state=0,this.zu.reset()},Jc.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.no.mr(this.Qu,6e4,function(){return t.th()}))},Jc.prototype.eh=function(t){this.nh(),this.stream.send(t)},Jc.prototype.th=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},Jc.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},Jc.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.nh(),this.zu.cancel(),this.ju++,3!==e?this.zu.reset():n&&n.code===jr.RESOURCE_EXHAUSTED?(Sr(n.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):n&&n.code===jr.UNAUTHENTICATED&&this.Wu.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Iu(n)];case 1:return t.sent(),[2]}})})},Jc.prototype.sh=function(){},Jc.prototype.auth=function(){var n=this;this.state=1;var t=this.ih(this.ju),e=this.ju;this.Wu.getToken().then(function(t){n.ju===e&&n.rh(t)},function(e){t(function(){var t=new qr(jr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.oh(t)})})},Jc.prototype.rh=function(t){var e=this,n=this.ih(this.ju);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Jc.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Jc.prototype.oh=function(t){return Nr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Jc.prototype.ih=function(e){var n=this;return function(t){n.no.ys(function(){return n.ju===e?t():(Nr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Jc),jc=(f(Kc,Uc=Te),Kc.prototype.ah=function(t){return this.Ku.xu("Listen",t)},Kc.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Cr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.qt?(Lr(void 0===s||"string"==typeof s),xr.fromBase64String(s||"")):(Lr(void 0===s||s instanceof Uint8Array),xr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?jr.UNKNOWN:nu(c.code),new qr(a,c.message||"")),s=new Su(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=Wu(t,n.document.name),i=zu(n.document.updateTime);var u=new Qi({mapValue:{fields:n.document.fields}}),a=(o=new io(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new Au(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Wu(t,n.document),i=n.readTime?zu(n.readTime):yi.min(),u=new oo(r,i),o=n.removedTargetIds||[],s=new Au([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Wu(t,n.document),i=n.removedTargetIds||[],s=new Au([],i,r,null);else{if(!("filter"in e))return Cr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new Js(n),i=e.targetId,s=new Nu(i,r)}return s}(this.Kt,t),t=function(t){if(!("targetChange"in t))return yi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?zu(t.readTime):yi.min()}(t);return this.listener.uh(e,t)},Kc.prototype.hh=function(t){var e,n,r,i={};i.database=Yu(this.Kt),i.addTarget=(e=this.Kt,(r=yo(r=(n=t).target)?{documents:{documents:[Xu(e,r.path)]}}:{query:ta(e,r)}).targetId=n.targetId,0<n.resumeToken.o()?r.resumeToken=Gu(e,n.resumeToken):0<n.Mt.u(yi.min())&&(r.readTime=Hu(e,n.Mt.G())),r);var o,t=(this.Kt,o=t,null==(t=function(){switch(o.kt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Cr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.eh(i)},Kc.prototype.lh=function(t){var e={};e.database=Yu(this.Kt),e.removeTarget=t,this.eh(e)},Kc),qc=(f(Bc,xc=Te),Object.defineProperty(Bc.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),Bc.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,xc.prototype.start.call(this)},Bc.prototype.sh=function(){this._h&&this.dh([])},Bc.prototype.ah=function(t){return this.Ku.xu("Write",t)},Bc.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Lr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?zu(t.updateTime):zu(e);n.isEqual(yi.min())&&(n=zu(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Cs(n,e)}(t,r)})):[]),n=zu(t.commitTime);return this.listener.wh(n,e)}var n,r;return Lr(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},Bc.prototype.Th=function(){var t={};t.database=Yu(this.Kt),this.eh(t)},Bc.prototype.dh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Zu(e.Kt,t)})};this.eh(t)},Bc),Fc=(f(zc,Vc=function(){}),zc.prototype.mh=function(){if(this.Ih)throw new qr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},zc.prototype.bu=function(e,n,r){var i=this;return this.mh(),this.credentials.getToken().then(function(t){return i.Ku.bu(e,n,r,t)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&i.credentials.v(),t})},zc.prototype.Cu=function(e,n,r){var i=this;return this.mh(),this.credentials.getToken().then(function(t){return i.Ku.Cu(e,n,r,t)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&i.credentials.v(),t})},zc.prototype.terminate=function(){this.Ih=!1},zc),Hc=(Gc.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.mr("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},Gc.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,1<=this.Ah&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},Gc.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},Gc.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},Gc.prototype.Vh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(Sr(t),this.Ph=!1):Nr("OnlineStateTracker",t)},Gc.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},Gc);function Gc(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}function zc(t,e,n){var r=this;return(r=Vc.call(this)||this).credentials=t,r.Ku=e,r.Kt=n,r.Ih=!1,r}function Bc(t,e,n,r,i){var o=this;return(o=xc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Kt=r,o._h=!1,o}function Kc(t,e,n,r,i){var o=this;return(o=Uc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Kt=r,o}function Jc(t,e,n,r,i,o){this.no=t,this.Qu=n,this.Ku=r,this.Wu=i,this.listener=o,this.state=0,this.ju=0,this.Gu=null,this.stream=null,this.zu=new Mc(t,e)}function Wc(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.no=t,this.ds=e,this.Nu=n,this.Fu=r,this.Ou=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}function Xc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!rh(r))return[3,4];e=0,n=r.Oh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Yc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Oh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Qc(t,e){t.Nh.has(e.targetId)||(t.Nh.set(e.targetId,e),nh(t)?eh(t):fh(t).Ju()&&Zc(t,e))}function $c(t,e){var n=t,t=fh(n);n.Nh.delete(e),t.Ju()&&th(n,e),0===n.Nh.size&&(t.Ju()?t.Zu():rh(n)&&n.Mh.set("Unknown"))}function Zc(t,e){t.Lh.cn(e.targetId),fh(t).hh(e)}function th(t,e){t.Lh.cn(e),fh(t).lh(e)}function eh(e){e.Lh=new Du({Sn:function(t){return e.Ch.Sn(t)},Dn:function(t){return e.Nh.get(t)||null}}),fh(e).start(),e.Mh.yh()}function nh(t){return rh(t)&&!fh(t).Hu()&&0<t.Nh.size}function rh(t){return 0===t.Fh.size}function ih(t){t.Lh=void 0}function oh(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Mh.set("Online"),!(u instanceof Su&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Nh.has(i)?[4,o.Ch.$h(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Nh.delete(i),o.Lh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Nr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,sh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Au?s.Lh.wn(u):u instanceof Nu?s.Lh.yn(u):s.Lh.In(u),a.isEqual(yi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ga(s.Sh)];case 8:return o=t.sent(),0<=a.u(o)?[4,(i=a,(e=(r=s).Lh.pn(i)).Oe.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.Nh.get(e))&&r.Nh.set(e,n.$t(t.resumeToken,i)))}),e.ke.forEach(function(t){var e=r.Nh.get(t);e&&(r.Nh.set(t,e.$t(xr.h,e.Mt)),th(r,t),e=new us(e.target,t,1,e.sequenceNumber),Zc(r,e))}),r.Ch.Bh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Nr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,sh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function sh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!fa(r))throw r;return n.Fh.add(1),[4,Yc(n)];case 1:return t.sent(),n.Mh.set("Offline"),i=i||function(){return Ga(n.Sh)},n.fs.vo(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Fh.delete(1),[4,Xc(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function uh(e,n){return n().catch(function(t){return sh(e,t,n)})}function ah(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=lh(i=a),s=0<i.xh.length?i.xh[i.xh.length-1].batchId:-1,t.label=1;case 1:if(!(rh(i)&&i.xh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Sh,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Ho.pi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.xh.length&&o.Zu(),[3,7]):(s=u.batchId,function(t,e){t.xh.push(e);t=lh(t);t.Ju()&&t.fh&&t.dh(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,sh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return ch(i)&&hh(i),[2]}var e,n,r})})}function ch(t){return rh(t)&&!lh(t).Hu()&&0<t.xh.length}function hh(t){lh(t).start()}function fh(n){var t,e,r,i=this;return n.Qh||(n.Qh=(t=n.Dh,e=n.fs,r={Eu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Nh.forEach(function(t,e){Zc(n,t)}),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return ih(e),nh(e)?(e.Mh.ph(n),eh(e)):e.Mh.set("Unknown"),[2]})})}.bind(null,n),uh:oh.bind(null,n)},t.mh(),new jc(e,t.Ku,t.credentials,t.Kt,r)),n.Oh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Qh.Xu(),nh(n)?eh(n):n.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Qh.stop()];case 2:t.sent(),ih(n),t.label=3;case 3:return[2]}})})})),n.Qh}function lh(n){var t,e,r,i=this;return n.Kh||(n.Kh=(t=n.Dh,e=n.fs,r={Eu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return lh(e).Th(),[2]})})}.bind(null,n),Iu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&lh(e).fh?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return eu(n=i.code)&&n!==jr.ABORTED?(e=r.xh.shift(),lh(r).Xu(),[4,uh(r,function(){return r.Ch.Uh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,ah(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return ch(e)&&hh(e),[2]}})})}.bind(null,n),Eh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=lh(o),n=0,r=o.xh;n<r.length;n++)i=r[n],e.dh(i.mutations);return[2]})})}.bind(null,n),wh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.xh.shift(),n=ma.from(e,i,o),[4,uh(r,function(){return r.Ch.qh(n)})];case 1:return t.sent(),[4,ah(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.mh(),new qc(e,t.Ku,t.credentials,t.Kt,r)),n.Oh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Kh.Xu(),[4,ah(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Kh.stop()];case 3:t.sent(),0<n.xh.length&&(Nr("RemoteStore","Stopping write stream with "+n.xh.length+" pending writes"),n.xh=[]),t.label=4;case 4:return[2]}})})})),n.Kh}function ph(){this.queries=new Oa(rs,ns),this.onlineState="Unknown",this.jh=new Set}var dh=function(){this.Wh=void 0,this.listeners=[]};function yh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new dh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Gh(n)];case 2:return o.Wh=t.sent(),[3,4];case 3:return o=t.sent(),o=da(o,"Initialization of query '"+is(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.zh(e.onlineState),i.Wh&&u.Hh(i.Wh)&&gh(e),[2]}})})}function vh(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Jh(n))]:[2]})})}function gh(t){t.jh.forEach(function(t){t.next()})}var mh=(Ah.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Eu(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},Ah.prototype.onError=function(t){this.Yh.error(t)},Ah.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},Ah.prototype.el=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.sl&&n||t.docs.nt()&&"Offline"!==e)},Ah.prototype.tl=function(t){if(0<t.docChanges.length)return!0;var e=this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},Ah.prototype.nl=function(t){t=Eu.Fe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},Ah),wh=(Ih.prototype.il=function(){return"metadata"in this.payload},Ih),bh=(Th.prototype.yc=function(t){return Wu(this.Kt,t)},Th.prototype.gc=function(t){return t.metadata.exists?(e=this.Kt,n=t.document,r=Wu(e,n.name),e=zu(n.updateTime),n=new Qi({mapValue:{fields:n.fields}}),new io(r,e,n,{hasCommittedMutations:!1})):new oo(this.yc(t.metadata.name),this.Vc(t.metadata.readTime));var e,n,r},Th.prototype.Vc=zu,Th),_h=(Eh.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Eh.prototype.cl=function(t){for(var e=new Map,n=new bh(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||mu()).add(s);e.set(c,h)}}return e},Eh.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=mu(),i=lu,o=vu,e=0,s=p;e<s.length;e++)u=s[e],a=l.yc(u.metadata.name),u.document&&(r=r.add(a)),i=i.Ht(a,l.gc(u)),o=o.Ht(a,l.Vc(u.metadata.readTime));return c=n.Tc.Or({Gr:!0}),[4,Ka(n,ts(Jo(vi.ct("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Ba(e,c,i,yi.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.wo.Zi(e,h.targetId).next(function(){return n.wo.sr(e,r,h.targetId)}).next(function(){return n.Ic.tc(e,t)})})})]}})})}(this.Sh,new bh(this.Kt),this.documents,this.rl.id)];case 1:e=t.sent(),n=this.cl(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=mu()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Ka(e,ts(Ea(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=zu(i.readTime);if(0<=n.Mt.u(e))return r.To.qs(t,i);e=n.$t(xr.h,e);return r.dc=r.dc.Ht(e.targetId,e),r.wo.Yi(t,e).next(function(){return r.wo.Zi(t,n.targetId)}).next(function(){return r.wo.sr(t,o,n.targetId)}).next(function(){return r.To.qs(t,i)})})]}})})}(this.Sh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new ya(Object.assign({},this.progress),e))]}})})},Eh);function Eh(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=Nh(t)}function Th(t){this.Kt=t}function Ih(t,e){this.payload=t,this.byteLength=e}function Ah(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}function Nh(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Sh=function(t){this.key=t},Oh=function(t){this.key=t},Dh=(Object.defineProperty(Ph.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),Ph.prototype.dl=function(t,e){var s=this,u=e?e.wl:new _u,a=(e||this)._l,c=(e||this).Ce,h=a,f=!1,l=Wo(this.query)&&a.size===this.query.limit?a.last():null,p=Xo(this.query)&&a.size===this.query.limit?a.first():null;if(t.Zt(function(t,e){var n=a.get(t),r=(r=e instanceof io?e:null)&&(os(s.query,r)?r:null),i=!!n&&s.Ce.has(n.key),o=!!r&&(r.bt||s.Ce.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.El(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.ll(r,l)||p&&s.ll(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Wo(this.query)||Xo(this.query))for(;h.size>this.query.limit;){var n=Wo(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{_l:h,wl:u,_c:f,Ce:c}},Ph.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},Ph.prototype.Ti=function(t,e,n){var o=this,r=this._l;this._l=t._l,this.Ce=t.Ce;var i=t.wl.Se();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ll(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Cr()}}var r,i}),this.Tl(n);var s=e?this.Il():[],n=0===this.hl.size&&this.qe?1:0,e=n!==this.ul;return this.ul=n,0!==i.length||e?{snapshot:new Eu(this.query,t._l,r,i,t.Ce,0==n,e,!1),ml:s}:{ml:s}},Ph.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ti({_l:this._l,wl:new _u,Ce:this.Ce,_c:!1},!1)):{ml:[]}},Ph.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},Ph.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},Ph.prototype.Il=function(){var e=this;if(!this.qe)return[];var n=this.hl;this.hl=mu(),this._l.forEach(function(t){e.Al(t.key)&&(e.hl=e.hl.add(t.key))});var r=[];return n.forEach(function(t){e.hl.has(t)||r.push(new Oh(t))}),this.hl.forEach(function(t){n.has(t)||r.push(new Sh(t))}),r},Ph.prototype.Rl=function(t){this.al=t.Pc,this.hl=mu();t=this.dl(t.documents);return this.Ti(t,!0)},Ph.prototype.Pl=function(){return Eu.Fe(this.query,this._l,this.Ce,0===this.ul)},Ph),Ch=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Lh=function(t){this.key=t,this.yl=!1},Rh=(Object.defineProperty(kh.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),kh);function kh(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new Oa(rs,ns),this.Dl=new Map,this.Cl=[],this.xl=new ru(wi.J),this.Nl=new Map,this.Fl=new Za,this.Ol={},this.kl=new Map,this.Ml=Da.qi(),this.onlineState="Unknown",this.Ll=void 0}function Ph(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=mu(),this.Ce=mu(),this.ll=ss(t),this._l=new bu(this.ll)}function Vh(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).gl.Ch.Bh=Uh.bind(null,e),e.gl.Ch.Sn=function(t,e){var n=t,t=n.Nl.get(e);if(t&&t.yl)return mu().add(t.key);var r=mu(),e=n.Dl.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Sl.get(s);r=r.ye(s.view.fl)}return r}.bind(null,e),e.gl.Ch.$h=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).pl.qa(s,"rejected",u),i=e.Nl.get(s),(n=i&&i.key)?(r=(r=new ru(wi.J)).Ht(n,new oo(n,yi.min())),i=mu().add(n),i=new Tu(yi.min(),new Map,new hu(Pr),r,i),[4,Uh(e,i)]):[3,2];case 1:return t.sent(),e.xl=e.xl.remove(n),e.Nl.delete(s),Bh(e),[3,4];case 2:return[4,Ja(e.Sh,s,!1).then(function(){return Hh(e,s,u)}).catch(Sa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.vl.uh=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Hh(s)&&(r=!0);u.Wh=s}}r&&gh(n)}.bind(null,e.Vl),e.vl.ql=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Vl),(s=(n=e).Sl.get(a))?(r=s.targetId,n.pl.ka(r),i=s.view.Pl(),[3,4]):[3,1];case 1:return[4,Ka(n.Sh,ts(a))];case 2:return o=t.sent(),s=n.pl.ka(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Bl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.dl(o))._c?[4,Wa(r.Sh,i.query,!1).then(function(t){t=t.documents;return i.view.dl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Oe.get(i.targetId),n=i.view.Ti(e,r.$l,n),[2,(zh(r,i.targetId,n.ml),n.snapshot)]}})})}(i,t,e,n)},[4,Wa(i.Sh,o,!0)];case 1:return n=t.sent(),r=new Dh(o,n.Pc),e=r.dl(n.documents),n=Iu.Be(s,u&&"Offline"!==i.onlineState),n=r.Ti(e,i.$l,n),zh(i,s,n.ml),r=new Ch(o,s,r),[2,(i.Sl.set(o,r),i.Dl.has(s)?i.Dl.get(s).push(o):i.Dl.set(s,[o]),n.snapshot)]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n.$l&&Qc(n.gl,o),t.label=4;case 4:return[2,i]}var e})})}function xh(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=l).gl.Ch.qh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ha(e.Sh,o)];case 2:return r=t.sent(),Fh(e,n,null),qh(e,n),e.pl.Fa(n,"acknowledged"),[4,Kh(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.gl.Ch.Uh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Sh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Ho.gi(e,r).next(function(t){return Lr(null!==t),n=t.keys(),i.Ho.Ni(e,t)}).next(function(){return i.Ho.ki(e)}).next(function(){return i.Ic.Zo(e,n)})}))];case 2:return o=t.sent(),Fh(n,u,a),qh(n,u),n.pl.Fa(u,"rejected",a),[4,Kh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Sh,a=p,h=r,f=di.now(),i=a.reduce(function(t,e){return t.add(e.key)},mu()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Ic.Zo(u,i).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),void 0!==e.fieldTransforms?function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof io?e.field(o.field):void 0,s=ls(o.transform,s||null);null!=s&&(n=(null==n?new $i:n).set(o.field,s))}return n?n.yt():null}(e.fieldTransforms,s):null);null!=s&&n.push(new qs(o.key,s,function s(t){var u=[];return Si(t.fields||{},function(t,e){var n=new mi([t]);if(Yi(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Di(u)}(s.proto.mapValue),Ls.exists(!0)))}return h.Ho.yi(u,f,n,a)})}).then(function(t){var e=t.Fs(c);return{batchId:t.batchId,ci:e}}))];case 2:return s=t.sent(),u.pl.xa(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Ol[e.currentUser.R()])||new ru(Pr)).Ht(n,o),e.Ol[e.currentUser.R()]=r,[4,Kh(u,s.ci)];case 3:return t.sent(),[4,ah(u.gl)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=da(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,c,h,f,i,o})})}function Uh(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,za(n.Sh,i)];case 2:return e=t.sent(),i.Oe.forEach(function(t,e){e=n.Nl.get(e);e&&(Lr(t.Ue.size+t.Qe.size+t.Ke.size<=1),0<t.Ue.size?e.yl=!0:0<t.Qe.size?Lr(e.yl):0<t.Ke.size&&(Lr(e.yl),e.yl=!1))}),[4,Kh(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Mh(t,n,e){var r,t=t;(t.$l&&0===e||!t.$l&&1===e)&&(r=[],t.Sl.forEach(function(t,e){e=e.view.zh(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].zh(i)&&(o=!0)}),o&&gh(t)}(t.Vl,n),r.length&&t.vl.uh(r),t.onlineState=n,t.$l&&t.pl.Ka(n))}function jh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:rh((n=o).gl)||Nr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Sh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.bi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.kl.get(r)||[]).push(s),n.kl.set(r,i),[3,4]);case 3:return i=t.sent(),i=da(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function qh(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function Fh(t,e,n){var r=t,i=r.Ol[r.currentUser.R()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Ol[r.currentUser.R()]=i)}function Hh(e,t,n){void 0===n&&(n=null),e.pl.La(t);for(var r=0,i=e.Dl.get(t);r<i.length;r++){var o=i[r];e.Sl.delete(o),n&&e.vl.ql(o,n)}e.Dl.delete(t),e.$l&&e.Fl.kc(t).forEach(function(t){e.Fl.Mi(t)||Gh(e,t)})}function Gh(t,e){var n=t.xl.get(e);null!==n&&($c(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),Bh(t))}function zh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Sh?(t.Fl.ir(o.key,e),function(t,e){e=e.key;t.xl.get(e)||(Nr("SyncEngine","New document in limbo: "+e),t.Cl.push(e),Bh(t))}(t,o)):o instanceof Oh?(Nr("SyncEngine","Document no longer in limbo: "+o.key),t.Fl.cr(o.key,e),t.Fl.Mi(o.key)||Gh(t,o.key)):Cr()}}function Bh(t){for(;0<t.Cl.length&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Lh(e)),t.xl=t.xl.Ht(e,n),Qc(t.gl,new us(ts(Jo(e.path)),n,2,si.U))}}function Kh(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Sl.nt()?[3,3]:(n.Sl.forEach(function(t,e){o.push(n.Bl(e,s,u).then(function(t){t&&(n.$l&&n.pl.qa(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=La.cc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.vl.uh(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ca.forEach(c,function(e){return ca.forEach(e.rc,function(t){return r.persistence.mi.ir(n,e.targetId,t)}).next(function(){return ca.forEach(e.oc,function(t){return r.persistence.mi.cr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!fa(e=t.sent()))throw e;return Nr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.dc.get(o),u=s.Mt,u=s.Bt(u),r.dc=r.dc.Ht(o,u));return[2]}})})}(n.Sh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Jh(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Nr("SyncEngine","User change. New user:",o.R()),[4,Fa(n.Sh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).kl.forEach(function(t){t.forEach(function(t){t.reject(new qr(jr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.kl.clear(),n.pl.Qa(o,r.Ac,r.Rc),[4,Kh(n,r.mc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Wh(t,e,n){var r=t;(function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.Sh,o=r,s=zu((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.To.Ls(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.u(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Ul({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Ql(Nh(u)),a=new _h(u,l.Sh,p.Kt),[4,p.Kl()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.ol(c)]:[3,10];case 7:return(h=t.sent())&&d.Ql(h),[4,p.Kl()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Kh(l,f.gs,void 0)];case 12:return t.sent(),[4,(r=l.Sh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.To.$s(t,e)}))];case 13:return t.sent(),d.Ul(f.progress),[3,15];case 14:return Or("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.Wl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.pl.ja()})}var Xh=($h.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Kt=kc(e.gu.T),this.pl=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Sh=this.Jl(e),[2]}})})},$h.prototype.Hl=function(t){return null},$h.prototype.Jl=function(t){return e=this.persistence,n=new Ra,r=t.Yl,t=this.Kt,new ka(e,n,r,t);var e,n,r},$h.prototype.Gl=function(t){return new oc(uc.ra,this.Kt)},$h.prototype.jl=function(t){return new cc},$h.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.$o()];case 1:return t.sent(),[4,this.persistence.$o()];case 2:return t.sent(),[2]}})})},$h),Yh=(Qh.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Sh?[3,2]:(this.Sh=n.Sh,this.pl=n.pl,this.Dh=this.Zl(r),this.gl=this.t_(r),this.Vl=this.e_(r),this.fa=this.n_(r,!n.synchronizeTabs),this.pl.da=function(t){return Mh(e.fa,t,1)},this.gl.Ch.s_=Jh.bind(null,this.fa),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Fh.delete(2),[4,Xc(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Fh.add(2),[4,Yc(e)]);case 3:t.sent(),e.Mh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.gl,this.fa.$l)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Qh.prototype.e_=function(t){return new ph},Qh.prototype.Zl=function(t){var e=kc(t.gu.T),n=(n=t.gu,new dc(n));return t=t.credentials,new Fc(t,n,e)},Qh.prototype.t_=function(t){var e=this,n=this.Sh,r=this.Dh,i=t.fs,o=function(t){return Mh(e.fa,t,0)},t=new(fc.Wn()?fc:hc);return new Pc(n,r,i,o,t)},Qh.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){o=new Rh(t,e,n,r,i,o);return s&&(o.Ll=!0),o}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},Qh.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Nr("RemoteStore","RemoteStore shutting down."),e.Fh.add(5),[4,Yc(e)];case 1:return t.sent(),e.kh.$o(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},Qh);function Qh(){}function $h(){this.synchronizeTabs=!1}function Zh(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var tf=(uf.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},uf.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},uf.prototype.r_=function(){this.muted=!0},uf.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},uf),ef=(sf.prototype.close=function(){return this.o_.cancel()},sf.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},sf.prototype.Kl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},sf.prototype.a_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.u_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.c_.decode(e),n=Number(r),isNaN(n)&&this.h_("length string ("+r+") is not valid number"),[4,this.l_(n)]);case 2:return r=t.sent(),[2,new wh(JSON.parse(r),e.length+n)]}})})},sf.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},sf.prototype.u_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},sf.prototype.l_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.f_()]:[3,3];case 1:t.sent()&&this.h_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},sf.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},sf.prototype.f_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.o_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},sf),nf=(of.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},of),rf=function(t){this._methodName=t};function of(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new qr(jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new mi(t)}function sf(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new aa,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function uf(t){this.observer=t,this.muted=!1}function af(t,e,n){if(!n)throw new qr(jr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function cf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new qr(jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function hf(t,e,n,r){if(!0===e&&!0===r)throw new qr(jr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function ff(t){if(!wi.Et(t))throw new qr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function lf(t){if(wi.Et(t))throw new qr(jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function pf(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Cr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function df(t,e){if("_delegate"in t&&(t=t._),t instanceof e)return t;if(e.name===t.constructor.name)throw new qr(jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=pf(t);throw new qr(jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function yf(t,e){if(e<=0)throw new qr(jr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var vf,gf=(Sf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Sf),mf=new Map,wf=(Object.defineProperty(Nf.prototype,"app",{get:function(){if(!this.A_)throw new qr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(Nf.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(Nf.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),Nf.prototype.g_=function(t){if(this.T_)throw new qr(jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new gf(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new ni;switch(t.type){case"gapi":var e=t.client;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new oi(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new qr(jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Nf.prototype.V_=function(){return this.E_},Nf.prototype.p_=function(){return this.T_=!0,this.E_},Nf.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},Nf.prototype.b_=function(){return(t=mf.get(this))&&(Nr("ComponentProvider","Removing Datastore"),mf.delete(this),t.terminate()),Promise.resolve();var t},Nf),bf=(Object.defineProperty(Af.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Af.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Af.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(Af.prototype,"parent",{get:function(){return new Ef(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),Af.prototype.withConverter=function(t){return new Af(this.firestore,t,this.S_)},Af),_f=(If.prototype.withConverter=function(t){return new If(this.firestore,t,this.C_)},If),Ef=(f(Tf,vf=_f),Object.defineProperty(Tf.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Tf.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(Tf.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new bf(this.firestore,null,new wi(t))},enumerable:!1,configurable:!0}),Tf.prototype.withConverter=function(t){return new Tf(this.firestore,t,this.D_)},Tf);function Tf(t,e,n){var r=this;return(r=vf.call(this,t,e,Jo(n))||this).firestore=t,r.D_=n,r.type="collection",r}function If(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function Af(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function Nf(t,e){this.w_="(lite)",this.E_=new gf({}),this.T_=!1,t instanceof Yr?(this.I_=t,this.m_=new ni):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new qr(jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yr(t.options.projectId)}(t),this.m_=new ri(e))}function Sf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new qr(jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qr(jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,hf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Of(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Hr&&(t=t._),af("collection","path",e),t instanceof wf)return lf(n=vi.ct.apply(vi,l([e],r))),new Ef(t,null,n);if(!(t instanceof bf||t instanceof Ef))throw new qr(jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return lf(n=vi.ct.apply(vi,l([t.path],r)).child(vi.ct(e))),new Ef(t.firestore,null,n)}function Df(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Hr&&(t=t._),1===arguments.length&&(e=Rr.t()),af("doc","path",e),t instanceof wf)return ff(n=vi.ct.apply(vi,l([e],r))),new bf(t,null,new wi(n));if(!(t instanceof bf||t instanceof Ef))throw new qr(jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return ff(n=t.D_.child(vi.ct.apply(vi,l([e],r)))),new bf(t.firestore,t instanceof Ef?t.v_:null,new wi(n))}function Cf(t,e){return t instanceof Hr&&(t=t._),e instanceof Hr&&(e=e._),(t instanceof bf||t instanceof Ef)&&(e instanceof bf||e instanceof Ef)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Lf(t,e){return t instanceof Hr&&(t=t._),e instanceof Hr&&(e=e._),t instanceof _f&&e instanceof _f&&t.firestore===e.firestore&&ns(t.C_,e.C_)&&t.v_===e.v_}var Rf=(Object.defineProperty(Mf.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(Mf.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),Mf.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},Mf.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},Mf.prototype.K=function(t){return Pr(this.x_,t.x_)||Pr(this.N_,t.N_)},Mf),kf=/^__.*__$/,Pf=(Uf.prototype.F_=function(t,e){return null!==this.zt?new qs(t,this.data,this.zt,e,this.fieldTransforms):new js(t,this.data,e,this.fieldTransforms)},Uf),Vf=(xf.prototype.F_=function(t,e){return new qs(t,this.data,this.zt,e,this.fieldTransforms)},xf);function xf(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function Uf(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}function Mf(t,e){if(!isFinite(t)||t<-90||90<t)throw new qr(jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new qr(jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function jf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Cr()}}var qf=(Object.defineProperty(Gf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Gf.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),Gf.prototype.M_=function(t){return new Gf(Object.assign(Object.assign({},this.settings),t),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},Gf.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.M_({path:e,B_:!1});return e.q_(t),e},Gf.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.M_({path:t,B_:!1});return t.O_(),t},Gf.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},Gf.prototype.K_=function(t){return ml(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},Gf.prototype.contains=function(e){return void 0!==this.zt.find(function(t){return e.st(t)})||void 0!==this.fieldTransforms.find(function(t){return e.st(t.field)})},Gf.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},Gf.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(jf(this.k_)&&kf.test(t))throw this.K_('Document fields cannot begin and end with "__"')},Gf),Ff=(Hf.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new qf({k_:t,methodName:e,j_:n,path:mi.at(),B_:!1,W_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},Hf);function Hf(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||kc(t)}function Gf(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.zt=o||[]}function zf(t){var e=t.p_(),n=kc(t.I_);return new Ff(t.I_,!!e.ignoreUndefinedProperties,n)}function Bf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);dl("Data must be an object, but it was:",s,r);var u,a,r=ll(r,s);if(o.merge)u=new Di(s.zt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=yl(e,f[h],n);if(!s.contains(l))throw new qr(jr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");wl(c,l)||c.push(l)}u=new Di(c),a=s.fieldTransforms.filter(function(t){return u.It(t.field)})}else u=null,a=s.fieldTransforms;return new Pf(new Qi(r),u,a)}var Kf,Jf=(f(Wf,Kf=rf),Wf.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},Wf.prototype.isEqual=function(t){return t instanceof Wf},Wf);function Wf(){return null!==Kf&&Kf.apply(this,arguments)||this}function Xf(t,e,n){return new qf({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var Yf,Qf,$f,Zf,tl=(f(ul,Zf=rf),ul.prototype.z_=function(t){return new Ds(t.path,new ys)},ul.prototype.isEqual=function(t){return t instanceof ul},ul),el=(f(sl,$f=rf),sl.prototype.z_=function(t){var e=Xf(this,t,!0),n=this.H_.map(function(t){return fl(t,e)}),n=new vs(n);return new Ds(t.path,n)},sl.prototype.isEqual=function(t){return this===t},sl),nl=(f(ol,Qf=rf),ol.prototype.z_=function(t){var e=Xf(this,t,!0),n=this.H_.map(function(t){return fl(t,e)}),n=new _s(n);return new Ds(t.path,n)},ol.prototype.isEqual=function(t){return this===t},ol),rl=(f(il,Yf=rf),il.prototype.z_=function(t){var e=new As(t.Kt,fs(t.Kt,this.J_));return new Ds(t.path,e)},il.prototype.isEqual=function(t){return this===t},il);function il(t,e){var n=this;return(n=Yf.call(this,t)||this).J_=e,n}function ol(t,e){var n=this;return(n=Qf.call(this,t)||this).H_=e,n}function sl(t,e){var n=this;return(n=$f.call(this,t)||this).H_=e,n}function ul(){return null!==Zf&&Zf.apply(this,arguments)||this}function al(t,r,i,e){var o=t.G_(1,r,i);dl("Data must be an object, but it was:",o,e);var s=[],u=new $i;Si(e,function(t,e){var n=gl(r,t,i);e instanceof Hr&&(e=e._);t=o.U_(n);e instanceof Jf?s.push(n):null!=(t=fl(e,t))&&(s.push(n),u.set(n,t))});e=new Di(s);return new Vf(u.yt(),e,o.fieldTransforms)}function cl(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[yl(e,r,n)],a=[i];if(o.length%2!=0)throw new qr(jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(yl(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new $i,y=u.length-1;0<=y;--y){wl(p,u[y])||(h=u[y],(f=a[y])instanceof Hr&&(f=f._),l=s.U_(h),f instanceof Jf?p.push(h):null!=(l=fl(f,l))&&(p.push(h),d.set(h,l)))}i=new Di(p);return new Vf(d.yt(),i,s.fieldTransforms)}function hl(t,e,n,r){return void 0===r&&(r=!1),fl(n,t.G_(r?4:3,e))}function fl(s,t){if(s instanceof Hr&&(s=s._),pl(s))return dl("Unsupported field value:",t,s),ll(s,t);if(s instanceof rf)return function(t,e){if(!jf(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");t=t.z_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.zt.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=fl(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Hr&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return fs(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=di.fromDate(t);return{timestampValue:Hu(e.Kt,n)}}if(t instanceof di)return n=new di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Hu(e.Kt,n)};if(t instanceof Rf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Fr)return{bytesValue:Gu(e.Kt,t.l)};if(t instanceof bf){n=e.T;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Bu(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+pf(t))}(s,t)}function ll(t,n){var r={};return Oi(t)?n.path&&0<n.path.length&&n.zt.push(n.path):Si(t,function(t,e){e=fl(e,n.L_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function pl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof di||t instanceof Rf||t instanceof Fr||t instanceof bf||t instanceof rf)}function dl(t,e,n){if(!pl(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=pf(n);throw"an object"===n?e.K_(t+" a custom object"):e.K_(t+" "+n)}var r}function yl(t,e,n){if(e instanceof Hr&&(e=e._),e instanceof nf)return e.d_;if("string"==typeof e)return gl(t,e);throw ml("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var vl=new RegExp("[~\\*/\\[\\]]");function gl(e,n,r){if(0<=n.search(vl))throw ml("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(nf.bind.apply(nf,l([void 0],n.split("."))))).d_}catch(t){throw ml("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function ml(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new qr(jr.INVALID_ARGUMENT,(e+=". ")+t+n)}function wl(t,e){return t.some(function(t){return t.isEqual(e)})}var bl=(Al.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new qr(jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Yu((n=s).Kt)+"/documents",r={documents:u.map(function(t){return Ju(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.Kt,"found"in(t=t)?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=Wu(t,e.found.name),t=zu(e.found.updateTime),e=new Qi({mapValue:{fields:e.found.fields}});return new io(n,t,e,{})}(e,t):"missing"in t?function(t,e){Lr(!!e.missing),Lr(!!e.readTime);t=Wu(t,e.missing),e=zu(e.readTime);return new oo(t,e)}(e,t):Cr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Lr(!!t),o.push(t)}),o)]}})})}(this.Dh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof oo||t instanceof io?n.sf(t):Cr()}),e)]}})})},Al.prototype.set=function(t,e){this.write(e.F_(t,this.Gt(t))),this.tf.add(t.toString())},Al.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},Al.prototype.delete=function(t){this.write(new Qs(t,this.Gt(t))),this.tf.add(t.toString())},Al.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=wi.ft(e);n.mutations.push(new $s(e,n.Gt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Yu((e=i).Kt)+"/documents",r={writes:o.map(function(t){return Zu(e.Kt,t)})},[4,e.bu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},Al.prototype.sf=function(t){var e;if(t instanceof io)e=t.version;else{if(!(t instanceof oo))throw Cr();e=yi.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new qr(jr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},Al.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Ls.updateTime(e):Ls.Wt()},Al.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Ls.exists(!0);if(e.isEqual(yi.min()))throw new qr(jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ls.updateTime(e)},Al.prototype.write=function(t){this.nf(),this.mutations.push(t)},Al.prototype.nf=function(){},Al),_l=(Il.prototype.run=function(){this.af()},Il.prototype.af=function(){var t=this;this.zu.Bu(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new bl(this.Dh),(n=this.uf(e))&&n.then(function(t){r.fs.ys(function(){return e.commit().then(function(){r.Ts.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},Il.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Ui(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},Il.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},Il.prototype.lf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!eu(t)},Il),El=(Tl.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},Tl.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},Tl.prototype.df=function(){if(this.fs.wf)throw new qr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},Tl.prototype.terminate=function(){var t=this;this.fs.Ef();var n=new aa;return this.fs.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.D(),n.resolve(),[3,6];case 5:return e=t.sent(),e=da(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Tl);function Tl(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=Qr.UNAUTHENTICATED,this.clientId=Rr.t(),this._f=function(){},this.N=new aa,this.credentials.S(function(t){Nr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}function Il(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Mc(this.fs,"transaction_retry")}function Al(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function Nl(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(Nr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i.fs.Af(),Nr("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.Yl,i.ff(function(e){n.isEqual(e)||(n=e,i.fs.vo(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Fa(o.Sh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.Vo(function(){return i.terminate()}),i.mf=o,[2]}})})}(e,new Xh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function Sl(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(Nr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.fs.Af(),[4,Nl(r)];case 1:return e=t.sent(),Nr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r.fs.vo(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).fs.Af(),Nr("RemoteStore","RemoteStore received new credentials"),n=rh(e),e.Fh.add(3),[4,Yc(e)];case 1:return t.sent(),n&&e.Mh.set("Unknown"),[4,e.Ch.s_(i)];case 2:return t.sent(),e.Fh.delete(3),[4,Xc(e)];case 3:return t.sent(),[2]}})})}(i.gl,t)})}),r.If=i,[2]}})})}(e,new Yh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function Ol(t){return Nl(t).then(function(t){return t.persistence})}function Dl(t){return Nl(t).then(function(t){return t.Sh})}function Cl(t){return Sl(t).then(function(t){return t.gl})}function Ll(t){return Sl(t).then(function(t){return t.fa})}function Rl(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Sl(r)];case 1:return e=t.sent(),[2,((n=e.Vl).Gh=Vh.bind(null,e.fa),n.Jh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sl.get(o),1<(r=e.Dl.get(n.targetId)).length?[2,(e.Dl.set(n.targetId,r.filter(function(t){return!ns(t,o)})),void e.Sl.delete(o))]:e.$l?(e.pl.La(n.targetId),e.pl.Ca(n.targetId)?[3,2]:[4,Ja(e.Sh,n.targetId,!1).then(function(){e.pl.Ba(n.targetId),$c(e.gl,n.targetId),Hh(e,n.targetId)}).catch(Sa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Hh(e,n.targetId),[4,Ja(e.Sh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.fa),n)]}})})}function kl(n,r,i){var t=this;void 0===i&&(i={});var o=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new tf({next:function(t){r.ys(function(){return vh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new qr(jr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new qr(jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new mh(Jo(i.path),t,{includeMetadataChanges:!0,sl:!0});return yh(n,u)},[4,Rl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}function Pl(n,r,i){var t=this;void 0===i&&(i={});var o=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new tf({next:function(t){n.ys(function(){return vh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new qr(jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new mh(t,o,{includeMetadataChanges:!0,sl:!0});return yh(e,s)},[4,Rl(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.fs,r,i,o])]}})})}),o.promise}var Vl,xl=(Object.defineProperty(jl.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),jl.prototype.ys=function(t){this.enqueue(t)},jl.prototype.Tf=function(t){this.Sf(),this.Df(t)},jl.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Rc())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},jl.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},jl.prototype.vo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},jl.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!fa(e=t.sent()))throw e;return Nr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.zu.Bu(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},jl.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,Sr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},jl.prototype.mr=function(t,e,n){var r=this;this.Sf(),-1<this.bf.indexOf(t)&&(e=0);n=la.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(n),n},jl.prototype.Sf=function(){this.Vf&&Cr()},jl.prototype.Af=function(){},jl.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},jl.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},jl.prototype.Of=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.ws-e.ws});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Ps(),"all"!==r&&n.ds===r)break}return i.Nf()})},jl.prototype.kf=function(t){this.bf.push(t)},jl.prototype.xf=function(t){t=this.gf.indexOf(t);this.gf.splice(t,1)},jl),Ul=(f(Ml,Vl=wf),Ml.prototype.b_=function(){return this.Lf||Fl(this),this.Lf.terminate()},Ml);function Ml(t,e){var n=this;return(n=Vl.call(this,t,e)||this).Mf=new xl,n.w_="name"in t?t.name:"[DEFAULT]",n}function jl(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Mc(this,"async_queue_retry"),this.vf=function(){var t=Rc();t&&Nr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.zu.Uu()};var t=Rc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function ql(t){return t.Lf||Fl(t),t.Lf.df(),t.Lf}function Fl(t){var e,n,r=t.p_(),r=(e=t.I_,n=t.w_,new Xr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Lf=new El(t.m_,t.Mf,r)}var Hl,o=(Jl.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),ji(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ki(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Pi(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw Cr()}},Jl.prototype.jf=function(t,n){var r=this,i={};return Si(t.fields||{},function(t,e){i[t]=r.$f(e,n)}),i},Jl.prototype.Kf=function(t){return new Rf(ki(t.latitude),ki(t.longitude))},Jl.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},Jl.prototype.qf=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return Vi(e)?t(e):e}(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(xi(t));default:return null}},Jl.prototype.Bf=function(t){t=Ri(t);return new di(t.seconds,t.nanos)},Jl.prototype.Gf=function(t,e){var n=vi.ct(t);Lr(ua(n));t=new Yr(n.get(1),n.get(3)),n=new wi(n.X(5));return t.isEqual(e)||Sr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Jl),Gl=(Object.defineProperty(Kl.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(Kl.prototype,"ref",{get:function(){return new bf(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),Kl.prototype.exists=function(){return null!==this.Jf},Kl.prototype.data=function(){if(this.Jf){if(this.v_){var t=new zl(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},Kl.prototype.get=function(t){if(this.Jf){t=this.Jf.data().field(Wl("DocumentSnapshot.get",t));if(null!==t)return this.Hf.$f(t)}},Kl),zl=(f(Bl,Hl=Gl),Bl.prototype.data=function(){return Hl.prototype.data.call(this)},Bl);function Bl(){return null!==Hl&&Hl.apply(this,arguments)||this}function Kl(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}function Jl(){}function Wl(t,e){return"string"==typeof e?gl(t,e):(e instanceof Hr?e._:e).d_}function Xl(t){if(Xo(t)&&0===t.Nt.length)throw new qr(jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}Te=function(){};function Yl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].Yf(t)}return t}var Ql,$l,Zl,tp,ep,np=(f(fp,ep=Te),fp.prototype.Yf=function(t){var e=zf(t.firestore),e=function(t,e,n,r,i,o){if(r.ht()){if("array-contains"===i||"array-contains-any"===i)throw new qr(jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){dp(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(pp(n,t,c))}h={arrayValue:{values:s}}}else h=pp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||dp(o,i),h=hl(e,"where",o,"in"===i||"not-in"===i);var h=go.create(r,i,h);return function(t,e){if(e.xt()){var n=Qo(t);if(null!==n&&!n.isEqual(e.field))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Yo(t);null!==n&&yp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new qr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new qr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new _f(t.firestore,t.v_,(t=t.C_,e=t.filters.concat([e]),new Ko(t.path,t.collectionGroup,t.Nt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},fp),rp=(f(hp,tp=Te),hp.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Go(e,n);return e=r,null!==Yo(n=t)||null!==(t=Qo(n))&&yp(0,t,e.field),r}(t.C_,this.Xf,this.ed);return new _f(t.firestore,t.v_,(t=t.C_,e=t.Nt.concat([e]),new Ko(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},hp),ip=(f(cp,Zl=Te),cp.prototype.Yf=function(t){return new _f(t.firestore,t.v_,es(t.C_,this.nd,this.sd))},cp),op=(f(ap,$l=Te),ap.prototype.Yf=function(t){var e=lp(t,this.type,this.rd,this.od);return new _f(t.firestore,t.v_,(t=t.C_,e=e,new Ko(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},ap),sp=(f(up,Ql=Te),up.prototype.Yf=function(t){var e=lp(t,this.type,this.rd,this.od);return new _f(t.firestore,t.v_,(t=t.C_,e=e,new Ko(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},up);function up(t,e,n){var r=this;return(r=Ql.call(this)||this).type=t,r.rd=e,r.od=n,r}function ap(t,e,n){var r=this;return(r=$l.call(this)||this).type=t,r.rd=e,r.od=n,r}function cp(t,e,n){var r=this;return(r=Zl.call(this)||this).type=t,r.nd=e,r.sd=n,r}function hp(t,e){var n=this;return(n=tp.call(this)||this).Xf=t,n.ed=e,n.type="orderBy",n}function fp(t,e,n){var r=this;return(r=ep.call(this)||this).Xf=t,r.Zf=e,r.td=n,r.type="where",r}function lp(t,c,e,n){if(e[0]instanceof Hr&&(e[0]=e[0]._),e[0]instanceof Gl)return function(t,e,n,r){if(!n)throw new qr(jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Zo(t);o<s.length;o++){var u=s[o];if(u.field.ht())i.push(Bi(e,n.key));else{var a=n.field(u.field);if(Vi(a))throw new qr(jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.ot();throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Uo(i,r)}(t.C_,t.firestore.I_,e[0].Jf,n);var r=zf(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new qr(jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ht()){if("string"!=typeof c)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!$o(t)&&-1!==c.indexOf("/"))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(vi.ct(c));if(!wi.Et(h))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new wi(h);u.push(Bi(e,h))}else{c=hl(n,r,c);u.push(c)}}return new Uo(u,o)}(t.C_,t.firestore.I_,r,c,e,n)}function pp(t,e,n){if(n instanceof Hr&&(n=n._),"string"==typeof n){if(""===n)throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!$o(e)&&-1!==n.indexOf("/"))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(vi.ct(n));if(!wi.Et(e))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Bi(t,new wi(e))}if(n instanceof bf)return Bi(t,n.S_);throw new qr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+pf(n)+".")}function dp(t,e){if(!Array.isArray(t)||0===t.length)throw new qr(jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new qr(jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function yp(t,e,n){if(!n.isEqual(e))throw new qr(jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function vp(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}function gp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var mp,wp,bp,_p=(f(Cp,bp=o),Cp.prototype.Uf=function(t){return new Fr(t)},Cp.prototype.Qf=function(t){t=this.Gf(t,this.firestore.I_);return new bf(this.firestore,null,t)},Cp),Ep=(Dp.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Dp),Tp=(f(Op,wp=Gl),Op.prototype.exists=function(){return wp.prototype.exists.call(this)},Op.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new Ip(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},Op.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){t=this.Jf.data().field(Wl("DocumentSnapshot.get",t));if(null!==t)return this.Hf.$f(t,e.serverTimestamps)}},Op),Ip=(f(Sp,mp=Tp),Sp.prototype.data=function(t){return void 0===t&&(t={}),mp.prototype.data.call(this,t)},Sp),Ap=(Object.defineProperty(Np.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Np.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Np.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Np.prototype.forEach=function(e,n){var r=this;this.ud.docs.forEach(function(t){e.call(n,new Ip(r.zf,r.Hf,t.key,t,new Ep(r.ud.Ce.has(t.key),r.ud.fromCache),r.query.v_))})},Np.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.ud.Ne)throw new qr(jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===t||(this.hd=function(i,e){if(i.ud.De.nt()){var n=0;return i.ud.docChanges.map(function(t){var e=new Ip(i.zf,i.Hf,t.doc.key,t.doc,new Ep(i.ud.Ce.has(t.doc.key),i.ud.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.ud.De;return i.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Ip(i.zf,i.Hf,t.doc.key,t.doc,new Ep(i.ud.Ce.has(t.doc.key),i.ud.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Cr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.ld=t),this.hd},Np);function Np(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new Ep(r.hasPendingWrites,r.fromCache),this.query=n}function Sp(){return null!==mp&&mp.apply(this,arguments)||this}function Op(t,e,n,r,i,o){var s=this;return(s=wp.call(this,t,e,n,r,o)||this).zf=t,s.ad=t,s.metadata=i,s}function Dp(t,e){this.hasPendingWrites=t,this.fromCache=e}function Cp(t){var e=this;return(e=bp.call(this)||this).firestore=t,e}function Lp(t,e){return t instanceof Tp&&e instanceof Tp?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof Ap&&e instanceof Ap&&t.zf===e.zf&&Lf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var Rp,kp=(f(Pp,Rp=o),Pp.prototype.Uf=function(t){return new Fr(t)},Pp.prototype.Qf=function(t){t=this.Gf(t,this.firestore.I_);return new bf(this.firestore,null,t)},Pp);function Pp(t){var e=this;return(e=Rp.call(this)||this).firestore=t,e}function Vp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=df(t,bf);var o=df(t.firestore,Ul),s=zf(o);return e instanceof Hr&&(e=e._),Up(o,[("string"==typeof e||e instanceof nf?cl(s,"updateDoc",t.S_,e,n,r):al(s,"updateDoc",t.S_,e)).F_(t.S_,Ls.exists(!0))])}function xp(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof Hr&&(e=e._);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||vp(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return vp(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof bf?(u=df(e.firestore,Ul),a=Jo(e.S_.path),h={next:function(t){n[i]&&n[i](Mp(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=df(e,_f),u=df(s.firestore,Ul),a=s.C_,c=new kp(u),h={next:function(t){n[i]&&n[i](new Ap(u,c,s,t))},error:n[i+1],complete:n[i+2]},Xl(e.C_)),function(n,t,e){var r=this,i=new tf(h),o=new mh(t,i,e);return n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=yh,[4,Rl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.r_(),n.fs.ys(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=vh,[4,Rl(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(ql(u),a,f)}function Up(t,e){return function(n,r){var t=this,i=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=xh,[4,Ll(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(ql(t),e)}function Mp(t,e,n){var r=n.docs.get(e.S_),i=new kp(t);return new Tp(t,i,e.S_,r,new Ep(n.hasPendingWrites,n.fromCache),e.v_)}var jp=(qp.prototype.set=function(t,e,n){this.Ed();t=Fp(t,this.zf),e=gp(t.v_,e,n),n=Bf(this.wd,"WriteBatch.set",t.S_,e,null!==t.v_,n);return this.fd.push(n.F_(t.S_,Ls.Wt())),this},qp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();t=Fp(t,this.zf);return e instanceof Hr&&(e=e._),e="string"==typeof e||e instanceof nf?cl(this.wd,"WriteBatch.update",t.S_,e,n,r):al(this.wd,"WriteBatch.update",t.S_,e),this.fd.push(e.F_(t.S_,Ls.exists(!0))),this},qp.prototype.delete=function(t){this.Ed();t=Fp(t,this.zf);return this.fd=this.fd.concat(new Qs(t.S_,Ls.Wt())),this},qp.prototype.commit=function(){return this.Ed(),this.dd=!0,0<this.fd.length?this._d(this.fd):Promise.resolve()},qp.prototype.Ed=function(){if(this.dd)throw new qr(jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},qp);function qp(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=zf(t)}function Fp(t,e){if(t instanceof Hr&&(t=t._),t.firestore!==e)throw new qr(jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Hp,Gp,zp,Bp=(td.prototype.get=function(t){var e=this,n=Fp(t,this.zf),r=new _p(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Cr();t=t[0];if(t instanceof oo)return new Gl(e.zf,r,n.S_,null,n.v_);if(t instanceof io)return new Gl(e.zf,r,t.key,t,n.v_);throw Cr()})},td.prototype.set=function(t,e,n){t=Fp(t,this.zf),e=gp(t.v_,e,n),n=Bf(this.wd,"Transaction.set",t.S_,e,null!==t.v_,n);return this.Td.set(t.S_,n),this},td.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Fp(t,this.zf);return e instanceof Hr&&(e=e._),e="string"==typeof e||e instanceof nf?cl(this.wd,"Transaction.update",t.S_,e,n,r):al(this.wd,"Transaction.update",t.S_,e),this.Td.update(t.S_,e),this},td.prototype.delete=function(t){t=Fp(t,this.zf);return this.Td.delete(t.S_),this},f(Zp,zp=td),Zp.prototype.get=function(t){var e=this,n=Fp(t,this.zf),r=new kp(this.zf);return zp.prototype.get.call(this,t).then(function(t){return new Tp(e.zf,r,n.S_,t.Jf,new Ep(!1,!1),n.v_)})},Zp),Kp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Jp=($p.prototype.enableIndexedDbPersistence=function(t,e){throw new qr(jr.FAILED_PRECONDITION,Kp)},$p.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new qr(jr.FAILED_PRECONDITION,Kp)},$p.prototype.clearIndexedDbPersistence=function(t){throw new qr(jr.FAILED_PRECONDITION,Kp)},$p),Wp=(f(Qp,Gp=Hr),Object.defineProperty(Qp.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),Qp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},Qp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this._.V_().host&&Or("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Qp.prototype.enableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ol(r)];case 1:return e=t.sent(),[4,Cl(r)];case 2:return n=t.sent(),[2,(e.po(!0),(t=n).Fh.delete(0),Xc(t))]}})})})}(ql(df(this._,Ul)))},Qp.prototype.disableNetwork=function(){return function(r){var t=this;return r.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ol(r)];case 1:return e=t.sent(),[4,Cl(r)];case 2:return n=t.sent(),[2,(e.po(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Fh.add(0),[4,Yc(e)];case 1:return t.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(ql(df(this._,Ul)))},Qp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&hf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},Qp.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},Qp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},Qp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=jh,[4,Ll(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(ql(df(this._,Ul)))},Qp.prototype.onSnapshotsInSync=function(t){return e=this._,t=t,function(n,t){var e=this,r=new tf(t);return n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.jh.add(e),e.next()},[4,Rl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.r_(),n.fs.ys(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.jh.delete(e)},[4,Rl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(ql(df(e,Ul)),vp(t)?t:{next:t});var e},Object.defineProperty(Qp.prototype,"app",{get:function(){if(!this.md)throw new qr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),Qp.prototype.collection=function(t){try{return new Id(this,Of(this._,t))}catch(t){throw hd(t,"collection()","Firestore.collection()")}},Qp.prototype.doc=function(t){try{return new sd(this,Df(this._,t))}catch(t){throw hd(t,"doc()","Firestore.doc()")}},Qp.prototype.collectionGroup=function(t){try{return new _d(this,function(t,e){if(t=df(t,wf),af("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new qr(jr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new _f(t,null,(e=e,new Ko(vi.at(),e)))}(this._,t))}catch(t){throw hd(t,"collectionGroup()","Firestore.collectionGroup()")}},Qp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Sl(n).then(function(t){return t.Dh})];case 1:return e=t.sent(),new _l(n.fs,e,r,i).run(),[2]}})})}),i.promise}(ql(n=this._),function(t){return t=new Bp(n,t),e(new id(r,t))})},Qp.prototype.batch=function(){var e=this;return ql(this._),new od(new jp(this._,function(t){return Up(e._,t)}))},Qp.prototype.loadBundle=function(t){throw new qr(jr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Qp.prototype.namedQuery=function(t){throw new qr(jr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Qp),Xp=(f(Yp,Hp=o),Yp.prototype.Uf=function(t){return new Wr(new Fr(t))},Yp.prototype.Qf=function(t){t=this.Gf(t,this.firestore.I_);return sd.Ad(t,this.firestore,null)},Yp);function Yp(t){var e=this;return(e=Hp.call(this)||this).firestore=t,e}function Qp(t,e,n){var r=this;return(r=Gp.call(this,e)||this).Id=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Yr||(r.md=t),r}function $p(){}function Zp(t,e){var n=this;return(n=zp.call(this,t,e)||this).zf=t,n}function td(t,e){this.zf=t,this.Td=e,this.wd=zf(t)}var ed,nd,rd,id=(f(cd,rd=Hr),cd.prototype.get=function(t){var e=this,t=Ld(t);return this._.get(t).then(function(t){return new wd(e.zf,t)})},cd.prototype.set=function(t,e,n){t=Ld(t);return n?(cf("Transaction.set",n),this._.set(t,e,n)):this._.set(t,e),this},cd.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Ld(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},cd.prototype.delete=function(t){t=Ld(t);return this._.delete(t),this},cd),od=(f(ad,nd=Hr),ad.prototype.set=function(t,e,n){t=Ld(t);return n?(cf("WriteBatch.set",n),this._.set(t,e,n)):this._.set(t,e),this},ad.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Ld(t);return 2===arguments.length?this._.update(o,e):(t=this._).update.apply(t,l([o,e,n],r)),this},ad.prototype.delete=function(t){t=Ld(t);return this._.delete(t),this},ad.prototype.commit=function(){return this._.commit()},ad),sd=(f(ud,ed=Hr),ud.Rd=function(t,e,n){if(t.length%2!=0)throw new qr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new ud(e,new bf(e._,n,new wi(t)))},ud.Ad=function(t,e,n){return new ud(e,new bf(e._,n,t))},Object.defineProperty(ud.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(ud.prototype,"parent",{get:function(){return new Id(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(ud.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),ud.prototype.collection=function(t){try{return new Id(this.firestore,Of(this._,t))}catch(t){throw hd(t,"collection()","DocumentReference.collection()")}},ud.prototype.isEqual=function(t){return t instanceof Hr&&(t=t._),t instanceof bf&&Cf(this._,t)},ud.prototype.set=function(t,e){e=cf("DocumentReference.set",e);try{return function(t,e,n){t=df(t,bf);var r=df(t.firestore,Ul),e=gp(t.v_,e,n);return Up(r,[Bf(zf(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,Ls.Wt())])}(this._,t,e)}catch(t){throw hd(t,"setDoc()","DocumentReference.set()")}},ud.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Vp(this._,t):Vp.apply(void 0,l([this._,t,e],n))}catch(t){throw hd(t,"updateDoc()","DocumentReference.update()")}},ud.prototype.delete=function(){return Up(df((t=this._).firestore,Ul),[new Qs(t.S_,Ls.Wt())]);var t},ud.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=fd(t),i=ld(t,function(t){return new wd(e.firestore,new Tp(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))});return xp(this._,r,i)},ud.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=df(e,bf);var n=df(e.firestore,Ul),t=ql(n),r=new kp(n);return function(n,r){var t=this,i=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)}))];case 1:return(i=t.sent())instanceof io?u.resolve(i):i instanceof oo?u.resolve(null):u.reject(new qr(jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=da(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Dl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new Tp(n,r,e.S_,t,new Ep(t instanceof io&&t.bt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=df(e,bf);var n=df(e.firestore,Ul);return kl(ql(n),e.S_,{source:"server"}).then(function(t){return Mp(n,e,t)})}:function(e){e=df(e,bf);var n=df(e.firestore,Ul);return kl(ql(n),e.S_).then(function(t){return Mp(n,e,t)})})(this._).then(function(t){return new wd(e.firestore,new Tp(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},ud.prototype.withConverter=function(t){return new ud(this.firestore,this._.withConverter(t))},ud);function ud(t,e){var n=this;return(n=ed.call(this,e)||this).firestore=t,n.Hf=new Xp(t),n}function ad(){return null!==nd&&nd.apply(this,arguments)||this}function cd(t,e){var n=this;return(n=rd.call(this,e)||this).zf=t,n}function hd(t,e,n){return t.message=t.message.replace(e,n),t}function fd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!vp(r))return r}return{}}function ld(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=vp(t[0])?t[0]:vp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var pd,dd,yd,vd,gd,md,wd=(f(Cd,md=Hr),Object.defineProperty(Cd.prototype,"ref",{get:function(){return new sd(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Cd.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),Cd.prototype.data=function(t){return this._.data(t)},Cd.prototype.get=function(t,e){return this._.get(t,e)},Cd.prototype.isEqual=function(t){return Lp(this._,t._)},Cd),bd=(f(Dd,gd=wd),Dd.prototype.data=function(t){return this._.data(t)},Dd),_d=(f(Od,vd=Hr),Od.prototype.where=function(t,e,n){try{return new Od(this.firestore,Yl(this._,(r=n,i=e,o=Wl("where",t),new np(o,i,r))))}catch(t){throw hd(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Od.prototype.orderBy=function(n,t){try{return new Od(this.firestore,Yl(this._,function(t){void 0===t&&(t="asc");var e=t,t=Wl("orderBy",n);return new rp(t,e)}(t)))}catch(n){throw hd(n,/(orderBy|where)\(\)/,"Query.$1()")}},Od.prototype.limit=function(t){try{return new Od(this.firestore,Yl(this._,(yf("limit",e=t),new ip("limit",e,"F"))))}catch(t){throw hd(t,"limit()","Query.limit()")}var e},Od.prototype.limitToLast=function(t){try{return new Od(this.firestore,Yl(this._,(yf("limitToLast",e=t),new ip("limitToLast",e,"L"))))}catch(t){throw hd(t,"limitToLast()","Query.limitToLast()")}var e},Od.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Od(this.firestore,Yl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new op("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw hd(t,"startAt()","Query.startAt()")}},Od.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Od(this.firestore,Yl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new op("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw hd(t,"startAfter()","Query.startAfter()")}},Od.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Od(this.firestore,Yl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sp("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw hd(t,"endBefore()","Query.endBefore()")}},Od.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Od(this.firestore,Yl(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sp("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw hd(t,"endAt()","Query.endAt()")}},Od.prototype.isEqual=function(t){return Lf(this._,t._)},Od.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=df(e,_f);var n=df(e.firestore,Ul),t=ql(n),r=new kp(n);return function(n,r){var t=this,i=new aa;return n.fs.ys(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Wa(i,o,!0)];case 1:return r=t.sent(),e=new Dh(o,r.Pc),n=e.dl(r.documents),n=e.Ti(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=da(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Dl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new Ap(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=df(e,_f);var n=df(e.firestore,Ul),t=ql(n),r=new kp(n);return Pl(t,e.C_,{source:"server"}).then(function(t){return new Ap(n,r,e,t)})}:function(e){e=df(e,_f);var n=df(e.firestore,Ul),t=ql(n),r=new kp(n);return Xl(e.C_),Pl(t,e.C_).then(function(t){return new Ap(n,r,e,t)})})(this._).then(function(t){return new Td(e.firestore,new Ap(e.firestore._,e.Hf,e._,t.ud))})},Od.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=fd(t),i=ld(t,function(t){return new Td(e.firestore,new Ap(e.firestore._,e.Hf,e._,t.ud))});return xp(this._,r,i)},Od.prototype.withConverter=function(t){return new Od(this.firestore,this._.withConverter(t))},Od),Ed=(f(Sd,yd=Hr),Object.defineProperty(Sd.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"doc",{get:function(){return new bd(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),Sd),Td=(f(Nd,dd=Hr),Object.defineProperty(Nd.prototype,"query",{get:function(){return new _d(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Nd.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Nd.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(Nd.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Nd.prototype,"docs",{get:function(){var e=this;return this._.docs.map(function(t){return new bd(e.zf,t)})},enumerable:!1,configurable:!0}),Nd.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new Ed(e.zf,t)})},Nd.prototype.forEach=function(e,n){var r=this;this._.forEach(function(t){e.call(n,new bd(r.zf,t))})},Nd.prototype.isEqual=function(t){return Lp(this._,t._)},Nd),Id=(f(Ad,pd=_d),Object.defineProperty(Ad.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(Ad.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ad.prototype,"parent",{get:function(){var t=this._.parent;return t?new sd(this.firestore,t):null},enumerable:!1,configurable:!0}),Ad.prototype.doc=function(t){try{return new sd(this.firestore,void 0===t?Df(this._):Df(this._,t))}catch(t){throw hd(t,"doc()","CollectionReference.doc()")}},Ad.prototype.add=function(t){var e,n,r,i=this;return e=this._,n=t,t=df(e.firestore,Ul),r=Df(e),n=gp(e.v_,n),Up(t,[Bf(zf(e.firestore),"addDoc",r.S_,n,null!==e.v_,{}).F_(r.S_,Ls.exists(!1))]).then(function(){return r}).then(function(t){return new sd(i.firestore,t)})},Ad.prototype.isEqual=function(t){return Cf(this._,t._)},Ad.prototype.withConverter=function(t){return new Ad(this.firestore,this._.withConverter(t))},Ad);function Ad(t,e){var n=this;return(n=pd.call(this,t,e)||this).firestore=t,n._=e,n}function Nd(t,e){var n=this;return(n=dd.call(this,e)||this).zf=t,n}function Sd(t,e){var n=this;return(n=yd.call(this,e)||this).zf=t,n}function Od(t,e){var n=this;return(n=vd.call(this,e)||this).firestore=t,n.Hf=new Xp(t),n}function Dd(){return null!==gd&&gd.apply(this,arguments)||this}function Cd(t,e){var n=this;return(n=md.call(this,e)||this).zf=t,n}function Ld(t){return t instanceof Hr&&(t=t._),df(t,bf)}var Rd,kd,Te=(f(Ud,kd=Hr),Ud.documentId=function(){return new Ud(mi.lt().ot())},Ud.prototype.isEqual=function(t){return t instanceof Hr&&(t=t._),t instanceof nf&&this._.d_.isEqual(t.d_)},Ud),o=(f(xd,Rd=Hr),xd.serverTimestamp=function(){var t=new tl("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new xd(t)},xd.delete=function(){var t=new Jf("deleteField");return t._methodName="FieldValue.delete",new xd(t)},xd.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new el("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new xd(n)},xd.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new nl("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new xd(n)},xd.increment=function(t){t=new rl("increment",t);return t._methodName="FieldValue.increment",new xd(t)},xd.prototype.isEqual=function(t){return this._.isEqual(t._)},xd),Pd=(Vd.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},Vd.prototype.catch=function(t){return this.yd.promise.catch(t)},Vd.prototype.then=function(t,e){return this.yd.promise.then(t,e)},Vd.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},Vd.prototype.Wl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},Vd.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)},Vd);function Vd(){this.Pd={},this.yd=new aa,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function xd(){return null!==Rd&&Rd.apply(this,arguments)||this}function Ud(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return kd.call(this,new(nf.bind.apply(nf,l([void 0],t))))||this}function Md(t,s){var e=new Pd;return function(n,t,r){var e,i=this,o=(e=s,t=kc(t),e=function(t){if(t instanceof Uint8Array)return Zh(t,void 0);if(t instanceof ArrayBuffer)return Zh(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new ef(e,t));n.fs.ys(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Wh,[4,Ll(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(ql(t._),t.I_,e),e}var jd=(qd.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},qd.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},qd.prototype.setServiceProps=function(t){return this.serviceProps=t,this},qd);function qd(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Fd,Hd,Gd={Firestore:Wp,GeoPoint:Rf,Timestamp:di,Blob:Wr,Transaction:id,WriteBatch:od,DocumentReference:sd,DocumentSnapshot:wd,Query:_d,QueryDocumentSnapshot:bd,QuerySnapshot:Td,CollectionReference:Id,FieldPath:Te,FieldValue:o,setLogLevel:function(t){Ir.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Fd=e.default).INTERNAL.registerComponent(new jd("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Wp(e,new Ul(e,t),new Jp)},"PUBLIC").setServiceProps(Object.assign({},Gd))),Fd.registerVersion("@firebase/firestore","2.1.1"),(Hd=Wp).prototype.loadBundle=function(t){return Md(this,t)},Hd.prototype.namedQuery=function(t){return t=t,function(n,r){var t=this;return n.fs.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.To.Bs(t,e)})},[4,Dl(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(ql((e=this)._),t).then(function(t){return t?new _d(e,new _f(e._,null,t.query)):null});var e}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map

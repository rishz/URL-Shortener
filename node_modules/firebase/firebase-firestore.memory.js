!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Rd){"use strict";try{!function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=t(Rd),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function y(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function g(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}var a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,o=(3&o)<<4|a>>4,a=(15&a)<<2|c>>6,c=63&c;u||(c=64,s||(a=64)),r.push(n[h],n[o],n[a],n[c])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128):e[n++]=i>>12|224,e[n++]=i>>6&63|128),e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i,o,s,a=t[n++];a<128?e[r++]=String.fromCharCode(a):191<a&&a<224?(o=t[n++],e[r++]=String.fromCharCode((31&a)<<6|63&o)):239<a&&a<365?(i=((7&a)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536,e[r++]=String.fromCharCode(55296+(i>>10)),e[r++]=String.fromCharCode(56320+(1023&i))):(o=t[n++],s=t[n++],e[r++]=String.fromCharCode((15&a)<<12|(63&o)<<6|63&s))}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();o=o<<2|s>>4;r.push(o),64!==a&&(s=s<<4&240|a>>2,r.push(s),64!==u&&(u=a<<6&192|u,r.push(u)))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function h(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var i,u="FirebaseError",c=(n(l,i=Error),l);function l(t,e,n){e=i.call(this,e)||this;return e.code=t,e.customData=n,e.name=u,Object.setPrototypeOf(e,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,f.prototype.create),e}var f=(p.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(v,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new c(o,t,i)},p);function p(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var d,v=/\{\$([^}]+)}/g;function m(t){return t&&t._delegate?t._delegate:t}(Ie=d=d||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function b(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=E[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var w={debug:d.DEBUG,verbose:d.VERBOSE,info:d.INFO,warn:d.WARN,error:d.ERROR,silent:d.SILENT},_=d.INFO,E=((Se={})[d.DEBUG]="log",Se[d.VERBOSE]="log",Se[d.INFO]="info",Se[d.WARN]="warn",Se[d.ERROR]="error",Se),T=(Object.defineProperty(I.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in d))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),I.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?w[t]:t},Object.defineProperty(I.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),I.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,d.DEBUG],t)),this._logHandler.apply(this,s([this,d.DEBUG],t))},I.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,d.VERBOSE],t)),this._logHandler.apply(this,s([this,d.VERBOSE],t))},I.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,d.INFO],t)),this._logHandler.apply(this,s([this,d.INFO],t))},I.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,d.WARN],t)),this._logHandler.apply(this,s([this,d.WARN],t))},I.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,d.ERROR],t)),this._logHandler.apply(this,s([this,d.ERROR],t))},I);function I(t){this.name=t,this._logLevel=_,this._logHandler=b,this._userLogHandler=null}var S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},C={},R=D||self;function k(){}function O(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),M=0;function x(t,e,n){return t.call.apply(t.bind,arguments)}function F(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?x:F).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function q(){return Date.now()}function B(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++M))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},K=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function H(){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var z,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var $=R.navigator;if($){$=$.userAgent;if($){z=$;break t}}z=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e,n={};for(e in t)n[e]=t[e];return n}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<et.length;i++)e=et[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function rt(t){return rt[" "](t),t}rt[" "]=k;var it,ot=X(z,"Opera"),st=X(z,"Trident")||X(z,"MSIE"),at=X(z,"Edge"),ut=at||st,ct=X(z,"Gecko")&&!(X(z.toLowerCase(),"webkit")&&!X(z,"Edge"))&&!(X(z,"Trident")||X(z,"MSIE"))&&!X(z,"Edge"),ht=X(z.toLowerCase(),"webkit")&&!X(z,"Edge");function lt(){var t=R.document;return t?t.documentMode:void 0}t:{var ft="",pt=(pt=z,ct?/rv:([^\);]+)(\)|;)/.exec(pt):at?/Edge\/([\d\.]+)/.exec(pt):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(pt):ht?/WebKit\/(\S+)/.exec(pt):ot?/(?:Version)[ \/]?(\S+)/.exec(pt):void 0);if(pt&&(ft=pt?pt[1]:""),st){pt=lt();if(null!=pt&&pt>parseFloat(ft)){it=String(pt);break t}}it=ft}var dt={};function yt(a){return t=a,e=function(){for(var t=0,e=Y(String(it)).split("."),n=Y(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=dt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var gt=R.document&&st&&(lt()||parseInt(it,10))||void 0,vt=!st||9<=Number(gt),mt=st&&!yt("9"),bt=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",k,e),R.removeEventListener("test",k,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function _t(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{rt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},B(_t,wt);var Et={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),It=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ct(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ct(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new St(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Rt="closure_lm_"+(1e6*Math.random()|0),kt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=qt(r);return e&&e[Tt]?e.wa(n,r,L(i)?!!i.capture:!!i,o):Lt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=qt(n),t&&t[Tt]?t.va(e,n,L(r)?!!r.capture:!!r,i):Lt(t,e,n,!1,r,i)}function Lt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!vt)return null;var a,u,c=Vt(t);if(c||(t[Rt]=c=new Nt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(a=Ft,r=u=vt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)void 0===(i=!bt?s:i)&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Tt]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Rt]=null)):At(t)))}function Mt(t){return t in kt?kt[t]:kt[t]="on"+t}function xt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Ft(t,e){if(t.Y)return!0;if(vt)return xt(t,new _t(e,this));if(!e)t:{e=["window","event"];for(var n=R,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return xt(t,e=new _t(e,this))}function Vt(t){return(t=t[Rt])instanceof Nt?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==typeof e?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function Bt(){j.call(this),this.c=new Nt(this),(this.J=this).C=null}function jt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,nt(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Gt(o,r,!0,e)&&s;if(s=Gt(o=e.a=t,r,!0,e)&&s,s=Gt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Gt(o=e.a=n[i],r,!1,e)&&s}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&Dt(t.c,u),i=!1!==s.call(a,r)&&i)}return i&&!r.defaultPrevented}B(Bt,j),Bt.prototype[Tt]=!0,(N=Bt.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=qt(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ct(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],(r=(e=-1)<(e=n?Ct(n,r,i,o):e)?n[e]:null)&&Pt(r))}(this,t,e,n,r)},N.G=function(){if(Bt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Kt=R.JSON.stringify;function Ht(){this.b=this.a=null}var Wt,Qt=(zt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new zt(function(){return new Yt},function(t){t.reset()}));function zt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Xt(t,e){var n;Wt||(n=R.Promise.resolve(void 0),Wt=function(){n.then(Zt)}),Jt||(Wt(),Jt=!0),$t.add(t,e)}Ht.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),$t=new Ht;function Zt(){for(var t,e;n=e=void 0,n=null,(e=$t).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){R.setTimeout(function(){throw t},0)}(t)}var n=Qt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Jt=!1}function te(t,e){Bt.call(this),this.b=t||1,this.a=e||R,this.f=V(this.Za,this),this.g=q()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}B(te,Bt),(N=te.prototype).aa=!1,N.M=null,N.Za=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),jt(this,"tick"),this.aa&&(ee(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},N.G=function(){te.X.G.call(this),ee(this),delete this.a};var re,ie,oe,se=(S(ie=ue,oe=re=j),ie.prototype=null===oe?Object.create(oe):(ae.prototype=oe.prototype,new ae),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){re.prototype.G.call(this),this.a&&(R.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function ae(){this.constructor=ie}function ue(t,e){var n=re.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ce(t){j.call(this),this.b=t,this.a={}}B(ce,j);var he=[];function le(t,e,n,r){Array.isArray(n)||(n&&(he[0]=n.toString()),n=he);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Kt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ce.prototype.G=function(){ce.X.G.call(this),fe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye={},ge=null;function ve(){return ge=ge||new Bt}function me(t){wt.call(this,ye.Fa,t)}function be(t){var e=ve();jt(e,new me(e))}function we(t,e){wt.call(this,ye.STAT_EVENT,t),this.stat=e}function _e(t){var e=ve();jt(e,new we(e,t))}function Ee(t){wt.call(this,ye.Ga,t)}function Te(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}ye.Fa="serverreachability",B(me,wt),ye.STAT_EVENT="statevent",B(we,wt),ye.Ga="timingevent",B(Ee,wt);var Ie={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Se={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ae(){}function Ne(t){var e;return e=!(e=t.a)?t.a={}:e}function De(){}Ae.prototype.a=null;D={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ce(){wt.call(this,"d")}function Re(){wt.call(this,"c")}function ke(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ce(this),this.P=Pe,t=ut?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}B(Ce,wt),B(Re,wt),B(ke,Ae);var Le=new ke,Pe=45e3,Me={},xe={};function Fe(t,e,n){t.H=1,t.i=on($e(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=q(),qe(t),t.l=$e(t.i);var s,a,u,c,h,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),mn(n.b,"t",r),t.D=0,t.a=lr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(V(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Xa),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(1),s=t.c,a=t.m,u=t.l,c=t.f,h=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+a+"\n"+u+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var a=(a=n,o=i=void 0,i=(r=t).D,-1==(o=a.indexOf("\n",i))?xe:(i=Number(a.substring(i,o)),isNaN(i)?Me:(o+=1)+i>a.length?xe:(a=a.substr(o,i),r.D=o+i,a)));if(a==xe){4==e&&(t.h=4,_e(14),s=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(a==Me){t.h=4,_e(15),de(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}de(t.c,t.f,a,null),He(t,a)}4==e&&0==n.length&&(t.h=1,_e(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.F=!0,_e(11))):(de(t.c,t.f,n,"[Invalid Chunked Response]"),Ke(t),Ge(t))}function qe(t){t.T=q()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Te(V(t.Va,t),e)}function je(t){t.o&&(R.clearTimeout(t.o),t.o=null)}function Ge(t){0==t.g.v||t.A||sr(t.g,t)}function Ke(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function He(t,e){try{var n,r,i,o,s,a=t.g;if(0!=a.v&&(a.a==t||Sn(a.b,t)))if(a.I=t.N,!t.C&&Sn(a.b,t)&&3==a.v){try{var u=a.ka.a.parse(e)}catch(t){u=null}if(Array.isArray(u)&&3==u.length){var c=u;if(0==c[0]){t:if(!a.j){if(a.a){if(!(a.a.u+3e3<t.u))break t;or(a),zn(a)}nr(a),_e(18)}}else a.oa=c[1],0<a.oa-a.P&&c[2]<37500&&a.H&&0==a.o&&!a.m&&(a.m=Te(V(a.Sa,a),6e3));if(In(a.b)<=1&&a.ea){try{a.ea()}catch(t){}a.ea=void 0}}else ur(a,11)}else if(!t.C&&a.a!=t||or(a),!Q(e))for(e=u=a.ka.a.parse(e),u=0;u<e.length;u++)c=e[u],a.P=c[0],c=c[1],2==a.v?"c"==c[0]?(a.J=c[1],a.ga=c[2],null!=(r=c[3])&&(a.ha=r,a.c.info("VER="+a.ha)),null!=(o=c[4])&&(a.pa=o,a.c.info("SVER="+a.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,a.D=n,a.c.info("backChannelRequestTimeoutMs_="+n)),n=a,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(An(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,rn(n.B,n.A,s))),a.v=3,a.f&&a.f.ta(),a.U&&(a.N=q()-t.u,a.c.info("Handshake RTT: "+a.N+"ms")),i=t,(n=a).la=hr(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),qe(o)),n.a=i):er(n),0<a.g.length&&Jn(a)):"stop"!=c[0]&&"close"!=c[0]||ur(a,7):3==a.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ur(a,7):Qn(a):"noop"!=c[0]&&a.f&&a.f.sa(c),a.o=0);be(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)K(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t)for(var n=[],r=t.length,i=0;i<r;i++)n.push(i);else for(i in n=[],r=0,t)n[r++]=i;for(var i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Oe.prototype).setTimeout=function(t){this.P=t},N.Xa=function(t){t=t.target;var e=this.F;e&&3==Gn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||be(8==n||r<=0?3:2),je(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,r=this.c,u=this.m,c=this.l,h=this.f,l=this.S,f=e,p=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+l+"]: "+u+"\n"+c+"\n"+f+" "+p}),this.b){if(this.U&&!this.C){e:{if(this.a){var s=this.a;if((s=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,_e(12),Ke(this),Ge(this);break t}de(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,He(this,a)}this.I?(Ue(this,e,o),ut&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Wa),this.R.start())):(de(this.c,this.f,o,null),He(this,o)),4==e&&Ke(this),this.b&&!this.A&&(4==e?sr(this.g,this):(this.b=!1,qe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,_e(12)):(this.h=0,_e(13)),Ke(this),Ge(this)}}}catch(t){}var u,c,h,l,f,p},N.Wa=function(){var t,e;this.a&&(t=Gn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Ue(this,t,e),this.b&&4!=t&&qe(this)))},N.cancel=function(){this.A=!0,Ke(this)},N.Va=function(){this.o=null;var t,e,n=q();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(be(3),_e(17)),Ke(this),this.h=2,Ge(this)):Be(this,this.T-n)},(N=Qe.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return ze(this),this.a.concat()},N.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},N.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Xe))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function $e(t){return new Je(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var r,i;e instanceof dn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(yn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),mn(this,n,t))},r)),r.f=i):(n||(e=an(e,fn)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),t=n?t.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,cn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(an(e,cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:hn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,pn)),t.join("")};var cn=/[#\/\?@]/g,hn=/[#\?:]/g,ln=/[#\?]/g,fn=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function gn(t,e){yn(t),e=bn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function vn(t,e){return yn(t),e=bn(t,e),Ye(t.a.b,e)}function mn(t,e,n){gn(t,e),0<n.length&&(t.c=null,t.a.set(bn(t,e),W(n)),t.b+=n.length)}function bn(t,e){return e=String(e),e=t.f?e.toLowerCase():e}(N=dn.prototype).add=function(t,e){yn(this),this.c=null,t=bn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){yn(this),this.a.forEach(function(t,e){K(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){yn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=H(e,this.a.get(bn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},N.set=function(t,e){return yn(this),this.c=null,vn(this,t=bn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=function(t,e){this.b=t,this.a=e};function _n(t){this.g=t||En,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ia&&R.ia.ya&&R.ia.ya()&&R.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var En=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function Sn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Dn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Cn(){}function Rn(){this.a=new Cn}function kn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}_n.prototype.cancel=function(){var e,t;if(this.c=Dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Cn.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},Cn.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var On=R.JSON.parse;function Ln(t){Bt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}B(Ln,Bt);var Pn="",Mn=/^https?$/i,xn=["POST","PUT"];function Fn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),Bn(t)}function Un(t){t.u||(t.u=!0,jt(t,"complete"),jt(t,"error"))}function qn(t){if(t.b&&void 0!==C&&(!t.s[1]||4!=Gn(t)||2!=t.W()))if(t.l&&4==Gn(t))ne(t.za,0,t);else if(jt(t,"readystatechange"),4==Gn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Xe)[1]||null)&&R.self&&R.self.location&&(i=(r=R.self.location.protocol).substr(0,r.length-1)),n=!Mn.test(i?i.toLowerCase():"")),e=n);if(e)jt(t,"complete"),jt(t,"success");else{t.h=6;try{var a=2<Gn(t)?t.a.statusText:""}catch(o){a=""}t.f=a+" ["+t.W()+"]",Un(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?k:null;t.a=null,t.s=null,e||jt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function Kn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Hn("baseRetryDelayMs",5e3,t),this.Ra=Hn("retryDelaySeedMs",1e4,t),this.Ma=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new _n(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Qn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,rn(n=$e(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=on($e(n)),n=!1,!(n=R.navigator&&R.navigator.sendBeacon?R.navigator.sendBeacon(e.i.toString(),""):n)&&R.Image&&((new Image).src=e.i,n=!0),n||(e.a=lr(e.g,null),e.a.ba(e.i)),e.u=q(),qe(e)),cr(t)}function zn(t){t.a&&(rr(t),t.a.cancel(),t.a=null)}function Yn(t){zn(t),t.j&&(R.clearTimeout(t.j),t.j=null),or(t),t.b.cancel(),t.h&&("number"==typeof t.h&&R.clearTimeout(t.h),t.h=null)}function Xn(t,e){t.g.push(new wn(t.Oa++,e)),3==t.v&&Jn(t)}function Jn(t){Tn(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function $n(t,e){var n=e?e.f:t.R++,r=$e(t.B);rn(r,"SID",t.J),rn(r,"RID",n),rn(r,"AID",t.P),Zn(t,r),t.i&&t.l&&Kn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Fe(n,r,e)}function Zn(t,n){t.f&&We({},function(t,e){rn(n,e,t)})}function tr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if((c-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{!function(t,r,e){var i=e||"";try{We(t,function(t,e){var n=t;L(t)&&(n=Kt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function er(t){t.a||t.j||(t.T=1,Xt(t.Aa,t),t.o=0)}function nr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Te(V(t.Aa,t),ar(t,t.o)),t.o++,1)}function rr(t){null!=t.s&&(R.clearTimeout(t.s),t.s=null)}function ir(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=$e(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Zn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&Kn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on($e(e)),n.j=null,n.I=!0,Ve(n,t)}function or(t){null!=t.m&&(R.clearTimeout(t.m),t.m=null)}function sr(t,e){var n,r,i,o=null;if(t.a==e){or(t),rr(t),t.a=null;var s=2}else{if(!Sn(t.b,e))return;o=e.s,Nn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=q()-e.u,n=t.u,jt(s=ve(),new Ee(s)),Jn(t)):er(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,In((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=Te(V(r.Ba,r,i),ar(r,r.u)),r.u++,0))))&&(2!=s||!nr(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:ur(t,5);break;case 4:ur(t,10);break;case 3:ur(t,6);break;default:ur(t,2)}}function ar(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function ur(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new Je("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||Ze(r,"https"),on(r)),n=r.toString(),r=o,o=new pe,R.Image?((i=new Image).onload=U(kn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(kn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(kn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(kn,o,i,"TestLoadImage: timeout",!1,r),R.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):_e(2),t.v=0,t.f&&t.f.ra(e),cr(t),Yn(t)}function cr(t){t.v=0,t.I=-1,t.f&&(0==Dn(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function hr(t,e,n){var r,i,o,s,a,u=(s=n)instanceof Je?$e(s):new Je(s,void 0);return""!=u.c?(e&&tn(u,e+"."+u.c),en(u,u.h)):(a=R.location,r=a.protocol,i=e?e+"."+a.hostname:a.hostname,o=+a.port,s=n,a=new Je(null,void 0),r&&Ze(a,r),i&&tn(a,i),o&&en(a,o),s&&(a.g=s),u=a),t.V&&Z(t.V,function(t,e){rn(u,e,t)}),e=t.A,n=t.na,e&&n&&rn(u,e,n),rn(u,"VER",t.ha),Zn(t,u),u}function lr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Na)).F=t.C,e}function fr(){}function pr(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function dr(t,e){Bt.call(this),this.a=new Wn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new vr(this)}function yr(t){Ce.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function gr(){Re.call(this),this.status=1}function vr(t){this.a=t}(N=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Le),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Fn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=R.FormData&&t instanceof R.FormData,0<=G(xn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,st&&yt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},N.xa=function(){void 0!==C&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,jt(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,jt(this,"complete"),jt(this,"abort"),Bn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Ln.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?qn(this):this.Ua())},N.Ua=function(){qn(this)},N.W=function(){try{return 2<Gn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Wn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?nt(r=tt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=tr(this,n,e),rn(i=$e(this.B),"RID",t),rn(i,"CVER",22),this.A&&rn(i,"X-HTTP-Session-Id",this.A),Zn(this,i),this.i&&r&&Kn(i,this.i,r),An(this.b,n),this.Ia&&rn(i,"TYPE","init"),this.da?(rn(i,"$req",e),rn(i,"SID","null"),n.U=!0,Fe(n,i,null)):Fe(n,i,e),this.v=2}}else 3==this.v&&(t?$n(this,t):0==this.g.length||Tn(this.b)||$n(this))},N.Aa=function(){var t;this.j=null,ir(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Te(V(this.Ta,this),t))},N.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,_e(10),zn(this),ir(this))},N.Sa=function(){null!=this.m&&(this.m=null,zn(this),nr(this),_e(19))},N.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),_e(2)):(this.c.info("Failed to ping google.com"),_e(1))},(N=fr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ja=function(){},pr.prototype.a=function(t,e){return new dr(t,e)},B(dr,Bt),dr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;_e(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=hr(t,null,t.fa),Jn(t)},dr.prototype.close=function(){Qn(this.a)},dr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Xn(this.a,e)):this.l?((e={}).__data__=Kt(t),Xn(this.a,e)):Xn(this.a,t)},dr.prototype.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,dr.X.G.call(this)},B(yr,Ce),B(gr,Re),B(vr,fr),vr.prototype.ta=function(){jt(this.a,"a")},vr.prototype.sa=function(t){jt(this.a,new yr(t))},vr.prototype.ra=function(t){jt(this.a,new gr)},vr.prototype.qa=function(){jt(this.a,"b")},pr.prototype.createWebChannel=pr.prototype.a,dr.prototype.send=dr.prototype.h,dr.prototype.open=dr.prototype.g,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Se.COMPLETE="complete",(De.EventType=D).OPEN="a",D.CLOSE="b",D.ERROR="c",D.MESSAGE="d",Bt.prototype.listen=Bt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.W,Ln.prototype.getResponseJson=Ln.prototype.Pa,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var mr=ve,br=Ie,wr=Se,_r=ye,Er=10,Tr=11,Ir=De,Sr=Ln,Ar=(Nr.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Nr.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},Nr);function Nr(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}Ar.o=-1;var Dr,Cr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Rr=(n(Or,Dr=Error),Or),kr=new T("@firebase/firestore");function Or(t,e){var n=this;return(n=Dr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Lr(){return kr.logLevel}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=d.DEBUG&&(e=n.map(Fr),kr.debug.apply(kr,s(["Firestore (8.5.0): "+t],e)))}function Mr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=d.ERROR&&(e=n.map(Fr),kr.error.apply(kr,s(["Firestore (8.5.0): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=d.WARN&&(e=n.map(Fr),kr.warn.apply(kr,s(["Firestore (8.5.0): "+t],e)))}function Fr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Vr(t){t="FIRESTORE (8.5.0) INTERNAL ASSERTION FAILED: "+(t=void 0===t?"Unexpected state":t);throw Mr(t),new Error(t)}function Ur(t){t||Vr()}var qr=(Br.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Br);function Br(){}function jr(t,e){return t<e?-1:e<t?1:0}function Gr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Kr=(Qr.now=function(){return Qr.fromMillis(Date.now())},Qr.fromDate=function(t){return Qr.fromMillis(t.getTime())},Qr.fromMillis=function(t){var e=Math.floor(t/1e3);return new Qr(e,Math.floor(1e6*(t-1e3*e)))},Qr.prototype.toDate=function(){return new Date(this.toMillis())},Qr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Qr.prototype._compareTo=function(t){return this.seconds===t.seconds?jr(this.nanoseconds,t.nanoseconds):jr(this.seconds,t.seconds)},Qr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Qr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Qr.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Qr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Qr),Hr=(Wr.fromTimestamp=function(t){return new Wr(t)},Wr.min=function(){return new Wr(new Kr(0,0))},Wr.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},Wr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Wr.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Wr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Wr.prototype.toTimestamp=function(){return this.timestamp},Wr);function Wr(t){this.timestamp=t}function Qr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Rr(Cr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Rr(Cr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Rr(Cr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Rr(Cr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function zr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Yr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Xr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Jr,$r,Se=(Object.defineProperty(ui.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),ui.prototype.isEqual=function(t){return 0===ui.comparator(this,t)},ui.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ui?t.forEach(function(t){e.push(t)}):e.push(t),this.construct(e)},ui.prototype.limit=function(){return this.offset+this.length},ui.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},ui.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},ui.prototype.firstSegment=function(){return this.segments[this.offset]},ui.prototype.lastSegment=function(){return this.get(this.length-1)},ui.prototype.get=function(t){return this.segments[this.offset+t]},ui.prototype.isEmpty=function(){return 0===this.length},ui.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ui.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},ui.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ui),Zr=(n(ai,$r=Se),ai.prototype.construct=function(t,e,n){return new ai(t,e,n)},ai.prototype.canonicalString=function(){return this.toArray().join("/")},ai.prototype.toString=function(){return this.canonicalString()},ai.fromString=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ai(n)},ai.emptyPath=function(){return new ai([])},ai),ti=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ei=(n(si,Jr=Se),si.prototype.construct=function(t,e,n){return new si(t,e,n)},si.isValidIdentifier=function(t){return ti.test(t)},si.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t=!si.isValidIdentifier(t)?"`"+t+"`":t}).join(".")},si.prototype.toString=function(){return this.canonicalString()},si.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},si.keyField=function(){return new si(["__name__"])},si.fromServerFormat=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Rr(Cr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Rr(Cr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Rr(Cr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new si(e)},si.emptyPath=function(){return new si([])},si),ni=(oi.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},oi.prototype.isEqual=function(t){return Gr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},oi),ri=(ii.fromBase64String=function(t){return new ii(atob(t))},ii.fromUint8Array=function(t){return new ii(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ii.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},ii.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},ii.prototype.approximateByteSize=function(){return 2*this.binaryString.length},ii.prototype.compareTo=function(t){return jr(this.binaryString,t.binaryString)},ii.prototype.isEqual=function(t){return this.binaryString===t.binaryString},ii);function ii(t){this.binaryString=t}function oi(t){(this.fields=t).sort(ei.comparator)}function si(){return null!==Jr&&Jr.apply(this,arguments)||this}function ai(){return null!==$r&&$r.apply(this,arguments)||this}function ui(t,e,n){void 0===e?e=0:e>t.length&&Vr(),void 0===n?n=t.length-e:n>t.length-e&&Vr(),this.segments=t,this.offset=e,this.len=n}ri.EMPTY_BYTE_STRING=new ri("");var ci=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hi(t){if(Ur(!!t),"string"!=typeof t)return{seconds:li(t.seconds),nanos:li(t.nanos)};var e=0,n=ci.exec(t);Ur(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function li(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function fi(t){return"string"==typeof t?ri.fromBase64String(t):ri.fromUint8Array(t)}function pi(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function di(t){t=hi(t.mapValue.fields.__local_write_time__.timestampValue);return new Kr(t.seconds,t.nanos)}function yi(t){return null==t}function gi(t){return 0===t&&1/t==-1/0}var vi=(mi.fromPath=function(t){return new mi(Zr.fromString(t))},mi.fromName=function(t){return new mi(Zr.fromString(t).popFirst(5))},mi.prototype.hasCollectionId=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},mi.prototype.isEqual=function(t){return null!==t&&0===Zr.comparator(this.path,t.path)},mi.prototype.toString=function(){return this.path.toString()},mi.comparator=function(t,e){return Zr.comparator(t.path,e.path)},mi.isDocumentKey=function(t){return t.length%2==0},mi.fromSegments=function(t){return new mi(new Zr(t.slice()))},mi);function mi(t){this.path=t}function bi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?pi(t)?4:10:Vr()}function wi(r,i){var t,e,n=bi(r);if(n!==bi(i))return!1;switch(n){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return di(r).isEqual(di(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=hi(r.timestampValue),t=hi(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return e=i,fi(r.bytesValue).isEqual(fi(e.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return t=i,li((e=r).geoPointValue.latitude)===li(t.geoPointValue.latitude)&&li(e.geoPointValue.longitude)===li(t.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return li(t.integerValue)===li(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=li(t.doubleValue),e=li(e.doubleValue);return t===e?gi(t)===gi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Gr(r.arrayValue.values||[],i.arrayValue.values||[],wi);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(zr(e)!==zr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!wi(e[t],n[t])))return!1;return!0}();default:return Vr()}}function _i(t,e){return void 0!==(t.values||[]).find(function(t){return wi(t,e)})}function Ei(t,e){var n,r,i,o=bi(t),s=bi(e);if(o!==s)return jr(o,s);switch(o){case 0:return 0;case 1:return jr(t.booleanValue,e.booleanValue);case 2:return r=e,i=li(t.integerValue||t.doubleValue),r=li(r.integerValue||r.doubleValue),i<r?-1:r<i?1:i===r?0:isNaN(i)?isNaN(r)?0:-1:1;case 3:return Ti(t.timestampValue,e.timestampValue);case 4:return Ti(di(t),di(e));case 5:return jr(t.stringValue,e.stringValue);case 6:return function(t,e){t=fi(t),e=fi(e);return t.compareTo(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=jr(n[i],r[i]);if(0!==o)return o}return jr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=jr(li(n.latitude),li(i.latitude)))?r:jr(li(n.longitude),li(i.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ei(n[i],r[i]);if(o)return o}return jr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=jr(r[s],o[s]);if(0!==a)return a;a=Ei(n[r[s]],i[o[s]]);if(0!==a)return a}return jr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Vr()}}function Ti(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return jr(t,e);var n=hi(t),t=hi(e),e=jr(n.seconds,t.seconds);return 0!==e?e:jr(n.nanos,t.nanos)}function Ii(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=hi(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?fi(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,vi.fromName(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Vr();var e}(t)}function Si(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Ai(t){return t&&"integerValue"in t}function Ni(t){return!!t&&"arrayValue"in t}function Di(t){return t&&"nullValue"in t}function Ci(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ri(t){return t&&"mapValue"in t}var ki=(Oi.empty=function(){return new Oi({mapValue:{}})},Oi.prototype.field=function(t){return Oi.extractNestedValue(this.buildProto(),t)},Oi.prototype.toProto=function(){return this.field(ei.emptyPath())},Oi.prototype.set=function(t,e){this.setOverlay(t,e)},Oi.prototype.setAll=function(t){var n=this;t.forEach(function(t,e){t?n.set(e,t):n.delete(e)})},Oi.prototype.delete=function(t){this.setOverlay(t,null)},Oi.prototype.isEqual=function(t){return wi(this.buildProto(),t.buildProto())},Oi.prototype.setOverlay=function(t,e){for(var n=this.overlayMap,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===bi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.lastSegment(),e)},Oi.prototype.applyOverlay=function(r,t){var i=this,o=!1,e=Oi.extractNestedValue(this.partialValue,r),s=Ri(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.applyOverlay(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Oi.prototype.buildProto=function(){var t=this.applyOverlay(ei.emptyPath(),this.overlayMap);return null!=t&&(this.partialValue=t,this.overlayMap.clear()),this.partialValue},Oi.extractNestedValue=function(t,e){if(e.isEmpty())return t;for(var n=t,r=0;r<e.length-1;++r){if(!n.mapValue.fields)return null;if(!Ri(n=n.mapValue.fields[e.get(r)]))return null}return(n=(n.mapValue.fields||{})[e.lastSegment()])||null},Oi.prototype.clone=function(){return new Oi(this.buildProto())},Oi);function Oi(t){this.overlayMap=new Map,this.partialValue=t}var Li=(Mi.newInvalidDocument=function(t){return new Mi(t,0,Hr.min(),ki.empty(),0)},Mi.newFoundDocument=function(t,e,n){return new Mi(t,1,e,n,0)},Mi.newNoDocument=function(t,e){return new Mi(t,2,e,ki.empty(),0)},Mi.newUnknownDocument=function(t,e){return new Mi(t,3,e,ki.empty(),2)},Mi.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},Mi.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=ki.empty(),this.documentState=0,this},Mi.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=ki.empty(),this.documentState=2,this},Mi.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},Mi.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(Mi.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Mi.prototype.isValidDocument=function(){return 0!==this.documentType},Mi.prototype.isFoundDocument=function(){return 1===this.documentType},Mi.prototype.isNoDocument=function(){return 2===this.documentType},Mi.prototype.isUnknownDocument=function(){return 3===this.documentType},Mi.prototype.isEqual=function(t){return t instanceof Mi&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)},Mi.prototype.clone=function(){return new Mi(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},Mi.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.toProto())+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},Mi),Pi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function Mi(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}function xi(t,e,n,r,i,o,s){return new Pi(t,e=void 0===e?null:e,n=void 0===n?[]:n,r=void 0===r?[]:r,i=void 0===i?null:i,o=void 0===o?null:o,s=void 0===s?null:s)}function Fi(t){var e=t;return null===e.h&&(t=e.path.canonicalString(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.canonicalString()+t.op.toString()+Ii(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.canonicalString()+t.dir}).join(","),yi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=fo(e.startAt)),e.endAt&&(t+="|ub:",t+=fo(e.endAt)),e.h=t),e.h}function Vi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],o.op!==s.op||!o.field.isEqual(s.field)||!wi(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!go(t.startAt,e.startAt)&&go(t.endAt,e.endAt)}function Ui(t){return vi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var qi,Bi=(n(ji,qi=function(){}),ji.create=function(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.l(t,e,n):new Wi(t,e,n):"array-contains"===e?new ro(t,n):"in"===e?new io(t,n):"not-in"===e?new oo(t,n):"array-contains-any"===e?new so(t,n):new ji(t,e,n)},ji.l=function(t,e,n){return new("in"===e?Qi:zi)(t,n)},ji.prototype.matches=function(t){t=t.data.field(this.field);return"!="===this.op?null!==t&&this.m(Ei(t,this.value)):null!==t&&bi(this.value)===bi(t)&&this.m(Ei(t,this.value))},ji.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Vr()}},ji.prototype.g=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ji);function ji(t,e,n){var r=this;return(r=qi.call(this)||this).field=t,r.op=e,r.value=n,r}var Gi,Ki,Hi,Wi=(n(Ji,Hi=Bi),Ji.prototype.matches=function(t){t=vi.comparator(t.key,this.key);return this.m(t)},Ji),Qi=(n(Xi,Ki=Bi),Xi.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Xi),zi=(n(Yi,Gi=Bi),Yi.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Yi);function Yi(t,e){var n=this;return(n=Gi.call(this,t,"not-in",e)||this).keys=$i(0,e),n}function Xi(t,e){var n=this;return(n=Ki.call(this,t,"in",e)||this).keys=$i(0,e),n}function Ji(t,e,n){var r=this;return(r=Hi.call(this,t,e,n)||this).key=vi.fromName(n.referenceValue),r}function $i(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return vi.fromName(t.referenceValue)})}var Zi,to,eo,no,ro=(n(lo,no=Bi),lo.prototype.matches=function(t){t=t.data.field(this.field);return Ni(t)&&_i(t.arrayValue,this.value)},lo),io=(n(ho,eo=Bi),ho.prototype.matches=function(t){t=t.data.field(this.field);return null!==t&&_i(this.value.arrayValue,t)},ho),oo=(n(co,to=Bi),co.prototype.matches=function(t){if(_i(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.data.field(this.field);return null!==t&&!_i(this.value.arrayValue,t)},co),so=(n(uo,Zi=Bi),uo.prototype.matches=function(t){var e=this,t=t.data.field(this.field);return!(!Ni(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return _i(e.value.arrayValue,t)})},uo),ao=function(t,e){this.position=t,this.before=e};function uo(t,e){return Zi.call(this,t,"array-contains-any",e)||this}function co(t,e){return to.call(this,t,"not-in",e)||this}function ho(t,e){return eo.call(this,t,"in",e)||this}function lo(t,e){return no.call(this,t,"array-contains",e)||this}function fo(t){return(t.before?"b":"a")+":"+t.position.map(Ii).join(",")}var po=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function yo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.isKeyField()?vi.comparator(vi.fromName(s.referenceValue),n.key):Ei(s,n.data.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function go(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!wi(t.position[n],e.position[n]))return!1;return!0}var vo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function mo(t){return new vo(t)}function bo(t){return!yi(t.limit)&&"F"===t.limitType}function wo(t){return!yi(t.limit)&&"L"===t.limitType}function _o(t){return 0<t.explicitOrderBy.length?t.explicitOrderBy[0].field:null}function Eo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function To(t){return null!==t.collectionGroup}function Io(t){var e=t;if(null===e.p){e.p=[];var n=Eo(e),t=_o(e);if(null!==n&&null===t)n.isKeyField()||e.p.push(new po(n)),e.p.push(new po(ei.keyField(),"asc"));else{for(var r=!1,i=0,o=e.explicitOrderBy;i<o.length;i++){var s=o[i];e.p.push(s),s.field.isKeyField()&&(r=!0)}r||(n=0<e.explicitOrderBy.length?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",e.p.push(new po(ei.keyField(),n)))}}return e.p}function So(t){var e=t;if(!e.T)if("F"===e.limitType)e.T=xi(e.path,e.collectionGroup,Io(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Io(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new po(o.field,s))}var a=e.endAt?new ao(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ao(e.startAt.position,!e.startAt.before):null;e.T=xi(e.path,e.collectionGroup,n,e.filters,e.limit,a,t)}return e.T}function Ao(t,e,n){return new vo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function No(t,e){return Vi(So(t),So(e))&&t.limitType===e.limitType}function Do(t){return Fi(So(t))+"|lt:"+t.limitType}function Co(t){return"Query(target="+(e=So(t),n=e.path.canonicalString(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.canonicalString()+" "+t.op+" "+Ii(t.value)}).join(", ")+"]"),yi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.canonicalString()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+fo(e.startAt)),e.endAt&&(n+=", endAt: "+fo(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Ro(i,t){return t.isFoundDocument()&&(e=i,n=t.key.path,null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):vi.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n))&&function(t){for(var e=0,n=i.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&null===t.data.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||yo(t.startAt,Io(t),n))&&(!t.endAt||!yo(t.endAt,Io(t),n)));var e,n}function ko(a){return function(t,e){for(var n=!1,r=0,i=Io(a);r<i.length;r++){var o=i[r],s=function(t,r,e){var n=t.field.isKeyField()?vi.comparator(r.key,e.key):function(t,e){var n=r.data.field(t),t=e.data.field(t);return null!==n&&null!==t?Ei(n,t):Vr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Vr()}}(o,t,e);if(0!==s)return s;n=n||o.field.isKeyField()}return 0}}function Oo(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function Lo(t){return{integerValue:""+t}}function Po(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!gi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Lo(e):Oo(t,e);var n}T=function(){this._=void 0};function Mo(t,e){return t instanceof zo?Ai(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var xo,Fo,Vo=(n(Bo,Fo=T),Bo),Uo=(n(qo,xo=T),qo);function qo(t){var e=this;return(e=xo.call(this)||this).elements=t,e}function Bo(){return null!==Fo&&Fo.apply(this,arguments)||this}function jo(t,e){for(var n=Jo(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return wi(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Go,Ko=(n(Ho,Go=T),Ho);function Ho(t){var e=this;return(e=Go.call(this)||this).elements=t,e}function Wo(t,e){for(var n=Jo(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!wi(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Qo,zo=(n(Yo,Qo=T),Yo);function Yo(t,e){var n=this;return(n=Qo.call(this)||this).R=t,n.A=e,n}function Xo(t){return li(t.integerValue||t.doubleValue)}function Jo(t){return Ni(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function $o(t,e){this.field=t,this.transform=e}function Zo(t,e){this.version=t,this.transformResults=e}var ts=(es.none=function(){return new es},es.exists=function(t){return new es(void 0,t)},es.updateTime=function(t){return new es(t)},Object.defineProperty(es.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),es.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},es);function es(t,e){this.updateTime=t,this.exists=e}function ns(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}Se=function(){};function rs(t,e,n){var r,i,o,s;t instanceof us?(i=e,o=n,ns((r=t).precondition,i)&&(s=r.value.clone(),o=ds(r.fieldTransforms,o,i),s.setAll(o),i.convertToFoundDocument(os(i),s).setHasLocalMutations())):t instanceof cs?(o=e,i=n,ns((s=t).precondition,o)&&(n=ds(s.fieldTransforms,i,o),(i=o.data).setAll(fs(s)),i.setAll(n),o.convertToFoundDocument(os(o),i).setHasLocalMutations())):(e=e,ns(t.precondition,e)&&e.convertToNoDocument(Hr.min()))}function is(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Gr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Uo&&e instanceof Uo||t instanceof Ko&&e instanceof Ko?Gr(t.elements,e.elements,wi):t instanceof zo&&e instanceof zo?wi(t.A,e.A):t instanceof Vo&&e instanceof Vo)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var n,r}function os(t){return t.isFoundDocument()?t.version:Hr.min()}var ss,as,us=(n(ls,as=Se),ls),cs=(n(hs,ss=Se),hs);function hs(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=ss.call(this)||this).key=t,o.data=e,o.fieldMask=n,o.precondition=r,o.fieldTransforms=i,o.type=1,o}function ls(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=as.call(this)||this).key=t,i.value=e,i.precondition=n,i.fieldTransforms=r,i.type=0,i}function fs(n){var r=new Map;return n.fieldMask.fields.forEach(function(t){var e;t.isEmpty()||(e=n.data.field(t),r.set(t,e))}),r}function ps(t,e,n){var r=new Map;Ur(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,(o=s,s=a,a=n[i],o instanceof Uo?jo(o,s):o instanceof Ko?Wo(o,s):a))}return r}function ds(t,e,n){for(var r,i=new Map,o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,c=n.data.field(a.field);i.set(a.field,(r=c,a=e,c=void 0,(u=u)instanceof Vo?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):u instanceof Uo?jo(u,r):u instanceof Ko?Wo(u,r):(u=Mo(c=u,r),r=Xo(u)+Xo(c.A),Ai(u)&&Ai(c.A)?Lo(r):Oo(c.R,r))))}return i}function ys(t){this.count=t}var gs,vs,ms,bs=(n(Es,ms=Se),Es),ws=(n(_s,vs=Se),_s);function _s(t,e){var n=this;return(n=vs.call(this)||this).key=t,n.precondition=e,n.type=3,n.fieldTransforms=[],n}function Es(t,e){var n=this;return(n=ms.call(this)||this).key=t,n.precondition=e,n.type=2,n.fieldTransforms=[],n}function Ts(t){switch(t){case Cr.OK:return Vr(),0;case Cr.CANCELLED:case Cr.UNKNOWN:case Cr.DEADLINE_EXCEEDED:case Cr.RESOURCE_EXHAUSTED:case Cr.INTERNAL:case Cr.UNAVAILABLE:case Cr.UNAUTHENTICATED:return;case Cr.INVALID_ARGUMENT:case Cr.NOT_FOUND:case Cr.ALREADY_EXISTS:case Cr.PERMISSION_DENIED:case Cr.FAILED_PRECONDITION:case Cr.ABORTED:case Cr.OUT_OF_RANGE:case Cr.UNIMPLEMENTED:case Cr.DATA_LOSS:return 1;default:return Vr(),0}}function Is(t){if(void 0===t)return Mr("GRPC error has no .code"),Cr.UNKNOWN;switch(t){case gs.OK:return Cr.OK;case gs.CANCELLED:return Cr.CANCELLED;case gs.UNKNOWN:return Cr.UNKNOWN;case gs.DEADLINE_EXCEEDED:return Cr.DEADLINE_EXCEEDED;case gs.RESOURCE_EXHAUSTED:return Cr.RESOURCE_EXHAUSTED;case gs.INTERNAL:return Cr.INTERNAL;case gs.UNAVAILABLE:return Cr.UNAVAILABLE;case gs.UNAUTHENTICATED:return Cr.UNAUTHENTICATED;case gs.INVALID_ARGUMENT:return Cr.INVALID_ARGUMENT;case gs.NOT_FOUND:return Cr.NOT_FOUND;case gs.ALREADY_EXISTS:return Cr.ALREADY_EXISTS;case gs.PERMISSION_DENIED:return Cr.PERMISSION_DENIED;case gs.FAILED_PRECONDITION:return Cr.FAILED_PRECONDITION;case gs.ABORTED:return Cr.ABORTED;case gs.OUT_OF_RANGE:return Cr.OUT_OF_RANGE;case gs.UNIMPLEMENTED:return Cr.UNIMPLEMENTED;case gs.DATA_LOSS:return Cr.DATA_LOSS;default:return Vr()}}(T=gs=gs||{})[T.OK=0]="OK",T[T.CANCELLED=1]="CANCELLED",T[T.UNKNOWN=2]="UNKNOWN",T[T.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",T[T.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",T[T.NOT_FOUND=5]="NOT_FOUND",T[T.ALREADY_EXISTS=6]="ALREADY_EXISTS",T[T.PERMISSION_DENIED=7]="PERMISSION_DENIED",T[T.UNAUTHENTICATED=16]="UNAUTHENTICATED",T[T.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",T[T.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",T[T.ABORTED=10]="ABORTED",T[T.OUT_OF_RANGE=11]="OUT_OF_RANGE",T[T.UNIMPLEMENTED=12]="UNIMPLEMENTED",T[T.INTERNAL=13]="INTERNAL",T[T.UNAVAILABLE=14]="UNAVAILABLE",T[T.DATA_LOSS=15]="DATA_LOSS";var Ss=(Rs.prototype.insert=function(t,e){return new Rs(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Ns.BLACK,null,null))},Rs.prototype.remove=function(t){return new Rs(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ns.BLACK,null,null))},Rs.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Rs.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Rs.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(Rs.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Rs.prototype.minKey=function(){return this.root.minKey()},Rs.prototype.maxKey=function(){return this.root.maxKey()},Rs.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},Rs.prototype.forEach=function(n){this.inorderTraversal(function(t,e){return n(t,e),!1})},Rs.prototype.toString=function(){var n=[];return this.inorderTraversal(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Rs.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},Rs.prototype.getIterator=function(){return new As(this.root,null,this.comparator,!1)},Rs.prototype.getIteratorFrom=function(t){return new As(this.root,t,this.comparator,!1)},Rs.prototype.getReverseIterator=function(){return new As(this.root,null,this.comparator,!0)},Rs.prototype.getReverseIteratorFrom=function(t){return new As(this.root,t,this.comparator,!0)},Rs),As=(Cs.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},Cs.prototype.hasNext=function(){return 0<this.nodeStack.length},Cs.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},Cs),Ns=(Ds.prototype.copy=function(t,e,n,r,i){return new Ds(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ds.prototype.isEmpty=function(){return!1},Ds.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},Ds.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},Ds.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},Ds.prototype.minKey=function(){return this.min().key},Ds.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},Ds.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},Ds.prototype.removeMin=function(){if(this.left.isEmpty())return Ds.EMPTY;var t=this;return(t=(t=!t.left.isRed()&&!t.left.left.isRed()?t.moveRedLeft():t).copy(null,null,null,t.left.removeMin(),null)).fixUp()},Ds.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r=(r=!(r.left.isEmpty()||r.left.isRed()||r.left.left.isRed())?r.moveRedLeft():r).copy(null,null,null,r.left.remove(t,e),null);else{if(0===e(t,(r=!((r=r.left.isRed()?r.rotateRight():r).right.isEmpty()||r.right.isRed()||r.right.left.isRed())?r.moveRedRight():r).key)){if(r.right.isEmpty())return Ds.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()},Ds.prototype.isRed=function(){return this.color},Ds.prototype.fixUp=function(){var t=this;return t=(t=(t=t.right.isRed()&&!t.left.isRed()?t.rotateLeft():t).left.isRed()&&t.left.left.isRed()?t.rotateRight():t).left.isRed()&&t.right.isRed()?t.colorFlip():t},Ds.prototype.moveRedLeft=function(){var t=this.colorFlip();return t=t.right.left.isRed()?(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip():t},Ds.prototype.moveRedRight=function(){var t=this.colorFlip();return t=t.left.left.isRed()?(t=t.rotateRight()).colorFlip():t},Ds.prototype.rotateLeft=function(){var t=this.copy(null,null,Ds.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ds.prototype.rotateRight=function(){var t=this.copy(null,null,Ds.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ds.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ds.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},Ds.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Vr();if(this.right.isRed())throw Vr();var t=this.left.check();if(t!==this.right.check())throw Vr();return t+(this.isRed()?0:1)},Ds);function Ds(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ds.RED,this.left=null!=r?r:Ds.EMPTY,this.right=null!=i?i:Ds.EMPTY,this.size=this.left.size+1+this.right.size}function Cs(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}function Rs(t,e){this.comparator=t,this.root=e||Ns.EMPTY}function ks(){this.size=0}Ns.EMPTY=null,Ns.RED=!0,Ns.BLACK=!1,Ns.EMPTY=(Object.defineProperty(ks.prototype,"key",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(ks.prototype,"value",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(ks.prototype,"color",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(ks.prototype,"left",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(ks.prototype,"right",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),ks.prototype.copy=function(t,e,n,r,i){return this},ks.prototype.insert=function(t,e,n){return new Ns(t,e)},ks.prototype.remove=function(t,e){return this},ks.prototype.isEmpty=function(){return!0},ks.prototype.inorderTraversal=function(t){return!1},ks.prototype.reverseTraversal=function(t){return!1},ks.prototype.minKey=function(){return null},ks.prototype.maxKey=function(){return null},ks.prototype.isRed=function(){return!1},ks.prototype.checkMaxDepth=function(){return!0},ks.prototype.check=function(){return 0},new ks);var Os=(xs.prototype.has=function(t){return null!==this.data.get(t)},xs.prototype.first=function(){return this.data.minKey()},xs.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(xs.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),xs.prototype.indexOf=function(t){return this.data.indexOf(t)},xs.prototype.forEach=function(n){this.data.inorderTraversal(function(t,e){return n(t),!1})},xs.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,t[1]))return;e(r.key)}},xs.prototype.forEachWhile=function(t,e){for(var n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},xs.prototype.firstAfterOrEqual=function(t){t=this.data.getIteratorFrom(t);return t.hasNext()?t.getNext().key:null},xs.prototype.getIterator=function(){return new Ls(this.data.getIterator())},xs.prototype.getIteratorFrom=function(t){return new Ls(this.data.getIteratorFrom(t))},xs.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},xs.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},xs.prototype.isEmpty=function(){return this.data.isEmpty()},xs.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},xs.prototype.isEqual=function(t){if(!(t instanceof xs))return!1;if(this.size!==t.size)return!1;for(var e=this.data.getIterator(),n=t.data.getIterator();e.hasNext();){var r=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(r,i))return!1}return!0},xs.prototype.toArray=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},xs.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},xs.prototype.copy=function(t){var e=new xs(this.comparator);return e.data=t,e},xs),Ls=(Ms.prototype.getNext=function(){return this.iter.getNext().key},Ms.prototype.hasNext=function(){return this.iter.hasNext()},Ms),Ps=new Ss(vi.comparator);function Ms(t){this.iter=t}function xs(t){this.comparator=t,this.data=new Ss(this.comparator)}var Fs=new Ss(vi.comparator);var Vs=new Ss(vi.comparator);var Us=new Os(vi.comparator);function qs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Us,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Bs=new Os(jr);var js=($s.createSynthesizedRemoteEventForCurrentChange=function(t,e){var n=new Map;return n.set(t,Gs.createSynthesizedTargetChangeForCurrentChange(t,e)),new $s(Hr.min(),n,Bs,Ps,qs())},$s),Gs=(Js.createSynthesizedTargetChangeForCurrentChange=function(t,e){return new Js(ri.EMPTY_BYTE_STRING,e,qs(),qs(),qs())},Js),Ks=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Hs=function(t,e){this.targetId=t,this.V=e},Ws=function(t,e,n,r){void 0===n&&(n=ri.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Qs=(Object.defineProperty(Xs.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(Xs.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(Xs.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(Xs.prototype,"O",{get:function(){return this.F},enumerable:!1,configurable:!0}),Xs.prototype.$=function(t){0<t.approximateByteSize()&&(this.F=!0,this.C=t)},Xs.prototype.M=function(){var n=qs(),r=qs(),i=qs();return this.D.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Vr()}}),new Gs(this.C,this.N,n,r,i)},Xs.prototype.L=function(){this.F=!1,this.D=ta()},Xs.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},Xs.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},Xs.prototype.U=function(){this.S+=1},Xs.prototype.K=function(){--this.S},Xs.prototype.j=function(){this.F=!0,this.N=!0},Xs),zs=(Ys.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},Ys.prototype.et=function(n){var r=this;this.forEachTarget(n,function(t){var e=r.nt(t);switch(n.state){case 0:r.st(t)&&e.$(n.resumeToken);break;case 1:e.K(),e.k||e.L(),e.$(n.resumeToken);break;case 2:e.K(),e.k||r.removeTarget(t);break;case 3:r.st(t)&&(e.j(),e.$(n.resumeToken));break;case 4:r.st(t)&&(r.it(t),e.$(n.resumeToken));break;default:Vr()}})},Ys.prototype.forEachTarget=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.G.forEach(function(t,e){r.st(e)&&n(e)})},Ys.prototype.rt=function(t){var e=t.targetId,n=t.V.count,t=this.ot(e);t&&(Ui(t=t.target)?0===n?(t=new vi(t.path),this.tt(e,t,Li.newNoDocument(t,Hr.min()))):Ur(1===n):this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e)))},Ys.prototype.ut=function(r){var i=this,o=new Map;this.G.forEach(function(t,e){var n=i.ot(e);n&&(t.current&&Ui(n.target)&&(n=new vi(n.target.path),null!==i.H.get(n)||i.at(e,n)||i.tt(e,n,Li.newNoDocument(n,r))),t.O&&(o.set(e,t.M()),t.L()))});var s=qs();this.J.forEach(function(t,e){var n=!0;e.forEachWhile(function(t){t=i.ot(t);return!t||2===t.purpose||(n=!1)}),n&&(s=s.add(t))});var t=new js(r,o,this.Y,this.H,s);return this.H=Ps,this.J=Zs(),this.Y=new Os(jr),t},Ys.prototype.Z=function(t,e){var n;this.st(t)&&(n=this.at(t,e.key)?2:0,this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t)))},Ys.prototype.tt=function(t,e,n){var r;this.st(t)&&(r=this.nt(t),this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n)))},Ys.prototype.removeTarget=function(t){this.G.delete(t)},Ys.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},Ys.prototype.U=function(t){this.nt(t).U()},Ys.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Qs,this.G.set(t,e)),e},Ys.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Os(jr),this.J=this.J.insert(t,e)),e},Ys.prototype.st=function(t){var e=null!==this.ot(t);return e||Pr("WatchChangeAggregator","Detected inactive target",t),e},Ys.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},Ys.prototype.it=function(e){var n=this;this.G.set(e,new Qs),this.W.getRemoteKeysForTarget(e).forEach(function(t){n.tt(e,t,null)})},Ys.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},Ys);function Ys(t){this.W=t,this.G=new Map,this.H=Ps,this.J=Zs(),this.Y=new Os(jr)}function Xs(){this.S=0,this.D=ta(),this.C=ri.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}function Js(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}function $s(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}function Zs(){return new Ss(vi.comparator)}function ta(){return new Ss(vi.comparator)}var ea={asc:"ASCENDING",desc:"DESCENDING"},na={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ra=function(t,e){this.databaseId=t,this.I=e};function ia(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function oa(t,e){return t.I?e.toBase64():e.toUint8Array()}function sa(t){return Ur(!!t),Hr.fromTimestamp((t=hi(t),new Kr(t.seconds,t.nanos)))}function aa(t,e){return new Zr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).canonicalString()}function ua(t){t=Zr.fromString(t);return Ur(Ia(t)),t}function ca(t,e){return aa(t.databaseId,e.path)}function ha(t,e){e=ua(e);if(e.get(1)!==t.databaseId.projectId)throw new Rr(Cr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.databaseId.projectId);if(e.get(3)!==t.databaseId.database)throw new Rr(Cr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.databaseId.database);return new vi(pa(e))}function la(t,e){return aa(t.databaseId,e)}function fa(t){return new Zr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function pa(t){return Ur(4<t.length&&"documents"===t.get(4)),t.popFirst(5)}function da(t,e,n){return{name:ca(t,e),fields:n.toProto().mapValue.fields}}function ya(t,e){var n,r,i;if(e instanceof us)n={update:da(t,e.key,e.value)};else if(e instanceof bs)n={delete:ca(t,e.key)};else if(e instanceof cs)n={update:da(t,e.key,e.data),updateMask:(i=e.fieldMask,r=[],i.fields.forEach(function(t){return r.push(t.canonicalString())}),{fieldPaths:r})};else{if(!(e instanceof ws))return Vr();n={verify:ca(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Vo)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(e instanceof Uo)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:e.elements}};if(e instanceof Ko)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:e.elements}};if(e instanceof zo)return{fieldPath:t.field.canonicalString(),increment:e.A};throw Vr()})),e.precondition.isNone||(n.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:(e=t,t=i.updateTime,ia(e,t.toTimestamp()))}:void 0!==i.exists?{exists:i.exists}:Vr()),n}function ga(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=la(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=la(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Ci(t.value))return{unaryFilter:{field:wa(t.field),op:"IS_NAN"}};if(Di(t.value))return{unaryFilter:{field:wa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ci(t.value))return{unaryFilter:{field:wa(t.field),op:"IS_NOT_NAN"}};if(Di(t.value))return{unaryFilter:{field:wa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wa(t.field),op:(e=t.op,na[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:wa((t=t).field),direction:(t=t.dir,ea[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.I||yi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ma(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ma(e.endAt)),n}function va(t){var e=4===(o=ua(t.parent)).length?Zr.emptyPath():pa(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Ur(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[Ta(t)]:void 0!==t.fieldFilter?[Ea(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Vr():[]}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new po(_a((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=yi(a="object"==typeof(a=n.limit)?a.value:a)?null:a);var s=null;n.startAt&&(s=ba(n.startAt));var a=null;return n.endAt&&(a=ba(n.endAt)),new vo(e,i,t,o,r,"F",s,a)}function ma(t){return{before:t.before,values:t.position}}function ba(t){var e=!!t.before,t=t.values||[];return new ao(t,e)}function wa(t){return{fieldPath:t.canonicalString()}}function _a(t){return ei.fromServerFormat(t.fieldPath)}function Ea(t){return Bi.create(_a(t.fieldFilter.field),function(){switch(t.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Vr()}}(),t.fieldFilter.value)}function Ta(t){switch(t.unaryFilter.op){case"IS_NAN":var e=_a(t.unaryFilter.field);return Bi.create(e,"==",{doubleValue:NaN});case"IS_NULL":e=_a(t.unaryFilter.field);return Bi.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var n=_a(t.unaryFilter.field);return Bi.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":n=_a(t.unaryFilter.field);return Bi.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Vr()}}function Ia(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Se=(Da.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},Da.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},Da),Sa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Aa=(Na.prototype.catch=function(t){return this.next(void 0,t)},Na.prototype.next=function(r,i){var o=this;return this.callbackAttached&&Vr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(r,this.result):new Na(function(e,n){o.nextCallback=function(t){o.wrapSuccess(r,t).next(e,n)},o.catchCallback=function(t){o.wrapFailure(i,t).next(e,n)}})},Na.prototype.toPromise=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Na.prototype.wrapUserFunction=function(t){try{var e=t();return e instanceof Na?e:Na.resolve(e)}catch(t){return Na.reject(t)}},Na.prototype.wrapSuccess=function(t,e){return t?this.wrapUserFunction(function(){return t(e)}):Na.resolve(e)},Na.prototype.wrapFailure=function(t,e){return t?this.wrapUserFunction(function(){return t(e)}):Na.reject(e)},Na.resolve=function(n){return new Na(function(t,e){t(n)})},Na.reject=function(n){return new Na(function(t,e){e(n)})},Na.waitFor=function(t){return new Na(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Na.or=function(t){for(var n=Na.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Na.resolve(t):e()})}(r[e]);return n},Na.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.waitFor(i)},Na);function Na(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}function Da(){this.onCommittedListeners=[]}function Ca(t){return"IndexedDbTransactionError"===t.name}function Ra(t){this.Lt=t}var ka=(xa.prototype.applyToRemoteDocument=function(t,e){for(var n,r,i,o,s,a,u=e.mutationResults,c=0;c<this.mutations.length;c++){var h=this.mutations[c];h.key.isEqual(t.key)&&(n=h,r=t,i=u[c],h=a=s=o=void 0,n instanceof us?(s=r,a=i,h=(o=n).value.clone(),o=ps(o.fieldTransforms,s,a.transformResults),h.setAll(o),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()):n instanceof cs?(o=r,s=i,ns((a=n).precondition,o)?(h=ps(a.fieldTransforms,o,s.transformResults),(n=o.data).setAll(fs(a)),n.setAll(h),o.convertToFoundDocument(s.version,n).setHasCommittedMutations()):o.convertToUnknownDocument(s.version)):r.convertToNoDocument(i.version).setHasCommittedMutations())}},xa.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(r=n[e]).key.isEqual(t.key)&&rs(r,t,this.localWriteTime);for(var r,i=0,o=this.mutations;i<o.length;i++)(r=o[i]).key.isEqual(t.key)&&rs(r,t,this.localWriteTime)},xa.prototype.applyToLocalDocumentSet=function(n){var r=this;this.mutations.forEach(function(t){var e=n.get(t.key),t=e;r.applyToLocalView(t),e.isValidDocument()||t.convertToNoDocument(Hr.min())})},xa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},qs())},xa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Gr(this.mutations,t.mutations,is)&&Gr(this.baseMutations,t.baseMutations,is)},xa),Oa=(Ma.from=function(t,e,n){Ur(t.mutations.length===n.length);for(var r=Vs,i=t.mutations,o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new Ma(t,e,n,r)},Ma),La=(Pa.prototype.withSequenceNumber=function(t){return new Pa(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Pa.prototype.withResumeToken=function(t,e){return new Pa(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Pa.prototype.withLastLimboFreeSnapshotVersion=function(t){return new Pa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},Pa);function Pa(t,e,n,r,i,o,s){void 0===i&&(i=Hr.min()),void 0===o&&(o=Hr.min()),void 0===s&&(s=ri.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ma(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}function xa(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}function Fa(t){var e=va({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ao(e,e.limit,"L"):e}var Va=(Ga.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Aa.resolve()},Ga.prototype.getCollectionParents=function(t,e){return Aa.resolve(this.Bt.getEntries(e))},Ga),Ua=(ja.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Os(Zr.comparator),t=!r.has(n);return this.index[e]=r.add(n),t},ja.prototype.has=function(t){var e=t.lastSegment(),t=t.popLast(),e=this.index[e];return e&&e.has(t)},ja.prototype.getEntries=function(t){return(this.index[t]||new Os(Zr.comparator)).toArray()},ja),qa=(Ba.prototype.next=function(){return this.Ht+=2,this.Ht},Ba.Jt=function(){return new Ba(0)},Ba.Yt=function(){return new Ba(-1)},Ba);function Ba(t){this.Ht=t}function ja(){this.index={}}function Ga(){this.Bt=new Ua}function Ka(e){return y(this,void 0,void 0,function(){return g(this,function(t){if(e.code!==Cr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Pr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Ha(t,e){this.progress=t,this.wn=e}var Wa=(nu.prototype.get=function(t){var e=this.mapKeyFn(t),e=this.inner[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.equalsFn(o,t))return i}},nu.prototype.has=function(t){return void 0!==this.get(t)},nu.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},nu.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},nu.prototype.forEach=function(s){Yr(this.inner,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},nu.prototype.isEmpty=function(){return Xr(this.inner)},nu),T=(eu.prototype.getReadTime=function(t){t=this.changes.get(t);return t?t.readTime:Hr.min()},eu.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},eu.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Li.newInvalidDocument(t),readTime:e})},eu.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Aa.resolve(n.document):this.getFromCache(t,e)},eu.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},eu.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},eu.prototype.assertNotApplied=function(){},eu),Qa=(tu.prototype.mn=function(e,n){var r=this;return this._n.getAllMutationBatchesAffectingDocumentKey(e,n).next(function(t){return r.yn(e,n,t)})},tu.prototype.yn=function(t,e,r){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,n=r;e<n.length;e++)n[e].applyToLocalView(t);return t})},tu.prototype.gn=function(t,i){t.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)r[n].applyToLocalView(e)})},tu.prototype.pn=function(e,t){var n=this;return this.Ue.getEntries(e,t).next(function(t){return n.En(e,t).next(function(){return t})})},tu.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},tu.prototype.getDocumentsMatchingQuery=function(t,e,n){return r=e,vi.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Tn(t,e.path):To(e)?this.In(t,e,n):this.An(t,e,n);var r},tu.prototype.Tn=function(t,e){return this.mn(t,new vi(e)).next(function(t){var e=Fs;return e=t.isFoundDocument()?e.insert(t.key,t):e})},tu.prototype.In=function(n,r,i){var o=this,s=r.collectionGroup,a=Fs;return this.Ut.getCollectionParents(n,s).next(function(t){return Aa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new vo(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.An(n,e,i).next(function(t){t.forEach(function(t,e){a=a.insert(t,e)})})}).next(function(){return a})})},tu.prototype.An=function(e,n,t){var c,h,r=this;return this.Ue.getDocumentsMatchingQuery(e,n,t).next(function(t){return c=t,r._n.getAllMutationBatchesAffectingQuery(e,n)}).next(function(t){return h=t,r.Rn(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a);null==u&&(u=Li.newInvalidDocument(a),c=c.insert(a,u)),rs(s,u,r.localWriteTime),u.isFoundDocument()||(c=c.remove(a))}})}).next(function(){return c.forEach(function(t,e){Ro(n,e)||(c=c.remove(t))}),c})},tu.prototype.Rn=function(t,e,n){for(var r=qs(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof cs&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},tu),za=(Za.Pn=function(t,e){for(var n=qs(),r=qs(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Za(t,e.fromCache,n,r)},Za),Ya=($a.prototype.Vn=function(t){this.Sn=t},$a.prototype.getDocumentsMatchingQuery=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())||i.isEqual(Hr.min())?this.Dn(e,r):this.Sn.pn(e,o).next(function(t){var n=s.Cn(r,t);return(bo(r)||wo(r))&&s.Nn(r.limitType,n,o,i)?s.Dn(e,r):(Lr()<=d.DEBUG&&Pr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Co(r)),s.Sn.getDocumentsMatchingQuery(e,r,i).next(function(e){return n.forEach(function(t){e=e.insert(t.key,t)}),e}))})},$a.prototype.Cn=function(n,t){var r=new Os(ko(n));return t.forEach(function(t,e){Ro(n,e)&&(r=r.add(e))}),r},$a.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.compareTo(r))},$a.prototype.Dn=function(t,e){return Lr()<=d.DEBUG&&Pr("QueryEngine","Using full collection scan to execute query:",Co(e)),this.Sn.getDocumentsMatchingQuery(t,e,Hr.min())},$a),Xa=(Ja.prototype.collectGarbage=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.collect(t,n.Fn)})},Ja);function Ja(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new Ss(jr),this.kn=new Wa(Fi,Vi),this.On=Hr.min(),this._n=t.getMutationQueue(n),this.$n=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Qa(this.$n,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}function $a(){}function Za(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}function tu(t,e,n){this.Ue=t,this._n=e,this.Ut=n}function eu(){this.changes=new Wa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}function nu(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}function ru(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return g(this,function(t){switch(t.label){case 0:return n=(e=i)._n,m=e.Mn,[4,e.persistence.runTransaction("Handle user change","readonly",function(g){var v;return e._n.getAllMutationBatches(g).next(function(t){return v=t,n=e.persistence.getMutationQueue(o),m=new Qa(e.$n,n,e.persistence.getIndexManager()),n.getAllMutationBatches(g)}).next(function(t){for(var e=[],n=[],r=qs(),i=0,o=v;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var c=u[a],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.pn(g,r).next(function(t){return{Ln:t,removedBatchIds:e,addedBatchIds:n}})})})];case 1:return r=t.sent(),[2,(e._n=n,e.Mn=m,e.xn.Vn(e.Mn),r)]}})})}function iu(t,h){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,a,u=h.batch.keys(),c=l.$n.newChangeBuffer({trackRemovals:!0});return e=l,r=t,o=c,s=(i=h).batch,n=s.keys(),a=Aa.resolve(),n.forEach(function(n){a=a.next(function(){return o.getEntry(r,n)}).next(function(t){var e=i.docVersions.get(n);Ur(null!==e),t.version.compareTo(e)<0&&(s.applyToRemoteDocument(t,i),t.isValidDocument()&&o.addEntry(t,i.commitVersion))})}),a.next(function(){return e._n.removeMutationBatch(r,s)}).next(function(){return c.apply(t)}).next(function(){return l._n.performConsistencyCheck(t)}).next(function(){return l.Mn.pn(t,u)})})}function ou(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function su(t,r){var u=t,c=r.snapshotVersion,h=u.Fn;return u.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=u.$n.newChangeBuffer({trackRemovals:!0});h=u.Fn;var a=[];r.targetChanges.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(a.push(u.qe.removeMatchingKeys(s,t.removedDocuments,e).next(function(){return u.qe.addMatchingKeys(s,t.addedDocuments,e)})),0<(i=t.resumeToken).approximateByteSize()&&(n=o.withResumeToken(i,c).withSequenceNumber(s.currentSequenceNumber),h=h.insert(e,n),r=o,i=t,Ur(0<(o=n).resumeToken.approximateByteSize()),(0===r.resumeToken.approximateByteSize()||3e8<=o.snapshotVersion.toMicroseconds()-r.snapshotVersion.toMicroseconds()||0<i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size)&&a.push(u.qe.updateTargetData(s,n))))});var e,n=Ps;return r.documentUpdates.forEach(function(t,e){r.resolvedLimboDocuments.has(t)&&a.push(u.persistence.referenceDelegate.updateLimboDocument(s,t))}),a.push(au(s,t,r.documentUpdates,c,void 0).next(function(t){n=t})),c.isEqual(Hr.min())||(e=u.qe.getLastRemoteSnapshotVersion(s).next(function(t){return u.qe.setTargetsMetadata(s,s.currentSequenceNumber,c)}),a.push(e)),Aa.waitFor(a).next(function(){return t.apply(s)}).next(function(){return u.Mn.En(s,n)}).next(function(){return n})}).then(function(t){return u.Fn=h,t})}function au(t,s,e,a,u){var n=qs();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=Ps;return e.forEach(function(t,e){var n=i.get(t),r=(null==u?void 0:u.get(t))||a;e.isNoDocument()&&e.version.isEqual(Hr.min())?(s.removeEntry(t,r),o=o.insert(t,e)):!n.isValidDocument()||0<e.version.compareTo(n.version)||0===e.version.compareTo(n.version)&&n.hasPendingWrites?(s.addEntry(e,r),o=o.insert(t,e)):Pr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function uu(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.qe.getTargetData(e,r).next(function(t){return t?(n=t,Aa.resolve(n)):i.qe.allocateTargetId(e).next(function(t){return n=new La(r,t,0,e.currentSequenceNumber),i.qe.addTargetData(e,n).next(function(){return n})})})}).then(function(t){var e=i.Fn.get(t.targetId);return(null===e||0<t.snapshotVersion.compareTo(e.snapshotVersion))&&(i.Fn=i.Fn.insert(t.targetId,t),i.kn.set(r,t.targetId)),t})}function cu(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:n=(e=i).Fn.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.referenceDelegate.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ca(r=t.sent()))throw r;return Pr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Fn=e.Fn.remove(o),e.kn.delete(n.target),[2]}})})}function hu(t,o,s){var a=t,u=Hr.min(),c=qs();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=So(o),(void 0!==(t=(i=t).kn.get(r))?Aa.resolve(i.Fn.get(t)):i.qe.getTargetData(n,r)).next(function(t){if(t)return u=t.lastLimboFreeSnapshotVersion,a.qe.getMatchingKeysForTargetId(e,t.targetId).next(function(t){c=t})}).next(function(){return a.xn.getDocumentsMatchingQuery(e,o,s?u:Hr.min(),s?c:qs())}).next(function(t){return{documents:t,Bn:c}});var t,n,r,i})}var lu,fu,pu=(Pu.prototype.getBundleMetadata=function(t,e){return Aa.resolve(this.Kn.get(e))},Pu.prototype.saveBundleMetadata=function(t,e){return this.Kn.set(e.id,{id:e.id,version:e.version,createTime:sa(e.createTime)}),Aa.resolve()},Pu.prototype.getNamedQuery=function(t,e){return Aa.resolve(this.jn.get(e))},Pu.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,{name:(e=e).name,query:Fa(e.bundledQuery),readTime:sa(e.readTime)}),Aa.resolve()},Pu),du=(Lu.prototype.isEmpty=function(){return this.Wn.isEmpty()},Lu.prototype.addReference=function(t,e){e=new yu(t,e);this.Wn=this.Wn.add(e),this.zn=this.zn.add(e)},Lu.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},Lu.prototype.removeReference=function(t,e){this.Yn(new yu(t,e))},Lu.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},Lu.prototype.Zn=function(t){var e=this,n=new vi(new Zr([])),r=new yu(n,t),t=new yu(n,t+1),i=[];return this.zn.forEachInRange([r,t],function(t){e.Yn(t),i.push(t.key)}),i},Lu.prototype.ts=function(){var e=this;this.Wn.forEach(function(t){return e.Yn(t)})},Lu.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},Lu.prototype.es=function(t){var e=new vi(new Zr([])),n=new yu(e,t),t=new yu(e,t+1),r=qs();return this.zn.forEachInRange([n,t],function(t){r=r.add(t.key)}),r},Lu.prototype.containsKey=function(t){var e=new yu(t,0),e=this.Wn.firstAfterOrEqual(e);return null!==e&&t.isEqual(e.key)},Lu),yu=(Ou.Gn=function(t,e){return vi.comparator(t.key,e.key)||jr(t.ns,e.ns)},Ou.Hn=function(t,e){return jr(t.ns,e.ns)||vi.comparator(t.key,e.key)},Ou),gu=(ku.prototype.checkEmpty=function(t){return Aa.resolve(0===this._n.length)},ku.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,0<this._n.length&&this._n[this._n.length-1];n=new ka(i,e,n,r);this._n.push(n);for(var o=0,s=r;o<s.length;o++){var a=s[o];this.rs=this.rs.add(new yu(a.key,i)),this.Ut.addToCollectionParentIndex(t,a.key.path.popLast())}return Aa.resolve(n)},ku.prototype.lookupMutationBatch=function(t,e){return Aa.resolve(this.os(e))},ku.prototype.getNextMutationBatchAfterBatchId=function(t,e){e+=1,e=this.cs(e),e=e<0?0:e;return Aa.resolve(this._n.length>e?this._n[e]:null)},ku.prototype.getHighestUnacknowledgedBatchId=function(){return Aa.resolve(0===this._n.length?-1:this.ss-1)},ku.prototype.getAllMutationBatches=function(t){return Aa.resolve(this._n.slice())},ku.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new yu(e,0),e=new yu(e,Number.POSITIVE_INFINITY),i=[];return this.rs.forEachInRange([r,e],function(t){t=n.os(t.ns);i.push(t)}),Aa.resolve(i)},ku.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Os(jr);return e.forEach(function(t){var e=new yu(t,0),t=new yu(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,t],function(t){r=r.add(t.ns)})}),Aa.resolve(this.us(r))},ku.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,e=n;vi.isDocumentKey(e)||(e=e.child(""));var e=new yu(new vi(e),0),i=new Os(jr);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(i=i.add(t.ns)),!0)},e),Aa.resolve(this.us(i))},ku.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){t=e.os(t);null!==t&&n.push(t)}),n},ku.prototype.removeMutationBatch=function(n,r){var i=this;Ur(0===this.hs(r.batchId,"removed")),this._n.shift();var o=this.rs;return Aa.forEach(r.mutations,function(t){var e=new yu(t.key,r.batchId);return o=o.delete(e),i.referenceDelegate.markPotentiallyOrphaned(n,t.key)}).next(function(){i.rs=o})},ku.prototype.Gt=function(t){},ku.prototype.containsKey=function(t,e){var n=new yu(e,0),n=this.rs.firstAfterOrEqual(n);return Aa.resolve(e.isEqual(n&&n.key))},ku.prototype.performConsistencyCheck=function(t){return this._n.length,Aa.resolve()},ku.prototype.hs=function(t,e){return this.cs(t)},ku.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},ku.prototype.os=function(t){t=this.cs(t);return t<0||t>=this._n.length?null:this._n[t]},ku),vu=(Ru.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:i,readTime:n}),this.size+=i-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},Ru.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ru.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Aa.resolve(n?n.document.clone():Li.newInvalidDocument(e))},Ru.prototype.getEntries=function(t,e){var n=this,r=Ps;return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Li.newInvalidDocument(t))}),Aa.resolve(r)},Ru.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Ps,i=new vi(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,s=u.document,u=u.readTime;if(!e.path.isPrefixOf(a.path))break;u.compareTo(n)<=0||Ro(e,s)&&(r=r.insert(s.key,s.clone()))}return Aa.resolve(r)},Ru.prototype.fs=function(t,e){return Aa.forEach(this.docs,function(t){return e(t)})},Ru.prototype.newChangeBuffer=function(t){return new mu(this)},Ru.prototype.getSize=function(t){return Aa.resolve(this.size)},Ru),mu=(n(Cu,fu=T),Cu.prototype.applyChanges=function(n){var r=this,i=[];return this.changes.forEach(function(t,e){e.document.isValidDocument()?i.push(r.Ie.addEntry(n,e.document,r.getReadTime(t))):r.Ie.removeEntry(t)}),Aa.waitFor(i)},Cu.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},Cu.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},Cu),bu=(Du.prototype.forEachTarget=function(t,n){return this.ds.forEach(function(t,e){return n(e)}),Aa.resolve()},Du.prototype.getLastRemoteSnapshotVersion=function(t){return Aa.resolve(this.lastRemoteSnapshotVersion)},Du.prototype.getHighestSequenceNumber=function(t){return Aa.resolve(this.ws)},Du.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Aa.resolve(this.highestTargetId)},Du.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Aa.resolve()},Du.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new qa(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},Du.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Aa.resolve()},Du.prototype.updateTargetData=function(t,e){return this.te(e),Aa.resolve()},Du.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),--this.targetCount,Aa.resolve()},Du.prototype.removeTargets=function(n,r,i){var o=this,s=0,a=[];return this.ds.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.ds.delete(t),a.push(o.removeMatchingKeysForTargetId(n,e.targetId)),s++)}),Aa.waitFor(a).next(function(){return s})},Du.prototype.getTargetCount=function(t){return Aa.resolve(this.targetCount)},Du.prototype.getTargetData=function(t,e){e=this.ds.get(e)||null;return Aa.resolve(e)},Du.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Aa.resolve()},Du.prototype.removeMatchingKeys=function(e,t,n){this._s.Xn(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),Aa.waitFor(i)},Du.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Aa.resolve()},Du.prototype.getMatchingKeysForTargetId=function(t,e){e=this._s.es(e);return Aa.resolve(e)},Du.prototype.containsKey=function(t,e){return Aa.resolve(this._s.containsKey(e))},Du),wu=(Nu.prototype.start=function(){return Promise.resolve()},Nu.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(Nu.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),Nu.prototype.setDatabaseDeletedListener=function(){},Nu.prototype.setNetworkEnabled=function(){},Nu.prototype.getIndexManager=function(){return this.Ut},Nu.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new gu(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},Nu.prototype.getTargetCache=function(){return this.qe},Nu.prototype.getRemoteDocumentCache=function(){return this.Ue},Nu.prototype.getBundleCache=function(){return this.Qe},Nu.prototype.runTransaction=function(t,e,n){var r=this;Pr("MemoryPersistence","Starting transaction:",t);var i=new _u(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},Nu.prototype.Is=function(e,n){return Aa.or(Object.values(this.gs).map(function(t){return function(){return t.containsKey(e,n)}}))},Nu),_u=(n(Au,lu=Se),Au),Eu=(Su.bs=function(t){return new Su(t)},Object.defineProperty(Su.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Vr()},enumerable:!1,configurable:!0}),Su.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Aa.resolve()},Su.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Aa.resolve()},Su.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Aa.resolve()},Su.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},Su.prototype.Es=function(){this.Rs=new Set},Su.prototype.Ts=function(n){var r=this,i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Aa.forEach(this.vs,function(t){var e=vi.fromPath(t);return r.Ps(n,e).next(function(t){t||i.removeEntry(e)})}).next(function(){return r.Rs=null,i.apply(n)})},Su.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},Su.prototype.ps=function(t){return 0},Su.prototype.Ps=function(t,e){var n=this;return Aa.or([function(){return Aa.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},Su),Tu=(Iu.prototype.isAuthenticated=function(){return null!=this.uid},Iu.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},Iu.prototype.isEqual=function(t){return t.uid===this.uid},Iu);function Iu(t){this.uid=t}function Su(t){this.persistence=t,this.As=new du,this.Rs=null}function Au(t){var e=this;return(e=lu.call(this)||this).currentSequenceNumber=t,e}function Nu(t,e){var n=this;this.gs={},this.Ne=new Ar(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new bu(this),this.Ut=new Va,this.Ue=(t=this.Ut,new vu(t,function(t){return n.referenceDelegate.ps(t)})),this.R=new Ra(e),this.Qe=new pu(this.R)}function Du(t){this.persistence=t,this.ds=new Wa(Fi,Vi),this.lastRemoteSnapshotVersion=Hr.min(),this.highestTargetId=0,this.ws=0,this._s=new du,this.targetCount=0,this.ys=qa.Jt()}function Cu(t){var e=this;return(e=fu.call(this)||this).Ie=t,e}function Ru(t,e){this.Ut=t,this.ls=e,this.docs=new Ss(vi.comparator),this.size=0}function ku(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Os(yu.Gn)}function Ou(t,e){this.key=t,this.ns=e}function Lu(){this.Wn=new Os(yu.Gn),this.zn=new Os(yu.Hn)}function Pu(t){this.R=t,this.Kn=new Map,this.jn=new Map}Tu.UNAUTHENTICATED=new Tu(null),Tu.GOOGLE_CREDENTIALS=new Tu("google-credentials-uid"),Tu.FIRST_PARTY=new Tu("first-party-uid");var Mu,xu=(Yu.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Yu.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Yu.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},Yu),Fu=(zu.prototype.addPendingMutation=function(t){},zu.prototype.updateMutationState=function(t,e,n){},zu.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},zu.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},zu.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},zu.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},zu.prototype.clearQueryState=function(t){delete this.fi[t]},zu.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},zu.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},zu.prototype.start=function(){return this.li=new xu,Promise.resolve()},zu.prototype.handleUserChange=function(t,e,n){},zu.prototype.setOnlineState=function(t){},zu.prototype.shutdown=function(){},zu.prototype.writeSequenceNumber=function(t){},zu.prototype.notifyBundleLoaded=function(){},zu),Vu=(Qu.prototype.di=function(t){},Qu.prototype.shutdown=function(){},Qu),Uu=(Wu.prototype.di=function(t){this.gi.push(t)},Wu.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},Wu.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},Wu.prototype._i=function(){Pr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},Wu.prototype.yi=function(){Pr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},Wu.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Wu),qu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Bu=(Hu.prototype.Ii=function(t){this.Ai=t},Hu.prototype.Ri=function(t){this.bi=t},Hu.prototype.onMessage=function(t){this.vi=t},Hu.prototype.close=function(){this.Ti()},Hu.prototype.send=function(t){this.Ei(t)},Hu.prototype.Pi=function(){this.Ai()},Hu.prototype.Vi=function(t){this.bi(t)},Hu.prototype.Si=function(t){this.vi(t)},Hu),ju=(Ku.prototype.Ni=function(e,t,n,r){var i=this.xi(e,t);Pr("RestConnection","Sending: ",i,n);t={};return this.Fi(t,r),this.ki(e,i,t,n).then(function(t){return Pr("RestConnection","Received: ",t),t},function(t){throw xr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Ku.prototype.Oi=function(t,e,n,r){return this.Ni(t,e,n,r)},Ku.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.5.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},Ku.prototype.xi=function(t,e){t=qu[t];return this.Di+"/v1/"+e+":"+t},n(Gu,Mu=Ku),Gu.prototype.ki=function(o,e,s,a){return new Promise(function(n,r){var i=new Sr;i.listenOnce(wr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case br.NO_ERROR:var t=i.getResponseJson();Pr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case br.TIMEOUT:Pr("Connection",'RPC "'+o+'" timed out'),r(new Rr(Cr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var e=i.getStatus();Pr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Cr).indexOf(e)?e:Cr.UNKNOWN,r(new Rr(e,t.message))):r(new Rr(Cr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Rr(Cr.UNAVAILABLE,"Connection failed."));break;default:Vr()}}finally{Pr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(a);i.send(e,"POST",t,s,15)})},Gu.prototype.$i=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new pr,o=mr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Fi(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(h())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=h().indexOf("Electron/")||(0<=(n=h()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=h().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Pr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),a=!1,u=!1,c=new Bu({Ei:function(t){u?Pr("Connection","Not sending because WebChannel is closed:",t):(a||(Pr("Connection","Opening WebChannel transport."),s.open(),a=!0),Pr("Connection","WebChannel sending:",t),s.send(t))},Ti:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Ir.EventType.OPEN,function(){u||Pr("Connection","WebChannel transport opened.")}),t(s,Ir.EventType.CLOSE,function(){u||(u=!0,Pr("Connection","WebChannel transport closed"),c.Vi())}),t(s,Ir.EventType.ERROR,function(t){u||(u=!0,xr("Connection","WebChannel transport errored:",t),c.Vi(new Rr(Cr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Ir.EventType.MESSAGE,function(t){var e,n,r,i;u||(Ur(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Pr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=gs[r];if(void 0!==t)return Is(t)}(),i=n.message,void 0===t&&(t=Cr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,c.Vi(new Rr(t,i)),s.close()):(Pr("Connection","WebChannel received:",e),c.Si(e)))}),t(o,_r.STAT_EVENT,function(t){t.stat===Er?Pr("Connection","Detected buffering proxy"):t.stat===Tr&&Pr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Pi()},0),c},Gu);function Gu(t){var e=this;return(e=Mu.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.autoDetectLongPolling=t.autoDetectLongPolling,e}function Ku(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}function Hu(t){this.Ei=t.Ei,this.Ti=t.Ti}function Wu(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}function Qu(){}function zu(){this.li=new xu,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}function Yu(){this.activeTargetIds=Bs}function Xu(){return"undefined"!=typeof document?document:null}function Ju(t){return new ra(t,!0)}function $u(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.Or=new Map,this.$r=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return y(o,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return _c(this)?(Pr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return(e=n).$r.add(4),[4,dc(e)];case 1:return t.sent(),e.Br.set("Unknown"),e.$r.delete(4),[4,pc(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new sc(n,r)}var Zu,tc,ec,nc=(fc.prototype.reset=function(){this.qi=0},fc.prototype.Ki=function(){this.qi=this.Bi},fc.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);0<i&&Pr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Qi=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},fc.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},fc.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},fc.prototype.Wi=function(){return(Math.random()-.5)*this.qi},fc),T=(lc.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},lc.prototype.er=function(){return 2===this.state},lc.prototype.start=function(){3!==this.state?this.auth():this.nr()},lc.prototype.stop=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},lc.prototype.sr=function(){this.state=0,this.Zi.reset()},lc.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},lc.prototype.cr=function(t){this.ur(),this.stream.send(t)},lc.prototype.rr=function(){return y(this,void 0,void 0,function(){return g(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},lc.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},lc.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==e?this.Zi.reset():n&&n.code===Cr.RESOURCE_EXHAUSTED?(Mr(n.toString()),Mr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):n&&n.code===Cr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ri(n)];case 1:return t.sent(),[2]}})})},lc.prototype.ar=function(){},lc.prototype.auth=function(){var n=this;this.state=1;var t=this.hr(this.Yi),e=this.Yi;this.Ji.getToken().then(function(t){n.Yi===e&&n.lr(t)},function(e){t(function(){var t=new Rr(Cr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.dr(t)})})},lc.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},lc.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return y(t,void 0,void 0,function(){return g(this,function(t){return this.state=0,this.start(),[2]})})})},lc.prototype.dr=function(t){return Pr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},lc.prototype.hr=function(e){var n=this;return function(t){n.Se.enqueueAndForget(function(){return n.Yi===e?t():(Pr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},lc),rc=(n(hc,ec=T),hc.prototype.wr=function(t){return this.Hi.$i("Listen",t)},hc.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Vr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.I?(Ur(void 0===s||"string"==typeof s),ri.fromBase64String(s||"")):(Ur(void 0===s||s instanceof Uint8Array),ri.fromUint8Array(s||new Uint8Array))),o=(a=e.targetChange.cause)&&(u=void 0===(c=a).code?Cr.UNKNOWN:Is(c.code),new Rr(u,c.message||"")),s=new Ws(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime;var r=ha(t,n.document.name),i=sa(n.document.updateTime),a=new ki({mapValue:{fields:n.document.fields}}),u=(o=Li.newFoundDocument(r,i,a),n.targetIds||[]),c=n.removedTargetIds||[];s=new Ks(u,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=ha(t,n.document),i=n.readTime?sa(n.readTime):Hr.min(),a=Li.newNoDocument(r,i),o=n.removedTargetIds||[],s=new Ks([],o,a.key,a);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=ha(t,n.document),i=n.removedTargetIds||[],s=new Ks([],i,r,null);else{if(!("filter"in e))return Vr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new ys(n),i=e.targetId,s=new Hs(i,r)}return s}(this.R,t),t=function(t){if(!("targetChange"in t))return Hr.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?sa(t.readTime):Hr.min()}(t);return this.listener._r(e,t)},hc.prototype.mr=function(t){var e,n,r,i={};i.database=fa(this.R),i.addTarget=(e=this.R,(r=Ui(r=(n=t).target)?{documents:{documents:[la(e,r.path)]}}:{query:ga(e,r)}).targetId=n.targetId,0<n.resumeToken.approximateByteSize()?r.resumeToken=oa(e,n.resumeToken):0<n.snapshotVersion.compareTo(Hr.min())&&(r.readTime=ia(e,n.snapshotVersion.toTimestamp())),r);var o,t=(this.R,o=t,null==(t=function(){switch(o.purpose){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Vr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.cr(i)},hc.prototype.yr=function(t){var e={};e.database=fa(this.R),e.removeTarget=t,this.cr(e)},hc),ic=(n(cc,tc=T),Object.defineProperty(cc.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),cc.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,tc.prototype.start.call(this)},cc.prototype.ar=function(){this.gr&&this.Er([])},cc.prototype.wr=function(t){return this.Hi.$i("Write",t)},cc.prototype.onMessage=function(t){if(Ur(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Ur(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?sa(e.updateTime):sa(n)).isEqual(Hr.min())&&(t=sa(n)),new Zo(t,e.transformResults||[]);var e,n})):[]),n=sa(t.commitTime);return this.listener.Tr(n,e)}var n,r;return Ur(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},cc.prototype.Ar=function(){var t={};t.database=fa(this.R),this.cr(t)},cc.prototype.Er=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ya(e.R,t)})};this.cr(t)},cc),oc=(n(uc,Zu=function(){}),uc.prototype.br=function(){if(this.Rr)throw new Rr(Cr.FAILED_PRECONDITION,"The client has already been terminated.")},uc.prototype.Ni=function(e,n,r){var i=this;return this.br(),this.credentials.getToken().then(function(t){return i.Hi.Ni(e,n,r,t)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Cr.UNAUTHENTICATED&&i.credentials.invalidateToken(),t):new Rr(Cr.UNKNOWN,t.toString())})},uc.prototype.Oi=function(e,n,r){var i=this;return this.br(),this.credentials.getToken().then(function(t){return i.Hi.Oi(e,n,r,t)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Cr.UNAUTHENTICATED&&i.credentials.invalidateToken(),t):new Rr(Cr.UNKNOWN,t.toString())})},uc.prototype.terminate=function(){this.Rr=!0},uc),sc=(ac.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},ac.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,1<=this.vr&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},ac.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},ac.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},ac.prototype.Cr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Mr(t),this.Vr=!1):Pr("OnlineStateTracker",t)},ac.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},ac);function ac(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}function uc(t,e,n){var r=this;return(r=Zu.call(this)||this).credentials=t,r.Hi=e,r.R=n,r.Rr=!1,r}function cc(t,e,n,r,i){var o=this;return(o=tc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).R=r,o.gr=!1,o}function hc(t,e,n,r,i){var o=this;return(o=ec.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).R=r,o}function lc(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new nc(t,e)}function fc(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}function pc(r){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:if(!_c(r))return[3,4];e=0,n=r.Mr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function dc(r){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:e=0,n=r.Mr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function yc(t,e){t.Or.has(e.targetId)||(t.Or.set(e.targetId,e),wc(t)?bc(t):Cc(t).er()&&vc(t,e))}function gc(t,e){var n=t,t=Cc(n);n.Or.delete(e),t.er()&&mc(n,e),0===n.Or.size&&(t.er()?t.ir():_c(n)&&n.Br.set("Unknown"))}function vc(t,e){t.qr.U(e.targetId),Cc(t).mr(e)}function mc(t,e){t.qr.U(e),Cc(t).yr(e)}function bc(e){e.qr=new zs({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},lt:function(t){return e.Or.get(t)||null}}),Cc(e).start(),e.Br.Sr()}function wc(t){return _c(t)&&!Cc(t).tr()&&0<t.Or.size}function _c(t){return 0===t.$r.size}function Ec(t){t.qr=void 0}function Tc(s,a,u){return y(this,void 0,void 0,function(){var n,o;return g(this,function(t){switch(t.label){case 0:if(s.Br.set("Online"),!(a instanceof Ws&&2===a.state&&a.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Or.has(i)?[4,o.remoteSyncer.rejectListen(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Or.delete(i),o.qr.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,a)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Pr("RemoteStore","Failed to remove targets %s: %s ",a.targetIds.join(","),n),[4,Ic(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(a instanceof Ks?s.qr.X(a):a instanceof Hs?s.qr.rt(a):s.qr.et(a),u.isEqual(Hr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,ou(s.localStore)];case 8:return o=t.sent(),0<=u.compareTo(o)?[4,(i=u,(e=(r=s).qr.ut(i)).targetChanges.forEach(function(t,e){var n;0<t.resumeToken.approximateByteSize()&&((n=r.Or.get(e))&&r.Or.set(e,n.withResumeToken(t.resumeToken,i)))}),e.targetMismatches.forEach(function(t){var e=r.Or.get(t);e&&(r.Or.set(t,e.withResumeToken(ri.EMPTY_BYTE_STRING,e.snapshotVersion)),mc(r,t),e=new La(e.target,t,1,e.sequenceNumber),vc(r,e))}),r.remoteSyncer.applyRemoteEvent(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Pr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Ic(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Ic(n,r,i){return y(this,void 0,void 0,function(){var e=this;return g(this,function(t){switch(t.label){case 0:if(!Ca(r))throw r;return n.$r.add(1),[4,dc(n)];case 1:return t.sent(),n.Br.set("Offline"),i=i||function(){return ou(n.localStore)},n.asyncQueue.enqueueRetryable(function(){return y(e,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return Pr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.$r.delete(1),[4,pc(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Sc(e,n){return n().catch(function(t){return Ic(e,t,n)})}function Ac(u){return y(this,void 0,void 0,function(){var i,o,s,a;return g(this,function(t){switch(t.label){case 0:o=Rc(i=u),s=0<i.kr.length?i.kr[i.kr.length-1].batchId:-1,t.label=1;case 1:if(!(_c(i)&&i.kr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.localStore,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r._n.getNextMutationBatchAfterBatchId(t,n)}))];case 3:return null===(a=t.sent())?(0===i.kr.length&&o.ir(),[3,7]):(s=a.batchId,function(t,e){t.kr.push(e);t=Rc(t);t.er()&&t.pr&&t.Er(e.mutations)}(i,a),[3,6]);case 4:return a=t.sent(),[4,Ic(i,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Nc(i)&&Dc(i),[2]}var e,n,r})})}function Nc(t){return _c(t)&&!Rc(t).tr()&&0<t.kr.length}function Dc(t){Rc(t).start()}function Cc(n){var t,e,r,i=this;return n.Ur||(n.Ur=(t=n.datastore,e=n.asyncQueue,r={Ii:function(n){return y(this,void 0,void 0,function(){return g(this,function(t){return n.Or.forEach(function(t,e){vc(n,t)}),[2]})})}.bind(null,n),Ri:function(e,n){return y(this,void 0,void 0,function(){return g(this,function(t){return Ec(e),wc(e)?(e.Br.Nr(n),bc(e)):e.Br.set("Unknown"),[2]})})}.bind(null,n),_r:Tc.bind(null,n)},t.br(),new rc(e,t.Hi,t.credentials,t.R,r)),n.Mr.push(function(e){return y(i,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e?(n.Ur.sr(),wc(n)?bc(n):n.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Ur.stop()];case 2:t.sent(),Ec(n),t.label=3;case 3:return[2]}})})})),n.Ur}function Rc(n){var t,e,r,i=this;return n.Qr||(n.Qr=(t=n.datastore,e=n.asyncQueue,r={Ii:function(e){return y(this,void 0,void 0,function(){return g(this,function(t){return Rc(e).Ar(),[2]})})}.bind(null,n),Ri:function(e,n){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return n&&Rc(e).pr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return Ts(n=i.code)&&n!==Cr.ABORTED?(e=r.kr.shift(),Rc(r).sr(),[4,Sc(r,function(){return r.remoteSyncer.rejectFailedWrite(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Ac(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Nc(e)&&Dc(e),[2]}})})}.bind(null,n),Ir:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){for(e=Rc(o),n=0,r=o.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]})})}.bind(null,n),Tr:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return e=r.kr.shift(),n=Oa.from(e,i,o),[4,Sc(r,function(){return r.remoteSyncer.applySuccessfulWrite(n)})];case 1:return t.sent(),[4,Ac(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.br(),new ic(e,t.Hi,t.credentials,t.R,r)),n.Mr.push(function(e){return y(i,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e?(n.Qr.sr(),[4,Ac(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Qr.stop()];case 3:t.sent(),0<n.kr.length&&(Pr("RemoteStore","Stopping write stream with "+n.kr.length+" pending writes"),n.kr=[]),t.label=4;case 4:return[2]}})})})),n.Qr}var kc=(Oc.createAndSchedule=function(t,e,n,r,i){i=new Oc(t,e,Date.now()+n,r,i);return i.start(n),i},Oc.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},Oc.prototype.skipDelay=function(){return this.handleDelayElapsed()},Oc.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Rr(Cr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Oc.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})},Oc.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},Oc);function Oc(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Sa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}function Lc(t,e){if(Mr("AsyncQueue",e+": "+t),Ca(t))return new Rr(Cr.UNAVAILABLE,e+": "+t);throw t}function Pc(){this.queries=new Wa(Do,No),this.onlineState="Unknown",this.Gr=new Set}var Mc=(Bc.emptySet=function(t){return new Bc(t.comparator)},Bc.prototype.has=function(t){return null!=this.keyedMap.get(t)},Bc.prototype.get=function(t){return this.keyedMap.get(t)},Bc.prototype.first=function(){return this.sortedSet.minKey()},Bc.prototype.last=function(){return this.sortedSet.maxKey()},Bc.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},Bc.prototype.indexOf=function(t){t=this.keyedMap.get(t);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(Bc.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),Bc.prototype.forEach=function(n){this.sortedSet.inorderTraversal(function(t,e){return n(t),!1})},Bc.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},Bc.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},Bc.prototype.isEqual=function(t){if(!(t instanceof Bc))return!1;if(this.size!==t.size)return!1;for(var e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();e.hasNext();){var r=e.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0},Bc.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Bc.prototype.copy=function(t,e){var n=new Bc;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n},Bc),xc=(qc.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);!n||0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):Vr()},qc.prototype.jr=function(){var n=[];return this.Kr.inorderTraversal(function(t,e){n.push(e)}),n},qc),Fc=(Uc.fromInitialDocuments=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Uc(t,e,Mc.emptySet(e),i,n,r,!0,!1)},Object.defineProperty(Uc.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),Uc.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&No(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Uc),Vc=function(){this.Wr=void 0,this.listeners=[]};function Uc(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}function qc(){this.Kr=new Ss(vi.comparator)}function Bc(n){this.comparator=n?function(t,e){return n(t,e)||vi.comparator(t.key,e.key)}:function(t,e){return vi.comparator(t.key,e.key)},this.keyedMap=Fs,this.sortedSet=new Ss(this.comparator)}function jc(s,a){return y(this,void 0,void 0,function(){var e,n,r,i,o;return g(this,function(t){switch(t.label){case 0:if(e=s,n=a.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Vc),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.onListen(n)];case 2:return o.Wr=t.sent(),[3,4];case 3:return o=t.sent(),o=Lc(o,"Initialization of query '"+Co(a.query)+"' failed"),[2,void a.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(a),a.zr(e.onlineState),i.Wr&&a.Hr(i.Wr)&&Kc(e),[2]}})})}function Gc(s,a){return y(this,void 0,void 0,function(){var e,n,r,i,o;return g(this,function(t){return e=s,n=a.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(a))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.onUnlisten(n))]:[2]})})}function Kc(t){t.Gr.forEach(function(t){t.next()})}var Hc=($c.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Fc(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},$c.prototype.onError=function(t){this.Jr.error(t)},$c.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},$c.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},$c.prototype.Zr=function(t){if(0<t.docChanges.length)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},$c.prototype.no=function(t){t=Fc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},$c),Wc=(Jc.prototype.io=function(){return"metadata"in this.payload},Jc),Qc=(Xc.prototype.qn=function(t){return ha(this.R,t)},Xc.prototype.Un=function(t){return t.metadata.exists?(e=this.R,n=t.document,r=ha(e,n.name),e=sa(n.updateTime),n=new ki({mapValue:{fields:n.fields}}),n=Li.newFoundDocument(r,e,n)):Li.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime));var e,n,r},Xc.prototype.Qn=sa,Xc),zc=(Yc.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Yc.prototype.co=function(t){for(var e=new Map,n=new Qc(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||qs()).add(s);e.set(c,h)}}return e},Yc.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){switch(t.label){case 0:return[4,function(l,f,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,a,u,c,h;return g(this,function(t){switch(t.label){case 0:for(n=l,r=qs(),i=Ps,o=Vs,e=0,s=p;e<s.length;e++)a=s[e],u=f.qn(a.metadata.name),a.document&&(r=r.add(u)),i=i.insert(u,f.Un(a)),o=o.insert(u,f.Qn(a.metadata.readTime));return c=n.$n.newChangeBuffer({trackRemovals:!0}),[4,uu(n,So(mo(Zr.fromString("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return au(e,c,i,Hr.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.qe.removeMatchingKeysForTargetId(e,h.targetId).next(function(){return n.qe.addMatchingKeys(e,r,h.targetId)}).next(function(){return n.Mn.En(e,t)}).next(function(){return t})})})]}})})}(this.localStore,new Qc(this.R),this.documents,this.ro.id)];case 1:e=t.sent(),n=this.co(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=qs()),y(this,void 0,void 0,function(){var n,r;return g(this,function(t){switch(t.label){case 0:return[4,uu(e,So(Fa(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=sa(i.readTime);if(0<=n.snapshotVersion.compareTo(e))return r.Qe.saveNamedQuery(t,i);e=n.withResumeToken(ri.EMPTY_BYTE_STRING,e);return r.Fn=r.Fn.insert(e.targetId,e),r.qe.updateTargetData(t,e).next(function(){return r.qe.removeMatchingKeysForTargetId(t,n.targetId)}).next(function(){return r.qe.addMatchingKeys(t,o,n.targetId)}).next(function(){return r.Qe.saveNamedQuery(t,i)})})]}})})}(this.localStore,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Ha(Object.assign({},this.progress),e))]}})})},Yc);function Yc(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=Zc(t)}function Xc(t){this.R=t}function Jc(t,e){this.payload=t,this.byteLength=e}function $c(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}function Zc(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var th=function(t){this.key=t},eh=function(t){this.key=t},nh=(Object.defineProperty(ah.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),ah.prototype._o=function(t,e){var s=this,a=e?e.mo:new xc,u=(e||this).fo,c=(e||this).mutatedKeys,h=u,l=!1,f=bo(this.query)&&u.size===this.query.limit?u.last():null,p=wo(this.query)&&u.size===this.query.limit?u.first():null;if(t.inorderTraversal(function(t,e){var n=u.get(t),r=Ro(s.query,e)?e:null,i=!!n&&s.mutatedKeys.has(n.key),o=!!r&&(r.hasLocalMutations||s.mutatedKeys.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data.isEqual(r.data)?i!==o&&(a.track({type:3,doc:r}),e=!0):s.yo(n,r)||(a.track({type:2,doc:r}),e=!0,(f&&0<s.lo(r,f)||p&&s.lo(r,p)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),e=!0):n&&!r&&(a.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),bo(this.query)||wo(this.query))for(;h.size>this.query.limit;){var n=bo(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{fo:h,mo:a,Nn:l,mutatedKeys:c}},ah.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},ah.prototype.applyChanges=function(t,e,n){var o=this,r=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var i=t.mo.jr();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.lo(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vr()}}var r,i}),this.po(n);var s=e?this.Eo():[],n=0===this.ho.size&&this.current?1:0,e=n!==this.ao;return this.ao=n,0!==i.length||e?{snapshot:new Fc(this.query,t.fo,r,i,t.mutatedKeys,0==n,e,!1),To:s}:{To:s}},ah.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new xc,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},ah.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},ah.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},ah.prototype.Eo=function(){var e=this;if(!this.current)return[];var n=this.ho;this.ho=qs(),this.fo.forEach(function(t){e.Io(t.key)&&(e.ho=e.ho.add(t.key))});var r=[];return n.forEach(function(t){e.ho.has(t)||r.push(new eh(t))}),this.ho.forEach(function(t){n.has(t)||r.push(new th(t))}),r},ah.prototype.Ao=function(t){this.uo=t.Bn,this.ho=qs();t=this._o(t.documents);return this.applyChanges(t,!0)},ah.prototype.Ro=function(){return Fc.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},ah),rh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ih=function(t){this.key=t,this.bo=!1},oh=(Object.defineProperty(sh.prototype,"isPrimaryClient",{get:function(){return!0===this.Oo},enumerable:!1,configurable:!0}),sh);function sh(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Wa(Do,No),this.Vo=new Map,this.So=new Set,this.Do=new Ss(vi.comparator),this.Co=new Map,this.No=new du,this.xo={},this.Fo=new Map,this.ko=qa.Yt(),this.onlineState="Unknown",this.Oo=void 0}function ah(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=qs(),this.mutatedKeys=qs(),this.lo=ko(t),this.fo=new Mc(this.lo)}function uh(a,u){return y(this,void 0,void 0,function(){var n,r,i,o,s;return g(this,function(t){switch(t.label){case 0:return(e=a).remoteStore.remoteSyncer.applyRemoteEvent=hh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=function(t,e){var n=t,t=n.Co.get(e);if(t&&t.bo)return qs().add(t.key);var r=qs(),e=n.Vo.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Po.get(s);r=r.unionWith(s.view.wo)}return r}.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=function(o,s,a){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){switch(t.label){case 0:return(e=o).sharedClientState.updateQueryState(s,"rejected",a),i=e.Co.get(s),(n=i&&i.key)?(r=(r=new Ss(vi.comparator)).insert(n,Li.newNoDocument(n,Hr.min())),i=qs().add(n),i=new js(Hr.min(),new Map,new Os(jr),r,i),[4,hh(e,i)]):[3,2];case 1:return t.sent(),e.Do=e.Do.remove(n),e.Co.delete(s),mh(e),[3,4];case 2:return[4,cu(e.localStore,s,!1).then(function(){return yh(e,s,a)}).catch(Ka)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.vo._r=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,a=n.queries.get(a);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&Kc(n)}.bind(null,e.eventManager),e.vo.Mo=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.eventManager),(s=(n=e).Po.get(u))?(r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Ro(),[3,4]):[3,1];case 1:return[4,uu(n.localStore,So(u))];case 2:return o=t.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),r=o.targetId,[4,function(i,o,s,a){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return i.$o=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return(e=i.view._o(o)).Nn?[4,hu(r.localStore,i.query,!1).then(function(t){t=t.documents;return i.view._o(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.targetChanges.get(i.targetId),n=i.view.applyChanges(e,r.isPrimaryClient,n),[2,(vh(r,i.targetId,n.To),n.snapshot)]}})})}(i,t,e,n)},[4,hu(i.localStore,o,!0)];case 1:return n=t.sent(),r=new nh(o,n.Bn),e=r._o(n.documents),n=Gs.createSynthesizedTargetChangeForCurrentChange(s,a&&"Offline"!==i.onlineState),n=r.applyChanges(e,i.isPrimaryClient,n),vh(i,s,n.To),r=new rh(o,s,r),[2,(i.Po.set(o,r),i.Vo.has(s)?i.Vo.get(s).push(o):i.Vo.set(s,[o]),n.snapshot)]}})})}(n,u,r,"current"===s)];case 3:i=t.sent(),n.isPrimaryClient&&yc(n.remoteStore,o),t.label=4;case 4:return[2,i]}var e})})}function ch(f,p,d){return y(this,void 0,void 0,function(){var s,l;return g(this,function(t){switch(t.label){case 0:(o=f).remoteStore.remoteSyncer.applySuccessfulWrite=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,iu(e.localStore,o)];case 2:return r=t.sent(),dh(e,n,null),ph(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),[4,bh(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Ka(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.remoteStore.remoteSyncer.rejectFailedWrite=function(s,a,u){return y(this,void 0,void 0,function(){var n,o;return g(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.localStore,r=a,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i._n.lookupMutationBatch(e,r).next(function(t){return Ur(null!==t),n=t.keys(),i._n.removeMutationBatch(e,t)}).next(function(){return i._n.performConsistencyCheck(e)}).next(function(){return i.Mn.pn(e,n)})}))];case 2:return o=t.sent(),dh(n,a,u),ph(n,a),n.sharedClientState.updateMutationState(a,"rejected",u),[4,bh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Ka(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),l=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=l.localStore,a=p,c=r,h=Kr.now(),i=a.reduce(function(t,e){return t.add(e.key)},qs()),c.persistence.runTransaction("Locally write mutations","readwrite",function(s){return c.Mn.pn(s,i).next(function(t){u=t;for(var e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),s=Mo(o.transform,s||null);null!=s&&(n=null==n?ki.empty():n).set(o.field,s)}return n||null}(i,u.get(i.key));null!=o&&e.push(new cs(i.key,o,function s(t){var a=[];return Yr(t.fields||{},function(t,e){var n=new ei([t]);if(Ri(e))if(0===(e=s(e.mapValue).fields).length)a.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];a.push(n.child(o))}else a.push(n)}),new ni(a)}(o.toProto().mapValue),ts.exists(!0)))}return c._n.addMutationBatch(s,h,e,a)})}).then(function(t){return t.applyToLocalDocumentSet(u),{batchId:t.batchId,changes:u}}))];case 2:return s=t.sent(),l.sharedClientState.addPendingMutation(s.batchId),e=l,n=s.batchId,o=d,r=(r=(r=e.xo[e.currentUser.toKey()])||new Ss(jr)).insert(n,o),e.xo[e.currentUser.toKey()]=r,[4,bh(l,s.changes)];case 3:return t.sent(),[4,Ac(l.remoteStore)];case 4:return t.sent(),[3,6];case 5:return l=t.sent(),l=Lc(l,"Failed to persist write"),d.reject(l),[3,6];case 6:return[2]}var e,n,r,a,u,c,h,i,o})})}function hh(r,i){return y(this,void 0,void 0,function(){var n,e;return g(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,su(n.localStore,i)];case 2:return e=t.sent(),i.targetChanges.forEach(function(t,e){e=n.Co.get(e);e&&(Ur(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),0<t.addedDocuments.size?e.bo=!0:0<t.modifiedDocuments.size?Ur(e.bo):0<t.removedDocuments.size&&(Ur(e.bo),e.bo=!1))}),[4,bh(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Ka(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function lh(t,n,e){var r,t=t;(t.isPrimaryClient&&0===e||!t.isPrimaryClient&&1===e)&&(r=[],t.Po.forEach(function(t,e){e=e.view.zr(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].zr(i)&&(o=!0)}),o&&Kc(t)}(t.eventManager,n),r.length&&t.vo._r(r),t.onlineState=n,t.isPrimaryClient&&t.sharedClientState.setOnlineState(n))}function fh(o,s){return y(this,void 0,void 0,function(){var n,r,i;return g(this,function(t){switch(t.label){case 0:_c((n=o).remoteStore)||Pr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.localStore).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Fo.get(r)||[]).push(s),n.Fo.set(r,i),[3,4]);case 3:return i=t.sent(),i=Lc(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function ph(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function dh(t,e,n){var r=t,i=r.xo[r.currentUser.toKey()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i)}function yh(e,t,n){void 0===n&&(n=null),e.sharedClientState.removeLocalQueryTarget(t);for(var r=0,i=e.Vo.get(t);r<i.length;r++){var o=i[r];e.Po.delete(o),n&&e.vo.Mo(o,n)}e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach(function(t){e.No.containsKey(t)||gh(e,t)})}function gh(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(gc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),mh(t))}function vh(t,e,n){for(var r,i,o,s=0,a=n;s<a.length;s++){var u=a[s];u instanceof th?(t.No.addReference(u.key,e),r=t,o=void 0,i=(o=(i=u).key).path.canonicalString(),r.Do.get(o)||r.So.has(i)||(Pr("SyncEngine","New document in limbo: "+o),r.So.add(i),mh(r))):u instanceof eh?(Pr("SyncEngine","Document no longer in limbo: "+u.key),t.No.removeReference(u.key,e),t.No.containsKey(u.key)||gh(t,u.key)):Vr()}}function mh(t){for(;0<t.So.size&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new vi(Zr.fromString(e)),e=t.ko.next();t.Co.set(e,new ih(n)),t.Do=t.Do.insert(n,e),yc(t.remoteStore,new La(So(mo(n.path)),e,2,Ar.o))}}function bh(e,s,a){return y(this,void 0,void 0,function(){var n,r,i,o;return g(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Po.isEmpty()?[3,3]:(n.Po.forEach(function(t,e){o.push(n.$o(e,s,a).then(function(t){t&&(n.isPrimaryClient&&n.sharedClientState.updateQueryState(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=za.Pn(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.vo._r(r),[4,function(u,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,a;return g(this,function(t){switch(t.label){case 0:r=u,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Aa.forEach(c,function(e){return Aa.forEach(e.bn,function(t){return r.persistence.referenceDelegate.addReference(n,e.targetId,t)}).next(function(){return Aa.forEach(e.vn,function(t){return r.persistence.referenceDelegate.removeReference(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ca(e=t.sent()))throw e;return Pr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)a=i[n],o=a.targetId,a.fromCache||(s=r.Fn.get(o),a=s.snapshotVersion,a=s.withLastLimboFreeSnapshotVersion(a),r.Fn=r.Fn.insert(o,a));return[2]}})})}(n.localStore,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function wh(i,o){return y(this,void 0,void 0,function(){var n,r;return g(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Pr("SyncEngine","User change. New user:",o.toKey()),[4,ru(n.localStore,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Fo.forEach(function(t){t.forEach(function(t){t.reject(new Rr(Cr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Fo.clear(),n.sharedClientState.handleUserChange(o,r.removedBatchIds,r.addedBatchIds),[4,bh(n,r.Ln)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function _h(t,e,n){var r=t;!function(f,p,d){return y(this,void 0,void 0,function(){var a,u,c,h,l;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return a=t.sent(),[4,(r=f.localStore,o=r,s=sa((i=a).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Qe.getBundleMetadata(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.compareTo(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d._completeWith({taskState:"Success",documentsLoaded:a.totalDocuments,bytesLoaded:a.totalBytes,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}))];case 4:return d._updateProgress(Zc(a)),u=new zc(a,f.localStore,p.R),[4,p.Lo()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,u.oo(c)]:[3,10];case 7:return(h=t.sent())&&d._updateProgress(h),[4,p.Lo()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,u.complete()];case 11:return l=t.sent(),[4,bh(f,l.wn,void 0)];case 12:return t.sent(),[4,(r=f.localStore,e=a,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Qe.saveBundleMetadata(t,e)}))];case 13:return t.sent(),d._completeWith(l.progress),[3,15];case 14:return xr("SyncEngine","Loading bundle failed with "+(l=t.sent())),d._failWith(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})}(r,e,n).then(function(){r.sharedClientState.notifyBundleLoaded()})}var Eh=(Sh.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.R=Ju(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.qo(e),[4,this.persistence.start()];case 1:return t.sent(),this.gcScheduler=this.Uo(e),this.localStore=this.Qo(e),[2]}})})},Sh.prototype.Uo=function(t){return null},Sh.prototype.Qo=function(t){return e=this.persistence,n=new Ya,r=t.initialUser,t=this.R,new Xa(e,n,r,t);var e,n,r},Sh.prototype.qo=function(t){return new wu(Eu.bs,this.R)},Sh.prototype.Bo=function(t){return new Fu},Sh.prototype.terminate=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},Sh),Th=(Ih.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return g(this,function(t){switch(t.label){case 0:return this.localStore?[3,2]:(this.localStore=n.localStore,this.sharedClientState=n.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!n.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return lh(e.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=wh.bind(null,this.syncEngine),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=n,r?(e.$r.delete(2),[4,pc(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.$r.add(2),[4,dc(e)]);case 3:t.sent(),e.Br.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ih.prototype.createEventManager=function(t){return new Pc},Ih.prototype.createDatastore=function(t){var e=Ju(t.databaseInfo.databaseId),n=(n=t.databaseInfo,new ju(n));return t=t.credentials,new oc(t,n,e)},Ih.prototype.createRemoteStore=function(t){var e=this,n=this.localStore,r=this.datastore,i=t.asyncQueue,o=function(t){return lh(e.syncEngine,t,0)},t=new(Uu.yt()?Uu:Vu);return new $u(n,r,i,o,t)},Ih.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){o=new oh(t,e,n,r,i,o);return s&&(o.Oo=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},Ih.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=n,Pr("RemoteStore","RemoteStore shutting down."),e.$r.add(5),[4,dc(e)];case 1:return t.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},Ih);function Ih(){}function Sh(){this.synchronizeTabs=!1}function Ah(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return g(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return g(this,function(t){return[2]})})},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var Nh=(xh.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},xh.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},xh.prototype.Wo=function(){this.muted=!0},xh.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},xh),Dh=(Mh.prototype.close=function(){return this.Go.cancel()},Mh.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return g(this,function(t){return[2,this.metadata.promise]})})},Mh.prototype.Lo=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},Mh.prototype.Ho=function(){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return[4,this.Jo()];case 1:return null===(e=t.sent())?[2,null]:(r=this.zo.decode(e),n=Number(r),isNaN(n)&&this.Yo("length string ("+r+") is not valid number"),[4,this.Xo(n)]);case 2:return r=t.sent(),[2,new Wc(JSON.parse(r),e.length+n)]}})})},Mh.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Mh.prototype.Jo=function(){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Mh.prototype.Xo=function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.tc()]:[3,3];case 1:t.sent()&&this.Yo("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Mh.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},Mh.prototype.tc=function(){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return[4,this.Go.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Mh),Ch=(Ph.prototype.lookup=function(r){return y(this,void 0,void 0,function(){var e,n=this;return g(this,function(t){switch(t.label){case 0:if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new Rr(Cr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,a){return y(this,void 0,void 0,function(){var n,e,r,i,o;return g(this,function(t){switch(t.label){case 0:return e=fa((n=s).R)+"/documents",r={documents:a.map(function(t){return ca(n.R,t)})},[4,n.Oi("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.R,"found"in(t=t)?function(t,e){Ur(!!e.found),e.found.name,e.found.updateTime;var n=ha(t,e.found.name),t=sa(e.found.updateTime),e=new ki({mapValue:{fields:e.found.fields}});return Li.newFoundDocument(n,t,e)}(e,t):"missing"in t?function(t,e){Ur(!!e.missing),Ur(!!e.readTime);t=ha(t,e.missing),e=sa(e.readTime);return Li.newNoDocument(t,e)}(e,t):Vr());i.set(t.key.toString(),t)}),o=[],[2,(a.forEach(function(t){t=i.get(t.toString());Ur(!!t),o.push(t)}),o)]}})})}(this.datastore,r)];case 1:return[2,((e=t.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},Ph.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},Ph.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},Ph.prototype.delete=function(t){this.write(new bs(t,this.precondition(t))),this.writtenDocs.add(t.toString())},Ph.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return g(this,function(t){switch(t.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return e=this.readVersions,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=vi.fromPath(e);n.mutations.push(new ws(e,n.precondition(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return n=fa((e=i).R)+"/documents",r={writes:o.map(function(t){return ya(e.R,t)})},[4,e.Ni("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return t.sent(),this.committed=!0,[2]}})})},Ph.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Vr();e=Hr.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Rr(Cr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},Ph.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?ts.updateTime(e):ts.none()},Ph.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(this.writtenDocs.has(t.toString())||!e)return ts.exists(!0);if(e.isEqual(Hr.min()))throw new Rr(Cr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ts.updateTime(e)},Ph.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},Ph.prototype.ensureCommitNotCalled=function(){},Ph),Rh=(Lh.prototype.run=function(){this.nc()},Lh.prototype.nc=function(){var t=this;this.Zi.ji(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return g(this,function(t){return e=new Ch(this.datastore),(n=this.sc(e))&&n.then(function(t){r.asyncQueue.enqueueAndForget(function(){return e.commit().then(function(){r.deferred.resolve(t)}).catch(function(t){r.ic(t)})})}).catch(function(t){r.ic(t)}),[2]})})})},Lh.prototype.sc=function(t){try{var e=this.updateFunction(t);return!yi(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},Lh.prototype.ic=function(t){var e=this;0<this.ec&&this.rc(t)?(--this.ec,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},Lh.prototype.rc=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Ts(t)},Lh),kh=(Oh.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,this.receivedInitialUser.promise];case 1:return[2,(t.sent(),{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100})]}})})},Oh.prototype.setCredentialChangeListener=function(t){var e=this;this.credentialListener=t,this.receivedInitialUser.promise.then(function(){return e.credentialListener(e.user)})},Oh.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Rr(Cr.FAILED_PRECONDITION,"The client has already been terminated.")},Oh.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var n=new Sa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.removeChangeListener(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Lc(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Oh);function Oh(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Tu.UNAUTHENTICATED,this.clientId=qr.u(),this.credentialListener=function(){},this.receivedInitialUser=new Sa,this.credentials.setChangeListener(function(t){Pr("FirestoreClient","Received user=",t.uid),r.user=t,r.credentialListener(t),r.receivedInitialUser.resolve()})}function Lh(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new nc(this.asyncQueue,"transaction_retry")}function Ph(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}function Mh(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Sa,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function xh(t){this.observer=t,this.muted=!1}function Fh(e){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e.offlineComponents?[3,2]:(Pr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return g(this,function(t){switch(t.label){case 0:return i.asyncQueue.verifyOperationInProgress(),Pr("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.initialUser,i.setCredentialChangeListener(function(e){n.isEqual(e)||(n=e,i.asyncQueue.enqueueRetryable(function(){return y(r,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,ru(o.localStore,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.setDatabaseDeletedListener(function(){return i.terminate()}),i.offlineComponents=o,[2]}})})}(e,new Eh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.offlineComponents]}})})}function Vh(e){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e.onlineComponents?[3,2]:(Pr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return r.asyncQueue.verifyOperationInProgress(),[4,Fh(r)];case 1:return e=t.sent(),Pr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.setCredentialChangeListener(function(t){return r.asyncQueue.enqueueRetryable(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return(e=r).asyncQueue.verifyOperationInProgress(),Pr("RemoteStore","RemoteStore received new credentials"),n=_c(e),e.$r.add(3),[4,dc(e)];case 1:return t.sent(),n&&e.Br.set("Unknown"),[4,e.remoteSyncer.handleCredentialChange(i)];case 2:return t.sent(),e.$r.delete(3),[4,pc(e)];case 3:return t.sent(),[2]}})})}(i.remoteStore,t)})}),r.onlineComponents=i,[2]}})})}(e,new Th)]);case 1:t.sent(),t.label=2;case 2:return[2,e.onlineComponents]}})})}function Uh(t){return Fh(t).then(function(t){return t.persistence})}function qh(t){return Fh(t).then(function(t){return t.localStore})}function Bh(t){return Vh(t).then(function(t){return t.remoteStore})}function jh(t){return Vh(t).then(function(t){return t.syncEngine})}function Gh(r){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return[4,Vh(r)];case 1:return e=t.sent(),[2,((n=e.eventManager).onListen=uh.bind(null,e.syncEngine),n.onUnlisten=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return n=(e=i).Po.get(o),1<(r=e.Vo.get(n.targetId)).length?[2,(e.Vo.set(n.targetId,r.filter(function(t){return!No(t,o)})),void e.Po.delete(o))]:e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)?[3,2]:[4,cu(e.localStore,n.targetId,!1).then(function(){e.sharedClientState.clearQueryState(n.targetId),gc(e.remoteStore,n.targetId),yh(e,n.targetId)}).catch(Ka)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return yh(e,n.targetId),[4,cu(e.localStore,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.syncEngine),n)]}})})}function Kh(n,r,i){var t=this;void 0===i&&(i={});var o=new Sa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Nh({next:function(t){r.enqueueAndForget(function(){return Gc(n,a)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Rr(Cr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Rr(Cr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),a=new Hc(mo(i.path),t,{includeMetadataChanges:!0,so:!0});return jc(n,a)},[4,Gh(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.asyncQueue,r,i,o])]}})})}),o.promise}function Hh(n,r,i){var t=this;void 0===i&&(i={});var o=new Sa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Nh({next:function(t){n.enqueueAndForget(function(){return Gc(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Rr(Cr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Hc(t,o,{includeMetadataChanges:!0,so:!0});return jc(e,s)},[4,Gh(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.asyncQueue,r,i,o])]}})})}),o.promise}function Wh(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t}var Qh=function(t,e,n,r,i,o,s){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s},zh=(Object.defineProperty(sl.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),sl.prototype.isEqual=function(t){return t instanceof sl&&t.projectId===this.projectId&&t.database===this.database},sl),Yh=new Map,Xh=(ol.prototype.getToken=function(){return Promise.resolve(null)},ol.prototype.invalidateToken=function(){},ol.prototype.setChangeListener=function(t){(this.changeListener=t)(Tu.UNAUTHENTICATED)},ol.prototype.removeChangeListener=function(){this.changeListener=null},ol),Jh=(il.prototype.getToken=function(){return Promise.resolve(this.token)},il.prototype.invalidateToken=function(){},il.prototype.setChangeListener=function(t){(this.changeListener=t)(this.token.user)},il.prototype.removeChangeListener=function(){this.changeListener=null},il),$h=(rl.prototype.getToken=function(){var e=this,n=this.cc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.cc!==n?(Pr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ur("string"==typeof t.accessToken),new Wh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},rl.prototype.invalidateToken=function(){this.forceRefresh=!0},rl.prototype.setChangeListener=function(t){this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},rl.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.oc),this.oc=null,this.changeListener=null},rl.prototype.uc=function(){var t=this.auth&&this.auth.getUid();return Ur(null===t||"string"==typeof t),new Tu(t)},rl),Zh=(Object.defineProperty(nl.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.hc},e=this.ac.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.lc&&(t["X-Goog-Iam-Authorization-Token"]=this.lc),t},enumerable:!1,configurable:!0}),nl),tl=(el.prototype.getToken=function(){return Promise.resolve(new Zh(this.ac,this.hc,this.lc))},el.prototype.setChangeListener=function(t){t(Tu.FIRST_PARTY)},el.prototype.removeChangeListener=function(){},el.prototype.invalidateToken=function(){},el);function el(t,e,n){this.ac=t,this.hc=e,this.lc=n}function nl(t,e,n){this.ac=t,this.hc=e,this.lc=n,this.type="FirstParty",this.user=Tu.FIRST_PARTY}function rl(t){var e=this;this.oc=null,this.currentUser=Tu.UNAUTHENTICATED,this.receivedInitialUser=!1,this.cc=0,this.changeListener=null,this.forceRefresh=!1,this.oc=function(){e.cc++,e.currentUser=e.uc(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.cc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.oc):(this.oc(null),t.get().then(function(t){e.auth=t,e.oc&&e.auth.addAuthTokenListener(e.oc)},function(){}))}function il(t){this.token=t,this.changeListener=null}function ol(){this.changeListener=null}function sl(t,e){this.projectId=t,this.database=e||"(default)"}function al(t,e,n){if(!n)throw new Rr(Cr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function ul(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function cl(t,e,n,r){if(!0===e&&!0===r)throw new Rr(Cr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function hl(t){if(!vi.isDocumentKey(t))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function ll(t){if(vi.isDocumentKey(t))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function fl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Vr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function pl(t,e){if((t="_delegate"in t?t._delegate:t)instanceof e)return t;if(e.name===t.constructor.name)throw new Rr(Cr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=fl(t);throw new Rr(Cr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function dl(t,e){if(e<=0)throw new Rr(Cr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var yl,gl=(Sl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Sl),vl=(Object.defineProperty(Il.prototype,"app",{get:function(){if(!this._app)throw new Rr(Cr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(Il.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(Il.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),Il.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Rr(Cr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gl(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Xh;switch(t.type){case"gapi":var e=t.client;return Ur(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new tl(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Rr(Cr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Il.prototype._getSettings=function(){return this._settings},Il.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},Il.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},Il.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},Il.prototype._terminate=function(){return(t=Yh.get(this))&&(Pr("ComponentProvider","Removing Datastore"),Yh.delete(this),t.terminate()),Promise.resolve();var t},Il),ml=(Object.defineProperty(Tl.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(Tl.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(Tl.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(Tl.prototype,"parent",{get:function(){return new wl(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),Tl.prototype.withConverter=function(t){return new Tl(this.firestore,t,this._key)},Tl),bl=(El.prototype.withConverter=function(t){return new El(this.firestore,t,this._query)},El),wl=(n(_l,yl=bl),Object.defineProperty(_l.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(_l.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(_l.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new ml(this.firestore,null,new vi(t))},enumerable:!1,configurable:!0}),_l.prototype.withConverter=function(t){return new _l(this.firestore,t,this._path)},_l);function _l(t,e,n){var r=this;return(r=yl.call(this,t,e,mo(n))||this)._path=n,r.type="collection",r}function El(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}function Tl(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}function Il(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gl({}),this._settingsFrozen=!1,t instanceof zh?(this._databaseId=t,this._credentials=new Xh):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Rr(Cr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zh(t.options.projectId)}(t),this._credentials=new $h(e))}function Sl(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Rr(Cr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Rr(Cr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,cl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Al(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=m(t),al("collection","path",e),t instanceof vl)return ll(n=Zr.fromString.apply(Zr,s([e],r))),new wl(t,null,n);if(!(t instanceof ml||t instanceof wl))throw new Rr(Cr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return ll(n=Zr.fromString.apply(Zr,s([t.path],r)).child(Zr.fromString(e))),new wl(t.firestore,null,n)}function Nl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=m(t),al("doc","path",e=1===arguments.length?qr.u():e),t instanceof vl)return hl(n=Zr.fromString.apply(Zr,s([e],r))),new ml(t,null,new vi(n));if(!(t instanceof ml||t instanceof wl))throw new Rr(Cr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return hl(n=t._path.child(Zr.fromString.apply(Zr,s([e],r)))),new ml(t.firestore,t instanceof wl?t.converter:null,new vi(n))}function Dl(t,e){return t=m(t),e=m(e),(t instanceof ml||t instanceof wl)&&(e instanceof ml||e instanceof wl)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Cl(t,e){return t=m(t),e=m(e),t instanceof bl&&e instanceof bl&&t.firestore===e.firestore&&No(t._query,e._query)&&t.converter===e.converter}var Rl=(Object.defineProperty(kl.prototype,"isShuttingDown",{get:function(){return this.wc},enumerable:!1,configurable:!0}),kl.prototype.enqueueAndForget=function(t){this.enqueue(t)},kl.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Tc(),this.Ic(t)},kl.prototype.enterRestrictedMode=function(){var t;this.wc||(this.wc=!0,(t=Xu())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ec))},kl.prototype.enqueue=function(t){return this.Tc(),this.wc?new Promise(function(t){}):this.Ic(t)},kl.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.dc.push(t),e.Ac()})},kl.prototype.Ac=function(){return y(this,void 0,void 0,function(){var e,n=this;return g(this,function(t){switch(t.label){case 0:if(0===this.dc.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.dc[0]()];case 2:return t.sent(),this.dc.shift(),this.Zi.reset(),[3,4];case 3:if(!Ca(e=t.sent()))throw e;return Pr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.dc.length&&this.Zi.ji(function(){return n.Ac()}),t.label=5;case 5:return[2]}})})},kl.prototype.Ic=function(t){var r=this,e=this.fc.then(function(){return r.yc=!0,t().catch(function(t){throw r.mc=t,r.yc=!1,Mr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",n=e.stack?e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack:n)),t;var e,n}).then(function(t){return r.yc=!1,t})});return this.fc=e},kl.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Tc(),-1<this.gc.indexOf(t)&&(e=0);n=kc.createAndSchedule(this,t,e,n,function(t){return r.Rc(t)});return this._c.push(n),n},kl.prototype.Tc=function(){this.mc&&Vr()},kl.prototype.verifyOperationInProgress=function(){},kl.prototype.bc=function(){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return[4,e=this.fc];case 1:t.sent(),t.label=2;case 2:if(e!==this.fc)return[3,0];t.label=3;case 3:return[2]}})})},kl.prototype.vc=function(t){for(var e=0,n=this._c;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},kl.prototype.Pc=function(r){var i=this;return this.bc().then(function(){i._c.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var t=0,e=i._c;t<e.length;t++){var n=e[t];if(n.skipDelay(),"all"!==r&&n.timerId===r)break}return i.bc()})},kl.prototype.Vc=function(t){this.gc.push(t)},kl.prototype.Rc=function(t){t=this._c.indexOf(t);this._c.splice(t,1)},kl);function kl(){var e=this;this.fc=Promise.resolve(),this.dc=[],this.wc=!1,this._c=[],this.mc=null,this.yc=!1,this.gc=[],this.Zi=new nc(this,"async_queue_retry"),this.Ec=function(){var t=Xu();t&&Pr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Zi.Gi()};var t=Xu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ec)}function Ol(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Ll,Pl=(Fl.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},Fl.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},Fl.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},Fl.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},Fl.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},Fl.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},Fl),Ml=(n(xl,Ll=vl),xl.prototype._terminate=function(){return this._firestoreClient||Ul(this),this._firestoreClient.terminate()},xl);function xl(t,e){var n=this;return(n=Ll.call(this,t,e)||this).type="firestore",n._queue=new Rl,n._persistenceKey="name"in t?t.name:"[DEFAULT]",n}function Fl(){this._progressObserver={},this._taskCompletionResolver=new Sa,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Vl(t){return t._firestoreClient||Ul(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Ul(t){var e,n,r,i=t._freezeSettings(),i=(e=t._databaseId,n=(null===(r=t._app)||void 0===r?void 0:r.options.appId)||"",r=t._persistenceKey,new Qh(e,n,r,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling));t._firestoreClient=new kh(t._credentials,t._queue,i)}var ql=(Jl.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},Jl),Bl=(Xl.fromBase64String=function(t){try{return new Xl(ri.fromBase64String(t))}catch(t){throw new Rr(Cr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Xl.fromUint8Array=function(t){return new Xl(ri.fromUint8Array(t))},Xl.prototype.toBase64=function(){return this._byteString.toBase64()},Xl.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},Xl.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Xl.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},Xl),jl=function(t){this._methodName=t},Gl=(Object.defineProperty(Yl.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),Yl.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},Yl.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},Yl.prototype._compareTo=function(t){return jr(this._lat,t._lat)||jr(this._long,t._long)},Yl),Kl=/^__.*__$/,Hl=(zl.prototype.toMutation=function(t,e){return null!==this.fieldMask?new cs(t,this.data,this.fieldMask,e,this.fieldTransforms):new us(t,this.data,e,this.fieldTransforms)},zl),Wl=(Ql.prototype.toMutation=function(t,e){return new cs(t,this.data,this.fieldMask,e,this.fieldTransforms)},Ql);function Ql(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}function zl(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}function Yl(t,e){if(!isFinite(t)||t<-90||90<t)throw new Rr(Cr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Rr(Cr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}function Xl(t){this._byteString=t}function Jl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ei(t)}function $l(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Vr()}}var Zl=(Object.defineProperty(nf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(nf.prototype,"Dc",{get:function(){return this.settings.Dc},enumerable:!1,configurable:!0}),nf.prototype.Cc=function(t){return new nf(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},nf.prototype.Nc=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Cc({path:e,xc:!1});return e.Fc(t),e},nf.prototype.kc=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Cc({path:t,xc:!1});return t.Sc(),t},nf.prototype.Oc=function(t){return this.Cc({path:void 0,xc:!0})},nf.prototype.$c=function(t){return Of(t,this.settings.methodName,this.settings.Mc||!1,this.path,this.settings.Lc)},nf.prototype.contains=function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})},nf.prototype.Sc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Fc(this.path.get(t))},nf.prototype.Fc=function(t){if(0===t.length)throw this.$c("Document fields must not be empty");if($l(this.Dc)&&Kl.test(t))throw this.$c('Document fields cannot begin and end with "__"')},nf),tf=(ef.prototype.Bc=function(t,e,n,r){return void 0===r&&(r=!1),new Zl({Dc:t,methodName:e,Lc:n,path:ei.emptyPath(),xc:!1,Mc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},ef);function ef(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Ju(t)}function nf(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Sc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}function rf(t){var e=t._freezeSettings(),n=Ju(t._databaseId);return new tf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function of(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Bc(o.merge||o.mergeFields?2:0,e,n,i);Df("Data must be an object, but it was:",s,r);var a,u,r=Af(r,s);if(o.merge)a=new ni(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=Cf(e,l[h],n);if(!s.contains(f))throw new Rr(Cr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Lf(c,f)||c.push(f)}a=new ni(c),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new Hl(new ki(r),a,u)}var sf,af=(n(uf,sf=jl),uf.prototype._toFieldTransform=function(t){if(2!==t.Dc)throw 1===t.Dc?t.$c(this._methodName+"() can only appear at the top level of your update data"):t.$c(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},uf.prototype.isEqual=function(t){return t instanceof uf},uf);function uf(){return null!==sf&&sf.apply(this,arguments)||this}function cf(t,e,n){return new Zl({Dc:3,Lc:e.settings.Lc,methodName:t._methodName,xc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var hf,lf,ff,pf,df=(n(_f,pf=jl),_f.prototype._toFieldTransform=function(t){return new $o(t.path,new Vo)},_f.prototype.isEqual=function(t){return t instanceof _f},_f),yf=(n(wf,ff=jl),wf.prototype._toFieldTransform=function(t){var e=cf(this,t,!0),n=this.qc.map(function(t){return Sf(t,e)}),n=new Uo(n);return new $o(t.path,n)},wf.prototype.isEqual=function(t){return this===t},wf),gf=(n(bf,lf=jl),bf.prototype._toFieldTransform=function(t){var e=cf(this,t,!0),n=this.qc.map(function(t){return Sf(t,e)}),n=new Ko(n);return new $o(t.path,n)},bf.prototype.isEqual=function(t){return this===t},bf),vf=(n(mf,hf=jl),mf.prototype._toFieldTransform=function(t){var e=new zo(t.R,Po(t.R,this.Uc));return new $o(t.path,e)},mf.prototype.isEqual=function(t){return this===t},mf);function mf(t,e){var n=this;return(n=hf.call(this,t)||this).Uc=e,n}function bf(t,e){var n=this;return(n=lf.call(this,t)||this).qc=e,n}function wf(t,e){var n=this;return(n=ff.call(this,t)||this).qc=e,n}function _f(){return null!==pf&&pf.apply(this,arguments)||this}function Ef(t,r,i,e){var o=t.Bc(1,r,i);Df("Data must be an object, but it was:",o,e);var s=[],a=ki.empty();Yr(e,function(t,e){var n=kf(r,t,i);e=m(e);t=o.kc(n);e instanceof af?s.push(n):null!=(t=Sf(e,t))&&(s.push(n),a.set(n,t))});e=new ni(s);return new Wl(a,e,o.fieldTransforms)}function Tf(t,e,n,r,i,o){var s=t.Bc(1,e,n),a=[Cf(e,r,n)],u=[i];if(o.length%2!=0)throw new Rr(Cr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Cf(e,o[c])),u.push(o[c+1]);for(var h,l,f,p=[],d=ki.empty(),y=a.length-1;0<=y;--y)Lf(p,a[y])||(h=a[y],l=m(l=u[y]),f=s.kc(h),l instanceof af?p.push(h):null!=(f=Sf(l,f))&&(p.push(h),d.set(h,f)));i=new ni(p);return new Wl(d,i,s.fieldTransforms)}function If(t,e,n,r){return void 0===r&&(r=!1),Sf(n,t.Bc(r?4:3,e))}function Sf(s,t){if(Nf(s=m(s)))return Df("Unsupported field value:",t,s),Af(s,t);if(s instanceof jl)return function(t,e){if(!$l(e.Dc))throw e.$c(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.$c(t._methodName+"() is not currently supported inside arrays");t=t._toFieldTransform(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(void 0===s&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),s instanceof Array){if(t.settings.xc&&4!==t.Dc)throw t.$c("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Sf(i[r],t.Oc(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===(t=m(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Po(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Kr.fromDate(t);return{timestampValue:ia(e.R,n)}}if(t instanceof Kr)return n=new Kr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ia(e.R,n)};if(t instanceof Gl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Bl)return{bytesValue:oa(e.R,t._byteString)};if(t instanceof ml){var n=e.databaseId,r=t.firestore._databaseId;if(!r.isEqual(n))throw e.$c("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:aa(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.$c("Unsupported field value: "+fl(t))}(s,t)}function Af(t,n){var r={};return Xr(t)?n.path&&0<n.path.length&&n.fieldMask.push(n.path):Yr(t,function(t,e){e=Sf(e,n.Nc(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Nf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Kr||t instanceof Gl||t instanceof Bl||t instanceof ml||t instanceof jl)}function Df(t,e,n){if(!Nf(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=fl(n);throw"an object"===n?e.$c(t+" a custom object"):e.$c(t+" "+n)}var r}function Cf(t,e,n){if((e=m(e))instanceof ql)return e._internalPath;if("string"==typeof e)return kf(t,e);throw Of("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Rf=new RegExp("[~\\*/\\[\\]]");function kf(e,n,r){if(0<=n.search(Rf))throw Of("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(ql.bind.apply(ql,s([void 0],n.split(".")))))._internalPath}catch(t){throw Of("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Of(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Rr(Cr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Lf(t,e){return t.some(function(t){return t.isEqual(e)})}var Pf,Mf=(Object.defineProperty(Vf.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(Vf.prototype,"ref",{get:function(){return new ml(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),Vf.prototype.exists=function(){return null!==this._document},Vf.prototype.data=function(){if(this._document){if(this._converter){var t=new xf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.toProto())}},Vf.prototype.get=function(t){if(this._document){t=this._document.data.field(Uf("DocumentSnapshot.get",t));if(null!==t)return this._userDataWriter.convertValue(t)}},Vf),xf=(n(Ff,Pf=Mf),Ff.prototype.data=function(){return Pf.prototype.data.call(this)},Ff);function Ff(){return null!==Pf&&Pf.apply(this,arguments)||this}function Vf(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}function Uf(t,e){return"string"==typeof e?kf(t,e):(e instanceof ql?e:e._delegate)._internalPath}var qf,Bf,jf=(Yf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Yf),Gf=(n(zf,Bf=Mf),zf.prototype.exists=function(){return Bf.prototype.exists.call(this)},zf.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Kf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.toProto(),t.serverTimestamps)}},zf.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){t=this._document.data.field(Uf("DocumentSnapshot.get",t));if(null!==t)return this._userDataWriter.convertValue(t,e.serverTimestamps)}},zf),Kf=(n(Qf,qf=Gf),Qf.prototype.data=function(t){return void 0===t&&(t={}),qf.prototype.data.call(this,t)},Qf),Hf=(Object.defineProperty(Wf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Wf.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Wf.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Wf.prototype.forEach=function(e,n){var r=this;this._snapshot.docs.forEach(function(t){e.call(n,new Kf(r._firestore,r._userDataWriter,t.key,t,new jf(r._snapshot.mutatedKeys.has(t.key),r._snapshot.fromCache),r.query.converter))})},Wf.prototype.docChanges=function(t){t=!!(t=void 0===t?{}:t).includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Rr(Cr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,e){if(i._snapshot.oldDocs.isEmpty()){var n=0;return i._snapshot.docChanges.map(function(t){var e=new Kf(i._firestore,i._userDataWriter,t.doc.key,t.doc,new jf(i._snapshot.mutatedKeys.has(t.doc.key),i._snapshot.fromCache),i.query.converter);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Kf(i._firestore,i._userDataWriter,t.doc.key,t.doc,new jf(i._snapshot.mutatedKeys.has(t.doc.key),i._snapshot.fromCache),i.query.converter),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},Wf);function Wf(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new jf(r.hasPendingWrites,r.fromCache),this.query=n}function Qf(){return null!==qf&&qf.apply(this,arguments)||this}function zf(t,e,n,r,i,o){var s=this;return(s=Bf.call(this,t,e,n,r,o)||this)._firestore=t,s._firestoreImpl=t,s.metadata=i,s}function Yf(t,e){this.hasPendingWrites=t,this.fromCache=e}function Xf(t,e){return t instanceof Gf&&e instanceof Gf?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Hf&&e instanceof Hf&&t._firestore===e._firestore&&Cl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Jf(t){if(wo(t)&&0===t.explicitOrderBy.length)throw new Rr(Cr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}Se=function(){};function $f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r]._apply(t);return t}var Zf,tp,ep,np,rp,ip=(n(pp,rp=Se),pp.prototype._apply=function(t){var e=rf(t.firestore),e=function(t,e,n,r,i,o){if(r.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){gp(o,i);for(var s=[],a=0,u=o;a<u.length;a++){var c=u[a];s.push(yp(n,t,c))}h={arrayValue:{values:s}}}else h=yp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||gp(o,i),h=If(e,"where",o,"in"===i||"not-in"===i);var h=Bi.create(r,i,h);return function(t,e){if(e.g()){var n=Eo(t);if(null!==n&&!n.isEqual(e.field))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=_o(t);null!==n&&vp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t._query,e,t.firestore._databaseId,this.Qc,this.Kc,this.jc);return new bl(t.firestore,t.converter,(t=t._query,e=t.filters.concat([e]),new vo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},pp),op=(n(fp,np=Se),fp.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new po(e,n);return e=r,null!==_o(n=t)||null!==(t=Eo(n))&&vp(0,t,e.field),r}(t._query,this.Qc,this.Wc);return new bl(t.firestore,t.converter,(t=t._query,e=t.explicitOrderBy.concat([e]),new vo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},fp),sp=(n(lp,ep=Se),lp.prototype._apply=function(t){return new bl(t.firestore,t.converter,Ao(t._query,this.Gc,this.zc))},lp),ap=(n(hp,tp=Se),hp.prototype._apply=function(t){var e=dp(t,this.type,this.Hc,this.Jc);return new bl(t.firestore,t.converter,(t=t._query,e=e,new vo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},hp),up=(n(cp,Zf=Se),cp.prototype._apply=function(t){var e=dp(t,this.type,this.Hc,this.Jc);return new bl(t.firestore,t.converter,(t=t._query,e=e,new vo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},cp);function cp(t,e,n){var r=this;return(r=Zf.call(this)||this).type=t,r.Hc=e,r.Jc=n,r}function hp(t,e,n){var r=this;return(r=tp.call(this)||this).type=t,r.Hc=e,r.Jc=n,r}function lp(t,e,n){var r=this;return(r=ep.call(this)||this).type=t,r.Gc=e,r.zc=n,r}function fp(t,e){var n=this;return(n=np.call(this)||this).Qc=t,n.Wc=e,n.type="orderBy",n}function pp(t,e,n){var r=this;return(r=rp.call(this)||this).Qc=t,r.Kc=e,r.jc=n,r.type="where",r}function dp(t,c,e,n){if(e[0]=m(e[0]),e[0]instanceof Mf)return function(t,e,n,r){if(!n)throw new Rr(Cr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Io(t);o<s.length;o++){var a=s[o];if(a.field.isKeyField())i.push(Si(e,n.key));else{var u=n.data.field(a.field);if(pi(u))throw new Rr(Cr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){a=a.field.canonicalString();throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}i.push(u)}}return new ao(i,r)}(t._query,t.firestore._databaseId,e[0]._document,n);var r=rf(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Rr(Cr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!To(t)&&-1!==c.indexOf("/"))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Zr.fromString(c));if(!vi.isDocumentKey(h))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new vi(h);a.push(Si(e,h))}else{c=If(n,r,c);a.push(c)}}return new ao(a,o)}(t._query,t.firestore._databaseId,r,c,e,n)}function yp(t,e,n){if("string"==typeof(n=m(n))){if(""===n)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!To(e)&&-1!==n.indexOf("/"))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(Zr.fromString(n));if(!vi.isDocumentKey(e))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Si(t,new vi(e))}if(n instanceof ml)return Si(t,n._key);throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+fl(n)+".")}function gp(t,e){if(!Array.isArray(t)||0===t.length)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function vp(t,e,n){if(!n.isEqual(e))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}mp.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),bi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return li(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(fi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Vr()}},mp.prototype.convertObject=function(t,n){var r=this,i={};return Yr(t.fields||{},function(t,e){i[t]=r.convertValue(e,n)}),i},mp.prototype.convertGeoPoint=function(t){return new Gl(li(t.latitude),li(t.longitude))},mp.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},mp.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return pi(e)?t(e):e}(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(di(t));default:return null}},mp.prototype.convertTimestamp=function(t){t=hi(t);return new Kr(t.seconds,t.nanos)},mp.prototype.convertDocumentKey=function(t,e){var n=Zr.fromString(t);Ur(Ia(n));t=new zh(n.get(1),n.get(3)),n=new vi(n.popFirst(5));return t.isEqual(e)||Mr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},T=mp;function mp(){}function bp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var wp,_p=(n(Ip,wp=T),Ip.prototype.convertBytes=function(t){return new Bl(t)},Ip.prototype.convertReference=function(t){t=this.convertDocumentKey(t,this.firestore._databaseId);return new ml(this.firestore,null,t)},Ip),Ep=(Tp.prototype.set=function(t,e,n){this._verifyNotCommitted();t=Sp(t,this._firestore),e=bp(t.converter,e,n),n=of(this._dataReader,"WriteBatch.set",t._key,e,null!==t.converter,n);return this._mutations.push(n.toMutation(t._key,ts.none())),this},Tp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();t=Sp(t,this._firestore),e="string"==typeof(e=m(e))||e instanceof ql?Tf(this._dataReader,"WriteBatch.update",t._key,e,n,r):Ef(this._dataReader,"WriteBatch.update",t._key,e);return this._mutations.push(e.toMutation(t._key,ts.exists(!0))),this},Tp.prototype.delete=function(t){this._verifyNotCommitted();t=Sp(t,this._firestore);return this._mutations=this._mutations.concat(new bs(t._key,ts.none())),this},Tp.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,0<this._mutations.length?this._commitHandler(this._mutations):Promise.resolve()},Tp.prototype._verifyNotCommitted=function(){if(this._committed)throw new Rr(Cr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Tp);function Tp(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=rf(t)}function Ip(t){var e=this;return(e=wp.call(this)||this).firestore=t,e}function Sp(t,e){if((t=m(t)).firestore!==e)throw new Rr(Cr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Ap,Np=(n(Dp,Ap=T),Dp.prototype.convertBytes=function(t){return new Bl(t)},Dp.prototype.convertReference=function(t){t=this.convertDocumentKey(t,this.firestore._databaseId);return new ml(this.firestore,null,t)},Dp);function Dp(t){var e=this;return(e=Ap.call(this)||this).firestore=t,e}function Cp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=pl(t,ml);var o=pl(t.firestore,Ml),s=rf(o);return kp(o,[("string"==typeof(e=m(e))||e instanceof ql?Tf(s,"updateDoc",t._key,e,n,r):Ef(s,"updateDoc",t._key,e)).toMutation(t._key,ts.exists(!0))])}function Rp(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e=m(e);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Ol(n[i])||(r=n[i],i++);var o,s,a,u,c,h,l={includeMetadataChanges:r.includeMetadataChanges};return Ol(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof ml?(a=pl(e.firestore,Ml),u=mo(e._key.path),h={next:function(t){n[i]&&n[i](Op(a,e,t))},error:n[i+1],complete:n[i+2]}):(s=pl(e,bl),a=pl(s.firestore,Ml),u=s._query,c=new Np(a),h={next:function(t){n[i]&&n[i](new Hf(a,c,s,t))},error:n[i+1],complete:n[i+2]},Jf(e._query)),function(n,t,e){var r=this,i=new Nh(h),o=new Hc(t,i,e);return n.asyncQueue.enqueueAndForget(function(){return y(r,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=jc,[4,Gh(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.Wo(),n.asyncQueue.enqueueAndForget(function(){return y(r,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=Gc,[4,Gh(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Vl(a),u,l)}function kp(t,e){return function(n,r){var t=this,i=new Sa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=ch,[4,jh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Vl(t),e)}function Op(t,e,n){var r=n.docs.get(e._key),i=new Np(t);return new Gf(t,i,e._key,r,new jf(n.hasPendingWrites,n.fromCache),e.converter)}var Lp,Pp=(xp.prototype.get=function(t){var e=this,n=Sp(t,this._firestore),r=new _p(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return Vr();t=t[0];if(t.isFoundDocument())return new Mf(e._firestore,r,t.key,t,n.converter);if(t.isNoDocument())return new Mf(e._firestore,r,n._key,null,n.converter);throw Vr()})},xp.prototype.set=function(t,e,n){t=Sp(t,this._firestore),e=bp(t.converter,e,n),n=of(this._dataReader,"Transaction.set",t._key,e,null!==t.converter,n);return this._transaction.set(t._key,n),this},xp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Sp(t,this._firestore),e="string"==typeof(e=m(e))||e instanceof ql?Tf(this._dataReader,"Transaction.update",t._key,e,n,r):Ef(this._dataReader,"Transaction.update",t._key,e);return this._transaction.update(t._key,e),this},xp.prototype.delete=function(t){t=Sp(t,this._firestore);return this._transaction.delete(t._key),this},n(Mp,Lp=xp),Mp.prototype.get=function(t){var e=this,n=Sp(t,this._firestore),r=new Np(this._firestore);return Lp.prototype.get.call(this,t).then(function(t){return new Gf(e._firestore,r,n._key,t._document,new jf(!1,!1),n.converter)})},Mp);function Mp(t,e){var n=this;return(n=Lp.call(this,t,e)||this)._firestore=t,n}function xp(t,e){this._firestore=t,this._transaction=e,this._dataReader=rf(t)}function Fp(){if("undefined"==typeof Uint8Array)throw new Rr(Cr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Vp(){if("undefined"==typeof atob)throw new Rr(Cr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Up,qp=(zp.fromBase64String=function(t){return Vp(),new zp(Bl.fromBase64String(t))},zp.fromUint8Array=function(t){return Fp(),new zp(Bl.fromUint8Array(t))},zp.prototype.toBase64=function(){return Vp(),this._delegate.toBase64()},zp.prototype.toUint8Array=function(){return Fp(),this._delegate.toUint8Array()},zp.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},zp.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},zp),Bp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",jp=(Qp.prototype.enableIndexedDbPersistence=function(t,e){throw new Rr(Cr.FAILED_PRECONDITION,Bp)},Qp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Rr(Cr.FAILED_PRECONDITION,Bp)},Qp.prototype.clearIndexedDbPersistence=function(t){throw new Rr(Cr.FAILED_PRECONDITION,Bp)},Qp),Gp=(Object.defineProperty(Wp.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),Wp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._delegate._getSettings()),t)).merge,this._delegate._setSettings(t)},Wp.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=pl(t,vl))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&xr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){n=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0;if(!(e=t.sub||t.user_id))throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");return t=o({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:e,user_id:e,firebase:{sign_in_provider:"custom",identities:{}}},t),[a.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),a.encodeString(JSON.stringify(t),!1),""].join(".")}(r.mockUserToken),r=r.mockUserToken.sub||r.mockUserToken.user_id;if(!r)throw new Rr(Cr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Jh(new Wh(n,new Tu(r)))}}(this._delegate,t,e,n)},Wp.prototype.enableNetwork=function(){return function(i){var t=this;return i.asyncQueue.enqueue(function(){return y(t,void 0,void 0,function(){var n,r;return g(this,function(t){switch(t.label){case 0:return[4,Uh(i)];case 1:return n=t.sent(),[4,Bh(i)];case 2:return r=t.sent(),[2,(n.setNetworkEnabled(!0),(e=r).$r.delete(0),pc(e))]}var e})})})}(Vl(pl(this._delegate,Ml)))},Wp.prototype.disableNetwork=function(){return function(r){var t=this;return r.asyncQueue.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return[4,Uh(r)];case 1:return e=t.sent(),[4,Bh(r)];case 2:return n=t.sent(),[2,(e.setNetworkEnabled(!1),function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return(e=n).$r.add(0),[4,dc(e)];case 1:return t.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(Vl(pl(this._delegate,Ml)))},Wp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&cl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Yc.enableMultiTabIndexedDbPersistence(this):this.Yc.enableIndexedDbPersistence(this,n)},Wp.prototype.clearPersistence=function(){return this.Yc.clearIndexedDbPersistence(this)},Wp.prototype.terminate=function(){return this.Xc&&(this.Xc._removeServiceInstance("firestore"),this.Xc._removeServiceInstance("firestore-exp")),this._delegate._delete()},Wp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Sa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=fh,[4,jh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Vl(pl(this._delegate,Ml)))},Wp.prototype.onSnapshotsInSync=function(t){return e=this._delegate,t=t,function(n,t){var e=this,r=new Nh(t);return n.asyncQueue.enqueueAndForget(function(){return y(e,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Gr.add(e),e.next()},[4,Gh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.Wo(),n.asyncQueue.enqueueAndForget(function(){return y(e,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Gr.delete(e)},[4,Gh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Vl(pl(e,Ml)),Ol(t)?t:{next:t});var e},Object.defineProperty(Wp.prototype,"app",{get:function(){if(!this.Xc)throw new Rr(Cr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Xc},enumerable:!1,configurable:!0}),Wp.prototype.collection=function(t){try{return new pd(this,Al(this._delegate,t))}catch(t){throw rd(t,"collection()","Firestore.collection()")}},Wp.prototype.doc=function(t){try{return new ed(this,Nl(this._delegate,t))}catch(t){throw rd(t,"doc()","Firestore.doc()")}},Wp.prototype.collectionGroup=function(t){try{return new hd(this,function(t,e){if(t=pl(t,vl),al("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Rr(Cr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new bl(t,null,(e=e,new vo(Zr.emptyPath(),e)))}(this._delegate,t))}catch(t){throw rd(t,"collectionGroup()","Firestore.collectionGroup()")}},Wp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Sa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return[4,Vh(n).then(function(t){return t.datastore})];case 1:return e=t.sent(),new Rh(n.asyncQueue,e,r,i).run(),[2]}})})}),i.promise}(Vl(n=this._delegate),function(t){return t=new Pp(n,t),e(new Yp(r,t))})},Wp.prototype.batch=function(){var e=this;return Vl(this._delegate),new Xp(new Ep(this._delegate,function(t){return kp(e._delegate,t)}))},Wp.prototype.loadBundle=function(t){throw new Rr(Cr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Wp.prototype.namedQuery=function(t){throw new Rr(Cr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Wp),Kp=(n(Hp,Up=T),Hp.prototype.convertBytes=function(t){return new qp(new Bl(t))},Hp.prototype.convertReference=function(t){t=this.convertDocumentKey(t,this.firestore._databaseId);return ed.Zc(t,this.firestore,null)},Hp);function Hp(t){var e=this;return(e=Up.call(this)||this).firestore=t,e}function Wp(t,e,n){var r=this;this._delegate=e,this.Yc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof zh||(this.Xc=t)}function Qp(){}function zp(t){this._delegate=t}var Yp=(td.prototype.get=function(t){var e=this,n=wd(t);return this._delegate.get(n).then(function(t){return new ud(e._firestore,new Gf(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},td.prototype.set=function(t,e,n){t=wd(t);return n?(ul("Transaction.set",n),this._delegate.set(t,e,n)):this._delegate.set(t,e),this},td.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=wd(t);return 2===arguments.length?this._delegate.update(o,e):(t=this._delegate).update.apply(t,s([o,e,n],r)),this},td.prototype.delete=function(t){t=wd(t);return this._delegate.delete(t),this},td),Xp=(Zp.prototype.set=function(t,e,n){t=wd(t);return n?(ul("WriteBatch.set",n),this._delegate.set(t,e,n)):this._delegate.set(t,e),this},Zp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=wd(t);return 2===arguments.length?this._delegate.update(o,e):(t=this._delegate).update.apply(t,s([o,e,n],r)),this},Zp.prototype.delete=function(t){t=wd(t);return this._delegate.delete(t),this},Zp.prototype.commit=function(){return this._delegate.commit()},Zp),Jp=($p.prototype.fromFirestore=function(t,e){t=new Kf(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new cd(this._firestore,t),null!=e?e:{})},$p.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},$p.tu=function(t,e){var n=$p.eu,r=n.get(t);r||(r=new WeakMap,n.set(t,r));n=r.get(e);return n||(n=new $p(t,new Kp(t),e),r.set(e,n)),n},$p);function $p(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}function Zp(t){this._delegate=t}function td(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Kp(t)}Jp.eu=new WeakMap;var ed=(nd.nu=function(t,e,n){if(t.length%2!=0)throw new Rr(Cr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new nd(e,new ml(e._delegate,n,new vi(t)))},nd.Zc=function(t,e,n){return new nd(e,new ml(e._delegate,n,t))},Object.defineProperty(nd.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"parent",{get:function(){return new pd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),nd.prototype.collection=function(t){try{return new pd(this.firestore,Al(this._delegate,t))}catch(t){throw rd(t,"collection()","DocumentReference.collection()")}},nd.prototype.isEqual=function(t){return(t=m(t))instanceof ml&&Dl(this._delegate,t)},nd.prototype.set=function(t,e){e=ul("DocumentReference.set",e);try{return function(t,e,n){t=pl(t,ml);var r=pl(t.firestore,Ml),e=bp(t.converter,e,n);return kp(r,[of(rf(r),"setDoc",t._key,e,null!==t.converter,n).toMutation(t._key,ts.none())])}(this._delegate,t,e)}catch(t){throw rd(t,"setDoc()","DocumentReference.set()")}},nd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Cp(this._delegate,t):Cp.apply(void 0,s([this._delegate,t,e],n))}catch(t){throw rd(t,"updateDoc()","DocumentReference.update()")}},nd.prototype.delete=function(){return kp(pl((t=this._delegate).firestore,Ml),[new bs(t._key,ts.none())]);var t},nd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=id(t),i=od(t,function(t){return new ud(e.firestore,new Gf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))});return Rp(this._delegate,r,i)},nd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=pl(e,ml);var n=pl(e.firestore,Ml),t=Vl(n),r=new Np(n);return function(n,r){var t=this,i=new Sa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(o,s,a){return y(this,void 0,void 0,function(){var r,i;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)}))];case 1:return(i=t.sent()).isFoundDocument()?a.resolve(i):i.isNoDocument()?a.resolve(null):a.reject(new Rr(Cr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=Lc(r,"Failed to get document '"+s+" from cache"),a.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,qh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e._key).then(function(t){return new Gf(n,r,e._key,t,new jf(null!==t&&t.hasLocalMutations,!0),e.converter)})}:"server"===(null==t?void 0:t.source)?function(e){e=pl(e,ml);var n=pl(e.firestore,Ml);return Kh(Vl(n),e._key,{source:"server"}).then(function(t){return Op(n,e,t)})}:function(e){e=pl(e,ml);var n=pl(e.firestore,Ml);return Kh(Vl(n),e._key).then(function(t){return Op(n,e,t)})})(this._delegate).then(function(t){return new ud(e.firestore,new Gf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},nd.prototype.withConverter=function(t){return new nd(this.firestore,t?this._delegate.withConverter(Jp.tu(this.firestore,t)):this._delegate.withConverter(null))},nd);function nd(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Kp(t)}function rd(t,e,n){return t.message=t.message.replace(e,n),t}function id(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Ol(r))return r}return{}}function od(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Ol(t[0])?t[0]:Ol(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var sd,ad,ud=(Object.defineProperty(bd.prototype,"ref",{get:function(){return new ed(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),bd.prototype.data=function(t){return this._delegate.data(t)},bd.prototype.get=function(t,e){return this._delegate.get(t,e)},bd.prototype.isEqual=function(t){return Xf(this._delegate,t._delegate)},bd),cd=(n(md,ad=ud),md.prototype.data=function(t){return this._delegate.data(t)},md),hd=(vd.prototype.where=function(t,e,n){try{return new vd(this.firestore,$f(this._delegate,(r=n,i=e,o=Uf("where",t),new ip(o,i,r))))}catch(t){throw rd(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},vd.prototype.orderBy=function(t,e){try{return new vd(this.firestore,$f(this._delegate,(n=void 0===e?"asc":e,r=Uf("orderBy",t),new op(r,n))))}catch(t){throw rd(t,/(orderBy|where)\(\)/,"Query.$1()")}var n,r},vd.prototype.limit=function(t){try{return new vd(this.firestore,$f(this._delegate,(dl("limit",e=t),new sp("limit",e,"F"))))}catch(t){throw rd(t,"limit()","Query.limit()")}var e},vd.prototype.limitToLast=function(t){try{return new vd(this.firestore,$f(this._delegate,(dl("limitToLast",e=t),new sp("limitToLast",e,"L"))))}catch(t){throw rd(t,"limitToLast()","Query.limitToLast()")}var e},vd.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vd(this.firestore,$f(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ap("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw rd(t,"startAt()","Query.startAt()")}},vd.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vd(this.firestore,$f(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ap("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw rd(t,"startAfter()","Query.startAfter()")}},vd.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vd(this.firestore,$f(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new up("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw rd(t,"endBefore()","Query.endBefore()")}},vd.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new vd(this.firestore,$f(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new up("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw rd(t,"endAt()","Query.endAt()")}},vd.prototype.isEqual=function(t){return Cl(this._delegate,t._delegate)},vd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=pl(e,bl);var n=pl(e.firestore,Ml),t=Vl(n),r=new Np(n);return function(n,r){var t=this,i=new Sa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,hu(i,o,!0)];case 1:return r=t.sent(),e=new nh(o,r.Bn),n=e._o(r.documents),n=e.applyChanges(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=Lc(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,qh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e._query).then(function(t){return new Hf(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=pl(e,bl);var n=pl(e.firestore,Ml),t=Vl(n),r=new Np(n);return Hh(t,e._query,{source:"server"}).then(function(t){return new Hf(n,r,e,t)})}:function(e){e=pl(e,bl);var n=pl(e.firestore,Ml),t=Vl(n),r=new Np(n);return Jf(e._query),Hh(t,e._query).then(function(t){return new Hf(n,r,e,t)})})(this._delegate).then(function(t){return new fd(e.firestore,new Hf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},vd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=id(t),i=od(t,function(t){return new fd(e.firestore,new Hf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))});return Rp(this._delegate,r,i)},vd.prototype.withConverter=function(t){return new vd(this.firestore,t?this._delegate.withConverter(Jp.tu(this.firestore,t)):this._delegate.withConverter(null))},vd),ld=(Object.defineProperty(gd.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"doc",{get:function(){return new cd(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),gd),fd=(Object.defineProperty(yd.prototype,"query",{get:function(){return new hd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"docs",{get:function(){var e=this;return this._delegate.docs.map(function(t){return new cd(e._firestore,t)})},enumerable:!1,configurable:!0}),yd.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new ld(e._firestore,t)})},yd.prototype.forEach=function(e,n){var r=this;this._delegate.forEach(function(t){e.call(n,new cd(r._firestore,t))})},yd.prototype.isEqual=function(t){return Xf(this._delegate,t._delegate)},yd),pd=(n(dd,sd=hd),Object.defineProperty(dd.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new ed(this.firestore,t):null},enumerable:!1,configurable:!0}),dd.prototype.doc=function(t){try{return new ed(this.firestore,void 0===t?Nl(this._delegate):Nl(this._delegate,t))}catch(t){throw rd(t,"doc()","CollectionReference.doc()")}},dd.prototype.add=function(t){var e,n,r,i=this;return e=this._delegate,n=t,t=pl(e.firestore,Ml),r=Nl(e),n=bp(e.converter,n),kp(t,[of(rf(e.firestore),"addDoc",r._key,n,null!==e.converter,{}).toMutation(r._key,ts.exists(!1))]).then(function(){return r}).then(function(t){return new ed(i.firestore,t)})},dd.prototype.isEqual=function(t){return Dl(this._delegate,t._delegate)},dd.prototype.withConverter=function(t){return new dd(this.firestore,t?this._delegate.withConverter(Jp.tu(this.firestore,t)):this._delegate.withConverter(null))},dd);function dd(t,e){var n=this;return(n=sd.call(this,t,e)||this).firestore=t,n._delegate=e,n}function yd(t,e){this._firestore=t,this._delegate=e}function gd(t,e){this._firestore=t,this._delegate=e}function vd(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Kp(t)}function md(){return null!==ad&&ad.apply(this,arguments)||this}function bd(t,e){this._firestore=t,this._delegate=e}function wd(t){return pl(t,ml)}Ed.documentId=function(){return new Ed(ei.keyField().canonicalString())},Ed.prototype.isEqual=function(t){return(t=m(t))instanceof ql&&this._delegate._internalPath.isEqual(t._internalPath)},Se=Ed,_d.serverTimestamp=function(){var t=new df("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new _d(t)},_d.delete=function(){var t=new af("deleteField");return t._methodName="FieldValue.delete",new _d(t)},_d.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yf("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new _d(n)},_d.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gf("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new _d(n)},_d.increment=function(t){t=new vf("increment",t);return t._methodName="FieldValue.increment",new _d(t)},_d.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},T=_d;function _d(t){this._delegate=t}function Ed(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(ql.bind.apply(ql,s([void 0],t)))}function Td(t){return e=this._delegate,s=t,n=Vl(e=pl(e,Ml)),t=new Pl,function(n,t,r){var e,i=this,o=(e=s,t=Ju(t),e=function(t){if(t instanceof Uint8Array)return Ah(t,void 0);if(t instanceof ArrayBuffer)return Ah(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new Dh(e,t));n.asyncQueue.enqueueAndForget(function(){return y(i,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=_h,[4,jh(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(n,e._databaseId,t),t;var e,s,n}function Id(t){var e=this,n=this._delegate,t=t;return function(n,r){var t=this;return n.asyncQueue.enqueue(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Qe.getNamedQuery(t,e)})},[4,qh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(Vl(n=pl(n,Ml)),t).then(function(t){return t?new bl(n,null,t.query):null}).then(function(t){return t?new hd(e,t):null})}var Sd=(Ad.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ad.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ad.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ad.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},Ad);function Ad(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}var Nd,Dd,Cd={Firestore:Gp,GeoPoint:Gl,Timestamp:Kr,Blob:qp,Transaction:Yp,WriteBatch:Xp,DocumentReference:ed,DocumentSnapshot:ud,Query:hd,QueryDocumentSnapshot:cd,QuerySnapshot:fd,CollectionReference:pd,FieldPath:Se,FieldValue:T,setLogLevel:function(t){kr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Nd=e.default).INTERNAL.registerComponent(new Sd("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Gp(e,new Ml(e,t),new jp)},"PUBLIC").setServiceProps(Object.assign({},Cd))),Nd.registerVersion("@firebase/firestore","2.3.0"),(Dd=Gp).prototype.loadBundle=Td,Dd.prototype.namedQuery=Id}.apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
